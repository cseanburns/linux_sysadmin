<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Networking and TCP/IP - Linux Systems Administration</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Entry level book on Linux systems administration.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="p1-linux-sysadmin.html"><strong aria-hidden="true">1.</strong> Linux Systems Administration</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="01-history-linux-unix.html"><strong aria-hidden="true">1.1.</strong> History of Unix and Linux</a></li><li class="chapter-item expanded "><a href="02-what-is-linux.html"><strong aria-hidden="true">1.2.</strong> What is Linux?</a></li><li class="chapter-item expanded "><a href="03-what-is-sysadmin.html"><strong aria-hidden="true">1.3.</strong> What is Systems Administration?</a></li></ol></li><li class="chapter-item expanded "><a href="p2-using-gcloud.html"><strong aria-hidden="true">2.</strong> Using Google Cloud (gcloud)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="05-using-gcloud-virtual-machines.html"><strong aria-hidden="true">2.1.</strong> Using gcloud for Virtual Machines</a></li></ol></li><li class="chapter-item expanded "><a href="p3-the-command-line.html"><strong aria-hidden="true">3.</strong> Learning the Command Line</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="06-the-linux-filesystem.html"><strong aria-hidden="true">3.1.</strong> The Linux Filesystem</a></li><li class="chapter-item expanded "><a href="07-files-and-directories.html"><strong aria-hidden="true">3.2.</strong> Files and Directories</a></li><li class="chapter-item expanded "><a href="08-file-attributes.html"><strong aria-hidden="true">3.3.</strong> File Attributes</a></li><li class="chapter-item expanded "><a href="09-text-processing-part-1.html"><strong aria-hidden="true">3.4.</strong> Text Processing: Part 1</a></li><li class="chapter-item expanded "><a href="10-text-processing-part-2.html"><strong aria-hidden="true">3.5.</strong> Text Processing: Part 2</a></li><li class="chapter-item expanded "><a href="11-text-editors.html"><strong aria-hidden="true">3.6.</strong> Text Editors</a></li><li class="chapter-item expanded "><a href="12-revisiting-directory-paths.html"><strong aria-hidden="true">3.7.</strong> Revisiting Directory Paths</a></li><li class="chapter-item expanded "><a href="13-bash-scripting.html"><strong aria-hidden="true">3.8.</strong> Bash Scripting</a></li><li class="chapter-item expanded "><a href="14-regular-expressions.html"><strong aria-hidden="true">3.9.</strong> Regular Expressions</a></li></ol></li><li class="chapter-item expanded "><a href="p4-managing-the-system.html"><strong aria-hidden="true">4.</strong> Managing the System</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="15-expanding-storage.html"><strong aria-hidden="true">4.1.</strong> Expanding Storage</a></li><li class="chapter-item expanded "><a href="16-managing-users-groups.html"><strong aria-hidden="true">4.2.</strong> Managing Users and Groups</a></li><li class="chapter-item expanded "><a href="17-managing-software.html"><strong aria-hidden="true">4.3.</strong> Managing Software</a></li><li class="chapter-item expanded "><a href="18-using-systemd.html"><strong aria-hidden="true">4.4.</strong> Using systemd</a></li></ol></li><li class="chapter-item expanded "><a href="p5-networking-security.html"><strong aria-hidden="true">5.</strong> Networking and Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="19-networking-tcpip.html" class="active"><strong aria-hidden="true">5.1.</strong> Networking and TCP/IP</a></li><li class="chapter-item expanded "><a href="20-dns-domain-names.html"><strong aria-hidden="true">5.2.</strong> DNS and Domain Names</a></li><li class="chapter-item expanded "><a href="21-local-security.html"><strong aria-hidden="true">5.3.</strong> Local Security</a></li><li class="chapter-item expanded "><a href="22-firewall-backups.html"><strong aria-hidden="true">5.4.</strong> Firewalls and Backups</a></li></ol></li><li class="chapter-item expanded "><a href="p6-creating-a-lamp-server.html"><strong aria-hidden="true">6.</strong> Creating a LAMP Server</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="23-installing-the-apache-web-server.html"><strong aria-hidden="true">6.1.</strong> Installing the Apache Web Server</a></li><li class="chapter-item expanded "><a href="24-installing-configuring-php.html"><strong aria-hidden="true">6.2.</strong> Installing and Configuring PHP</a></li><li class="chapter-item expanded "><a href="25-installing-configuring-mariadb.html"><strong aria-hidden="true">6.3.</strong> Installing and Configuring MariaDB</a></li></ol></li><li class="chapter-item expanded "><a href="p7-conclusion.html"><strong aria-hidden="true">7.</strong> Conclusion</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Linux Systems Administration</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/cseanburns/linux_sysadmin" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="networking-and-tcpip"><a class="header" href="#networking-and-tcpip">Networking and TCP/IP</a></h1>
<p>An important function of a system administrator
is to set up, configure, and monitor a network.
This may involve planning, configuring, and
connecting the devices on a local area network,
to planning and implementing a large network
that interfaces with an outside network,
and to monitoring networks for various sorts of attacks,
such as <a href="https://en.wikipedia.org/wiki/Denial-of-service_attack">denial of service attacks</a>.</p>
<p>In order to prepare for this type of work,
we need at least a basic understanding of how
the internet works and how local devices
interact with the internet.
In this section, we will focus mostly on
internet addressing, but
we will also devote some space to TCP and UDP,
two protocols for transmitting data.</p>
<p>Connecting two or more devices together 
nowadays involves the TCP/IP or the UDP/IP protocols,
otherwise part of the
<a href="https://en.wikipedia.org/wiki/Internet_protocol_suite">Internet protocol suite</a>.
This suite is a kind of expression of the more
generalized <a href="https://en.wikipedia.org/wiki/OSI_model">OSI communication model</a>.</p>
<p>The internet protocol suite is generally
framed as a series
of layers beginning with a lower layer,
the <strong>link layer</strong>,
that interfaces with internet capable hardware,
to the highest layer, the <strong>application layer</strong>.</p>
<p>The <strong>link layer</strong> describes the local area network.
Devices connected locally, e.g., via Ethernet cables,
comprise the link layer.
The link layer connects to the <strong>internet layer</strong>.
Data going into or out of a local network must
be negotiated between these two layers.</p>
<p>The <strong>internet layer</strong> makes the internet possible by
basically making the ability to transmit data
among multiple networks possible.
(The internet is, in fact, a network of networks).
The primary characteristic of the internet layer
is the <strong>IP address</strong>, which currently comes in two versions:
IPv4 (32 bit) and IPv6 (128 bit).
IP addresses are used to locate hosts on a network.</p>
<p>The <strong>transport layer</strong> makes the exchange of data
on the internet possible.
There are two dominant protocols attached to this layer:
<a href="https://en.wikipedia.org/wiki/User_Datagram_Protocol">UDP</a> and <a href="https://en.wikipedia.org/wiki/Transmission_Control_Protocol">TCP</a>.
Very generally, <a href="https://www.cloudflare.com/learning/ddos/glossary/user-datagram-protocol-udp/">UDP</a> is used when the integrity
of data is less important than the its ability
to reach its destination.
For example, streaming video,
VOIP, and online gaming
are often transported
via UDP because the loss of some pixels or some audio is acceptable.
<a href="https://www.cloudflare.com/learning/ddos/glossary/tcp-ip/">TCP</a> is used when the integrity of the data is important.
If the data cannot be transmitted without error,
then the data won't reach its final destination
until the error is corrected.</p>
<p>The <strong>application layer</strong> provides the ability to
use the internet in particular ways.
For example, the <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">HTTP</a> protocol enables
the <strong>web</strong>,
which is simply an <strong>application</strong> on the internet.
The <strong>SMTP</strong>, <strong>IMAP</strong>, and <strong>POP</strong> protocols
control email exchange.
<strong>DNS</strong> is a system that maps IP addresses to domain names.
In this book,
we use <strong>SSH</strong>, also part of the application layer,
to connect to remote computers.</p>
<blockquote>
<p>By <strong>application</strong>, they simply mean that
these protocols provide the functionality for applications.
They are not themselves considered user applications,
like a web browser.</p>
</blockquote>
<h2 id="the-internet-protocol-suite"><a class="header" href="#the-internet-protocol-suite">The Internet Protocol Suite</a></h2>
<h3 id="link-layer"><a class="header" href="#link-layer">Link Layer</a></h3>
<h4 id="arp-address-resolution-protocol"><a class="header" href="#arp-address-resolution-protocol">ARP (Address Resolution Protocol)</a></h4>
<p><strong>ARP</strong> (Address Resolution Protocol) is a protocol
at the link layer and is
used to map network addresses,
like an IP address,
to the ethernet addresses,
also called the MAC or Media Access Control address, or
the hardware address.
Routers use MAC addresses to enable communication
inside networks
(w/in subnets or local area networks)
so that computers within a local network
can talk to each other.
Networks are designed so that IP addresses
are associated with MAC addresses
before systems can communicate over a network.
Everyone of your internet capable devices,
your smartphone, your laptop, your internet connected toaster,
have a MAC address.</p>
<p>To get ARP info for a system,
we use the <code>ip</code> command,
which uses regular options (like <code>-b</code>) and
names specific objects.
To get the MAC address for a specific computer,
we can use the following command,
where <code>ip</code> is the command and
<code>a</code> or <code>link</code> are considered objects
(see <code>man ip</code> for details):</p>
<pre><code>ip a
</code></pre>
<p>On my home system,
the above command produces three numbered sections of output.
The first section refers to the <strong>lo</strong> or loopback device.
This is a special device that allows the computer to
communicate with itself.
It always has an IPv4 address of 127.0.0.1.
The next section on my home machine refers to the ethernet card.
Currently, I'm connected via wifi, and
so this section reports the MAC address for that ethernet card
plus some other other information,
such as whether the device is down or up.
Since there's no physical cable connecting my machine
to the router,
this section reports DOWN.
The third section on my home system refers to the wifi card.
Since this is UP (or active),
it reports the internal IP address (e.g., 192.168.0.4), plus
the MAC address, and other details.
The internal address is different from the machine's
external address,
which might be something like 159.3.45.2.</p>
<p>We can get just the <strong>link</strong> object information
with the following command:</p>
<pre><code>ip link
</code></pre>
<p>The following two commands help identify
parts of the local network (or subnet)
and the routing table.</p>
<pre><code>ip neigh
ip route
</code></pre>
<p>The <code>ip neigh</code> command produces the ARP cache,
basically what other systems your system
is aware of on the local network.
The <code>ip route</code> command is used to
define how data is routed on the network but
can also define the routing table.
Both of these commands are more commonly used on
Linux-based routers.</p>
<p>These details enable the following scenario:
A router gets configured to use a specific <strong>network address</strong>
when it's brought online.
It searches the sub network for connected MAC addresses
that are assigned to wireless cards or ethernet cards.
It then assigns each of those MAC addresses an available
IP address based on the network address.</p>
<h3 id="internet-layer"><a class="header" href="#internet-layer">Internet Layer</a></h3>
<h4 id="ip-internet-protocol"><a class="header" href="#ip-internet-protocol">IP (Internet Protocol)</a></h4>
<p>The Internet Protocol, or <em>IP</em>, address
is used to uniquely identify a host on a network and
place that host at a specific location (its IP <strong>address</strong>).
If that network is subnetted (i.e., routed),
then a host's IP address will have a subnet or
private IP address that will not be
directly exposed to the Internet.
Remember this, there are public IP addresses that
are distinct from private IP addresses.
Public IP addresses are accessible on the internet.
Private IP addresses are not, but
they are accessible on subnets or local area networks.</p>
<p>Private IP address ranges are reserved address ranges,
which means no public internet device will have an
IP address within these ranges.
The private address ranges include:</p>
<div class="table-wrapper"><table><thead><tr><th>Start Address</th><th>End Address</th></tr></thead><tbody>
<tr><td>10.0.0.0</td><td>10.255.255.255</td></tr>
<tr><td>172.16.0.0</td><td>172.31.255.255</td></tr>
<tr><td>192.168.0.0</td><td>192.168.255.255</td></tr>
</tbody></table>
</div>
<p>If you have a router at home, and
look at the IP address for at any of
your devices connected to that router,
like your phone or computer,
you will see that it will have an address
within one of the ranges above.
For example, it might have an IP address
beginning with <strong>192.168.X.X</strong>.
This is a standard IP address range for a home router.
The <strong>10.X.X.X</strong> private range can assign
many more IP addresses on its network,
which is why you'll see that IP range on bigger networks,
like a university's network.
We'll talk more about subnetwork sizes, shortly.</p>
<h4 id="example-private-ip-usage"><a class="header" href="#example-private-ip-usage">Example Private IP Usage</a></h4>
<p>Let's say my office computer's IP address
is <strong>10.163.34.59/24</strong> via a wired connection.
My office neighbor has an
IP address of <strong>10.163.34.65/24</strong> via their wired connection.
Both IP addresses are private because they fall within the
<strong>10.0.0.0 to 10.255.255.255</strong> range.
And it's likely they both exist on the same
subnet since they share the first three <strong>octets</strong>:
<strong>10.163.34.XX</strong>.</p>
<p>However, if we both,
using our respective wired connected computers,
searched Google for <em>what's my IP address</em>,
we will see that we share the same public IP address,
which will be something like <strong>128.163.8.25</strong>.
That is a public IP address because it does not
fall within the ranges listed above.</p>
<p>Without any additional information,
therefore,
we know that all traffic coming from our computers and
going out to the internet looks like it's coming
from the same IP address (<strong>128.163.8.25</strong>).
And in reverse,
all traffic coming from outside our network
first goes to <strong>128.163.8.25</strong> before it's routed
to our respective computers via the router.</p>
<p>Let's say I also have a laptop in my office, and
that it has a wireless connection.
When I check with <code>ip a</code>,
I find that the laptop had the IP address
<strong>10.47.34.150/16</strong>.
You can see there's a different pattern with this IP address.
The reason it has a different pattern is
because this laptop is on an different subnet even
though it's physically sitting next to the wired computer.
This wireless subnet was configured to allow
more hosts to connect to it since it must allow for more devices
(i.e., laptops, phones, etc).
When I searched Google for my IP address from this laptop,
it reports <strong>128.163.238.148</strong>,
indicating that UK owns a range of public IP address spaces.</p>
<p>Here's kind of visual diagram of what this network looks like:</p>
<figure>
<img src="images/18-network.png"
alt="Network diagram"
title="Network diagram">
<figcaption>
Fig. 1. This figure contains a network switch,
which is used to route traffic within a subnet.
The switch relies solely on MAC addresses and not
IP addresses to determine the location of
devices on its subnet.
The router acts as the interface between
the private network and the public network and
is managing two subnets: a wired and a wireless one.
</figcaption>
</figure>
<h4 id="using-the-ip-command"><a class="header" href="#using-the-ip-command">Using the <code>ip</code> Command</a></h4>
<p>The <code>ip</code> command can do more than
provide us information about our network.
We can also use it to turn a connection
to the network on or off (and more).
Here we disable and then enable a connection on a machine.
Note that <strong>enp0s3</strong> is the name of my network card/device.
Yours might have a different name.</p>
<pre><code>sudo ip link set enp0s3 down
sudo ip link set enp0s3 up
</code></pre>
<h3 id="transport-layer"><a class="header" href="#transport-layer">Transport Layer</a></h3>
<p>The internet layer does not transmit content,
like web pages or video streams.
This is the work of the transport layer.
As discussed previously,
the two most common transport layer
protocols are <strong>TCP</strong> and <strong>UDP</strong>.</p>
<h4 id="tcp-transmission-control-protocol"><a class="header" href="#tcp-transmission-control-protocol">TCP, Transmission Control Protocol</a></h4>
<p><em>TCP</em> or Transmission Control Protocol
is responsible for the transmission of data and
for making sure the data arrives at its
destination w/o errors.
If there are errors,
the data is re-transmitted or halted
in case of some failure.
Much of the data sent over the internet is sent using TCP.</p>
<h4 id="udp-user-datagram-protocol"><a class="header" href="#udp-user-datagram-protocol">UDP, User Datagram Protocol</a></h4>
<p>The <strong>UDP</strong> or User Datagram Protocol
performs a similar function as TCP, but
it does not error check and data may get lost.
UDP is useful for conducting voice over internet
calls or for streaming video,
such as through YouTube,
which uses a type of UDP transmission
called <strong>QUIC</strong> that has builtin encryption. </p>
<h4 id="tcp-and-udp-headers"><a class="header" href="#tcp-and-udp-headers">TCP and UDP Headers</a></h4>
<p>The above protocols send data in
data TCP <strong>packets</strong> or UDP <strong>datagrams</strong>, but
<a href="https://www.cloudflare.com/learning/network-layer/what-is-a-packet/">these terms may be used interchangeably</a>.
Packets for both protocols include header
information to help route the data across the internet.
TCP includes <a href="https://www.imperva.com/learn/ddos/tcp-transmission-control-protocol/">ten fields</a> of header data, and
UDP includes <a href="https://www.imperva.com/learn/ddos/udp-user-datagram-protocol/">four fields</a>.</p>
<p>We can see this header data using
the <code>tcpdump</code> command,
which requires <code>sudo</code> or being <strong>root</strong> to use.
The first part of the IP header contains the source address,
then comes the destination address, and so forth.
Aside from a few other parts,
this is the primary information in an IP header.</p>
<p><strong>You should use <code>tcpdump</code> on your local computer and not
on your gcloud instance</strong>.
First we identify the IP number of a host,
which we can do with the <code>ping</code> command, and
then run <code>tcpdump</code>:</p>
<pre><code>ping -c1 www.uky.edu
sudo tcpdump host 128.163.35.46
</code></pre>
<p>While that's running,
we can type that IP address in our web browser,
or enter <strong>www.uky.edu</strong>, and
watch the output of <code>tcpdump</code>.</p>
<p>TCP headers include port information and other
mandatory fields for both source and destination servers.
The SYN, or synchronize, message is sent
when a source or client requests a connection.
The ACK, or acknowledgment, message is sent in response,
along with a SYN message,
to acknowledge the request for a connection.
Then the client responds with an additional ACK message.
This is referred to as the
<a href="https://www.geeksforgeeks.org/tcp-3-way-handshake-process/">TCP three-way handshake</a>.
In addition to the header info,
TCP and UDP packets include the data that's being sent
(e.g., a webpage) and
error checking if it's TCP.</p>
<h4 id="ports"><a class="header" href="#ports">Ports</a></h4>
<p>TCP and UDP connections use ports to bind
internet traffic to specific IP addresses.
Specifically, a <strong>port</strong> associates a process
with an application 
(and is part of the <strong>application layer</strong> of the internet suite),
such as a web service or outgoing email.
That is, ports provide a way to distinguish and
filter internet traffic (web, email, etc)
through an IP address.
For example, all traffic going to IP address 10.0.5.33:80
means that this is <strong>http</strong> traffic for the http web service,
since HTTP is commonly associated with port 80.
Note that the port info is attached to the end of the
IP address via a colon. </p>
<p>Common ports include:</p>
<ul>
<li>21: FTP</li>
<li>22: SSH</li>
<li>25: SMTP</li>
<li>53: DNS</li>
<li>143: IMAP</li>
<li>443: HTTPS</li>
<li>587: SMTP Secure</li>
<li>993: IMAP Secure</li>
</ul>
<p>There's a complete list of the 318
default ports/protocols on your Linux systems.
It's located in the following file:</p>
<pre><code>less /etc/services
</code></pre>
<p>And to get a count of the ports,
we can invert grep for lines starting with a pound sign or are empty</p>
<pre><code>grep -Ev &quot;^#|^$&quot; /etc/services | wc -l
</code></pre>
<p>See also the Wikipedia page:
<a href="https://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers">List of TCP and UDP port numbers</a></p>
<h2 id="ip-subnetting"><a class="header" href="#ip-subnetting">IP Subnetting</a></h2>
<p>Let's now return to the internet layer and
discuss one of the major duties of a systems administrator:
subnetting.</p>
<p>Subnets are used to carve out smaller and more manageable
subnetworks out of a larger network.
They are created using routers that have this capability
(e.g., commercial use routers) and certain types
of network switches.</p>
<h3 id="private-ip-ranges"><a class="header" href="#private-ip-ranges">Private IP Ranges</a></h3>
<p>When subnetting local area networks,
we work with the private IP ranges:</p>
<div class="table-wrapper"><table><thead><tr><th>Start Address</th><th>End Address</th></tr></thead><tbody>
<tr><td>10.0.0.0</td><td>10.255.255.255</td></tr>
<tr><td>172.16.0.0</td><td>172.31.255.255</td></tr>
<tr><td>192.168.0.0</td><td>192.168.255.255</td></tr>
</tbody></table>
</div>
<p>It's important to be able to work with IP addresses
like those listed above in order to subnet; and
therefore, we will need to learn a bit of IP math
along the way.</p>
<h4 id="ip-meaning"><a class="header" href="#ip-meaning">IP Meaning</a></h4>
<p>An IPv4 address is 32 bits (8 x 4),
or four bytes, in size.
In human readable context,
it's usually expressed in the following,
decimal-based, notation style:</p>
<ul>
<li><strong>192.168.1.6</strong></li>
<li><strong>172.16.3.44</strong></li>
</ul>
<p>Each set of numbers separated by a dot is
referred to as an <strong>octet</strong>.
An <strong>octet</strong> is a group of 8 <strong>bits</strong>.
Eight <strong>bits</strong> equal a single <strong>byte</strong>.
By implication, 8 gigabits equals 1 gigabyte, and
8 megabits equals 1 megabyte.
We use these symbols to note the terms:</p>
<div class="table-wrapper"><table><thead><tr><th>Term</th><th>Symbol</th></tr></thead><tbody>
<tr><td>bit</td><td><em>b</em></td></tr>
<tr><td>byte</td><td>B</td></tr>
<tr><td>octet</td><td><em>o</em></td></tr>
</tbody></table>
</div>
<p>Each bit is represented by either a 1 or a 0.
For example, the first address above in binary is:</p>
<ul>
<li><strong>11000000.10101000.00000001.00000110</strong> is <strong>192.168.1.6</strong></li>
</ul>
<p>Or:</p>
<div class="table-wrapper"><table><thead><tr><th>Byte</th><th>Decimal Value</th></tr></thead><tbody>
<tr><td>11000000</td><td>192</td></tr>
<tr><td>10101000</td><td>168</td></tr>
<tr><td>00000001</td><td>1</td></tr>
<tr><td>00000110</td><td>6</td></tr>
</tbody></table>
</div>
<h3 id="ip-math"><a class="header" href="#ip-math">IP Math</a></h3>
<p>When doing IP math,
one easy way to do it is to simply remember
that each bit in each of the above bytes is a
placeholder for the following values:</p>
<pre><code>128 64 32 16 8 4 2 1
</code></pre>
<p>Alternatively, from low to high:</p>
<div class="table-wrapper"><table><thead><tr><th>base-2</th><th>Output</th></tr></thead><tbody>
<tr><td>2<sup>0</sup></td><td>1</td></tr>
<tr><td>2<sup>1</sup></td><td>2</td></tr>
<tr><td>2<sup>2</sup></td><td>4</td></tr>
<tr><td>2<sup>3</sup></td><td>8</td></tr>
<tr><td>2<sup>4</sup></td><td>16</td></tr>
<tr><td>2<sup>5</sup></td><td>32</td></tr>
<tr><td>2<sup>6</sup></td><td>64</td></tr>
<tr><td>2<sup>7</sup></td><td>128</td></tr>
</tbody></table>
</div>
<p>In binary, 192 is equal to 11000000.
It's helpful to work backward.
For IP addresses,
all octets are 255 or less
(256 total, from 0 to 255) and
therefore do not exceed 8 bits or places.
To convert the integer 192 to binary:</p>
<pre><code>1 * 2^7 = 128
1 * 2^6 =  64 (128 + 64 = 192)
</code></pre>
<p>Then STOP.
There are no values left, and
so the rest are zeroes.
Thus: 11000000</p>
<p>Our everyday counting system is base-10, but
binary is base-2, and
thus another way to convert binary to decimal
is to multiple each bit (1 or 0)
by the power of base two of its placeholder:</p>
<pre><code>(0 * 2^0) = 0 +
(0 * 2^1) = 0 +
(0 * 2^2) = 0 +
(0 * 2^3) = 0 +
(0 * 2^4) = 0 +
(0 * 2^5) = 0 +
(1 * 2^6) = 64 +
(1 * 2^7) = 128 = 192
</code></pre>
<p>Another way to convert to binary:
simply subtract the numbers from each value.
As long as there is something remaining or
the placeholder equals the remainder of the
previous subtraction,
then the bit equals 1.
So:</p>
<ul>
<li>192 - 128 = 64 -- therefore the first bit is equal to 1.</li>
<li>Now take the leftover and subtract it:</li>
<li>64 - 64 = 0 -- therefore the second bit is equal to 1.</li>
</ul>
<p>Since there is nothing remaining,
the rest of the bits equal 0.</p>
<h3 id="subnetting-examples"><a class="header" href="#subnetting-examples">Subnetting Examples</a></h3>
<p>Subnetting involves dividing a network
into two or more subnets.
When we subnet,
we first identify the number of hosts,
aka, the size,
we will require on the subnet.
For starters,
let's assume that we need a subnet that can
assign at most 254 IP addresses to the
devices attached to it via the router.</p>
<p>In order to do this,
we need two additional IP addresses:
the <strong>subnet mask</strong> and the <strong>network address/ID</strong>.
The <strong>network address identifies the network</strong> and
the <strong>subnet mask marks the boundary between the network and the hosts</strong>.
Knowing or determining the <strong>subnet mask</strong>
allows us to determine how many hosts
can exist on a network.
Both the <strong>network address</strong> and the <strong>subnet mask</strong>
can be written as IP addresses, but
these IP addresses cannot be
assigned to computers on a network.</p>
<p>When we have determined these IPs,
we will know the <strong>broadcast address</strong>.
This is the last IP address in a subnet range, and
it also cannot be assigned to a connected device/host.
The <strong>broadcast address</strong> is used by a router
to communicate to all connected devices on the subnet.</p>
<p>For our sake, let's work through this process backwards; that is,
we want to identify and describe a network
that we are connected to.
Let's work with two example private IP addresses
that exist on two separate subnets.</p>
<h4 id="example-ip-address-1-19216816"><a class="header" href="#example-ip-address-1-19216816">Example IP Address 1: 192.168.1.6</a></h4>
<p>Using the private IP address 192.168.1.6,
let's derive the network mask and the network address
(or ID) from this IP address.
First, convert the decimal notation to binary.
State the mask, which is <strong>/24</strong>, or <strong>255.255.255.0</strong>.
And then derive the network addressing
using an <strong>bitwise logical AND</strong> operation:</p>
<pre><code>11000000.10101000.00000001.00000110 IP              192.168.1.6
11111111.11111111.11111111.00000000 Mask            255.255.255.0
-----------------------------------
11000000.10101000.00000001.00000000 Network Address 192.168.1.0
</code></pre>
<p>Note the mask has 24 ones followed by 8 zeroes.
That 24 is used as <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing">CIDR</a> notation:</p>
<ul>
<li>192.168.1.6/24</li>
</ul>
<p>For Example 1, we thus have the following subnet information:</p>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>IP</th></tr></thead><tbody>
<tr><td>Netmask/Mask</td><td>255.255.255.0</td></tr>
<tr><td>Network ID</td><td>192.168.1.0</td></tr>
<tr><td>Start Range</td><td>192.168.1.1</td></tr>
<tr><td>End Range</td><td>192.168.1.254</td></tr>
<tr><td>Broadcast</td><td>192.168.1.255</td></tr>
</tbody></table>
</div>
<h4 id="example-ip-address-2-101603875"><a class="header" href="#example-ip-address-2-101603875">Example IP Address 2: 10.160.38.75</a></h4>
<p>For example 2, let's start off with a private
IP address of 10.160.38.75 and a mask of /24:</p>
<pre><code>00001010.10100000.00100110.01001011 IP               10.160.38.75
11111111.11111111.11111111.00000000 Mask            255.255.255.0
-----------------------------------
00001010.10100000.00100110.00000000 Network Address   10.160.38.0
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>IP</th></tr></thead><tbody>
<tr><td>Netmask/Mask</td><td>255.255.255.0</td></tr>
<tr><td>Network ID</td><td>10.160.38.0</td></tr>
<tr><td>Start Range</td><td>10.160.38.1</td></tr>
<tr><td>End Range</td><td>10.160.38.254</td></tr>
<tr><td>Broadcast</td><td>10.160.38.255</td></tr>
</tbody></table>
</div>
<h4 id="example-ip-address-3-1721616224"><a class="header" href="#example-ip-address-3-1721616224">Example IP Address 3: 172.16.1.62/24</a></h4>
<p>For example 3, let's start off with a private
IP address of 172.16.1.62 and a mask of /24:</p>
<pre><code>10101100 00010000 00000001 00100111 IP                172.16.1.62
11111111 11111111 11111111 00000000 Mask            255.255.255.0
-----------------------------------
10101100 00010000 00000001 00000000 Network Address    172.16.1.0
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>IP</th></tr></thead><tbody>
<tr><td>Netmask/Mask</td><td>255.255.255.0</td></tr>
<tr><td>Network ID</td><td>172.16.1.0</td></tr>
<tr><td>Start Range</td><td>172.16.1.1</td></tr>
<tr><td>End Range</td><td>172.16.1.254</td></tr>
<tr><td>Broadcast</td><td>172.16.1.255</td></tr>
</tbody></table>
</div>
<h4 id="determine-the-number-of-hosts"><a class="header" href="#determine-the-number-of-hosts">Determine the Number of Hosts</a></h4>
<p>To determine the number of hosts on a CIDR /24 subnet,
we look at the start and end ranges.
In all three of the above examples,
the start range begins with X.X.X.1 and
ends with X.X.X.254.
Therefore, there are 254 maximum hosts allowed on these subnets because
1 to 254, inclusive of 1 and 254, is 254.</p>
<h4 id="example-ip-address-4-10052316"><a class="header" href="#example-ip-address-4-10052316">Example IP Address 4: 10.0.5.23/16</a></h4>
<p>The first three examples show instances
where the CIDR is set to /24.
This only allows 254 maximum hosts on a subnet.
If the CIDR is set to /16,
then we can theoretically allow 65,534 hosts on a subnet. </p>
<p>For example 4, let's start off then with a private
IP address of 10.0.5.23 and a mask of /16:</p>
<pre><code>00001010.00000000.00000101.00010111 IP Address: 10.0.5.23
11111111.11111111.00000000.00000000 Mask:       255.255.0.0
-----------------------------------------------------------
00001010.00000000.00000000.00000000 Network ID: 10.0.0.0
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>IP</th></tr></thead><tbody>
<tr><td>IP Address</td><td>10.0.5.23</td></tr>
<tr><td>Netmask/Mask</td><td>255.255.0.0</td></tr>
<tr><td>Network ID</td><td>10.0.0.0</td></tr>
<tr><td>Start Range</td><td>10.0.0.1</td></tr>
<tr><td>End Range</td><td>10.0.255.254</td></tr>
<tr><td>Broadcast</td><td>10.0.255.255</td></tr>
</tbody></table>
</div>
<p>Since the last two octets/bytes now vary, we count up
by each octet.
Therefore, the number of hosts is:</p>
<div class="table-wrapper"><table><thead><tr><th>IPs</th><th></th></tr></thead><tbody>
<tr><td>10.0.0.1</td><td></td></tr>
<tr><td>10.0.0.255</td><td>= 256</td></tr>
<tr><td>10.0.1.1</td><td></td></tr>
<tr><td>10.0.255.255</td><td>= 256</td></tr>
</tbody></table>
</div>
<ul>
<li>Number of Hosts = 256 x 256 = 65536</li>
<li>Subtract Network ID (1) and Broadcast (1) = 2 IP addresses</li>
<li>Number of Usable Hosts = 256 x 256 - 2 = 65534</li>
</ul>
<h3 id="ipv6-subnetting"><a class="header" href="#ipv6-subnetting">IPv6 subnetting</a></h3>
<p>We're not going to cover IPv6 subnetting, but
if you're interested,
this is a nice article: <a href="https://supportforums.cisco.com/document/66991/ipv6-subnetting-overview-and-case-study">IPv6 subnetting overview</a></p>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>As a systems administrator,
it's important to have a basic understanding of
how networking works, and
the basic models used to describe the internet
and its applications.
System administrators have to know how to
create subnets and defend against various
network-based attacks.</p>
<p>In order to acquire a basic understanding,
this section covered topics that included:</p>
<ul>
<li>the internet protocol suite
<ul>
<li>link layer</li>
<li>internet layer</li>
<li>transport layer</li>
</ul>
</li>
<li>IP subnetting
<ul>
<li>private IP ranges</li>
<li>IP math</li>
</ul>
</li>
</ul>
<p>In the next section,
we extend upon this and discuss the
domain name system (DNS) and domain names.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="p5-networking-security.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="20-dns-domain-names.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="p5-networking-security.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="20-dns-domain-names.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
