<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Linux Systems Administration</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="linux-sysadmin.html"><strong aria-hidden="true">1.</strong> Linux Systems Administration</a></li><li class="chapter-item expanded "><a href="p1-system-basics.html"><strong aria-hidden="true">2.</strong> System Basics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="01-history-linux-unix.html"><strong aria-hidden="true">2.1.</strong> History of Unix and Linux</a></li><li class="chapter-item expanded "><a href="02-quick-ssh-connect.html"><strong aria-hidden="true">2.2.</strong> Connect to a Remote Server</a></li><li class="chapter-item expanded "><a href="03-filesystem-file-management.html"><strong aria-hidden="true">2.3.</strong> Linux Filesystems and File Management</a></li><li class="chapter-item expanded "><a href="04-file-attributes.html"><strong aria-hidden="true">2.4.</strong> File Attributes</a></li><li class="chapter-item expanded "><a href="05-text-processing-part-1.html"><strong aria-hidden="true">2.5.</strong> Text Processing, Part 1</a></li><li class="chapter-item expanded "><a href="06-text-processing-part-2.html"><strong aria-hidden="true">2.6.</strong> Text Processing, Part 2</a></li><li class="chapter-item expanded "><a href="07-text-editors.html"><strong aria-hidden="true">2.7.</strong> Text Editors</a></li><li class="chapter-item expanded "><a href="08-revisiting-paths.html"><strong aria-hidden="true">2.8.</strong> Revisiting Paths</a></li><li class="chapter-item expanded "><a href="09-bash-scripting.html"><strong aria-hidden="true">2.9.</strong> Bash Scripting</a></li><li class="chapter-item expanded "><a href="10-regular-expressions.html"><strong aria-hidden="true">2.10.</strong> Regular Expressions</a></li></ol></li><li class="chapter-item expanded "><a href="p2-managing-services-software.html"><strong aria-hidden="true">3.</strong> Managing Services and Software</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="11-installing-linux.html"><strong aria-hidden="true">3.1.</strong> Installing Linux in VirtualBox</a></li><li class="chapter-item expanded "><a href="12-logical-volumes.html"><strong aria-hidden="true">3.2.</strong> Logical Volume Management</a></li><li class="chapter-item expanded "><a href="13-virtualbox-nat.html"><strong aria-hidden="true">3.3.</strong> Using NAT in VirtualBox</a></li><li class="chapter-item expanded "><a href="14-webconsole-nat.html"><strong aria-hidden="true">3.4.</strong> NAT Table in VirtualBox</a></li><li class="chapter-item expanded "><a href="15-managing-users-groups.html"><strong aria-hidden="true">3.5.</strong> Managing Users and Groups</a></li><li class="chapter-item expanded "><a href="16-systemd.html"><strong aria-hidden="true">3.6.</strong> systemd</a></li><li class="chapter-item expanded "><a href="17-backup-and-using-dnf.html"><strong aria-hidden="true">3.7.</strong> Backups and DNF</a></li></ol></li><li class="chapter-item expanded "><a href="p3-networking-security.html"><strong aria-hidden="true">4.</strong> Networking and Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="18-tcip-networking.html"><strong aria-hidden="true">4.1.</strong> TCIP Networking</a></li><li class="chapter-item expanded "><a href="19-networking-dns-domains.html"><strong aria-hidden="true">4.2.</strong> DNS and Domain Names</a></li><li class="chapter-item expanded "><a href="20-security-chroot.html"><strong aria-hidden="true">4.3.</strong> Security and chroot</a></li><li class="chapter-item expanded "><a href="21-security-firewall.html"><strong aria-hidden="true">4.4.</strong> Security and Firewalls</a></li></ol></li><li class="chapter-item expanded "><a href="p4-lamp.html"><strong aria-hidden="true">5.</strong> Creating a LAMP Server</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="22-httpd-apache.html"><strong aria-hidden="true">5.1.</strong> Apache2 Web Server</a></li><li class="chapter-item expanded "><a href="23-httpd-php.html"><strong aria-hidden="true">5.2.</strong> Apache2 and PHP</a></li><li class="chapter-item expanded "><a href="24-httpd-virtualhosts.html"><strong aria-hidden="true">5.3.</strong> Apache2 and Virtual Hosts</a></li><li class="chapter-item expanded "><a href="25-httpd-mysql.html"><strong aria-hidden="true">5.4.</strong> Apache2 and MySQL</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Linux Systems Administration</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="linux-systems-administration"><a class="header" href="#linux-systems-administration">Linux Systems Administration</a></h1>
<p>Author: C. Sean Burns<br />
Date: 2022-03-09<br />
Email: <a href="sean.burns@uky.edu">sean.burns@uky.edu</a><br />
Twitter: <a href="https://twitter.com/cseanburns">@cseanburns</a></p>
<p>This short book is based on a series of lectures for my course on Linux Systems Administration.</p>
<p>This is a very rough draft that covers the Fedora distribution. I plan to change to Ubuntu in the next release during the Fall 2022 semester.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>This section is an intro to Linux, its history, and its basic usage.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="history-of-unix-and-linux"><a class="header" href="#history-of-unix-and-linux">History of Unix and Linux</a></h1>
<h2 id="location-bell-labs-part-of-att-new-jersey-late-1960s-through-early-1970s"><a class="header" href="#location-bell-labs-part-of-att-new-jersey-late-1960s-through-early-1970s">Location: Bell Labs, part of AT&amp;T (New Jersey), late 1960s through early 1970s</a></h2>
<ul>
<li>Multics, a time sharing system (that is, more than one person could use it at once)</li>
<li>Multics had issues and was slowly abandoned</li>
<li><a href="http://cs.bell-labs.co/who/ken/">Ken Thompson</a> found an old PDP-7. Started to write UNIX.</li>
<li>Also, the <code>ed</code> text editor was written. Pronounced e.d. but generally sounded out.</li>
<li>This version of UNIX would later be referred to as <em>Research Unix</em></li>
<li><a href="https://www.bell-labs.com/usr/dmr/www/">Dennis Ritchie</a> joined him and created the C language (In October 2011, Steve Jobs passed away a week before Dennis Ritchie, but the world mourned Jobs and Ritchie's death went largely unnoticed).</li>
</ul>
<h2 id="location-berkeley-ca-university-of-california-berkeley-early-to-mid-1970s"><a class="header" href="#location-berkeley-ca-university-of-california-berkeley-early-to-mid-1970s">Location: Berkeley, CA (University of California, Berkeley), early to mid 1970s</a></h2>
<ul>
<li>The code for UNIX was not 'free' but low cost and easily shared.</li>
<li>Ken Thompson visited Berkeley and helped install Version 6 of UNIX <a href="https://en.wikipedia.org/wiki/Berkeley_Software_Distribution">https://en.wikipedia.org/wiki/Berkeley_Software_Distribution</a>.</li>
<li>Bill Joy and others contributed heavily (Joy created vi, which Vim descends from).</li>
<li>This installation of UNIX would eventually become known as the Berkeley Software Distribution, or BSD.</li>
</ul>
<h2 id="att"><a class="header" href="#att">AT&amp;T</a></h2>
<ul>
<li>Until its breakup in 1984, AT&amp;T was not allowed to profit off of patents that were not directly related to its telecommunications businesses.</li>
<li>This agreement with the US government helped protect the company from charges of monopoly, and as a result, they could not commercialize UNIX.</li>
<li>This changed after the breakup. System V UNIX became the standard bearer of commercial UNIX.</li>
</ul>
<h2 id="location-boston-ma-mit-early-1980s-through-early-1990s"><a class="header" href="#location-boston-ma-mit-early-1980s-through-early-1990s">Location: Boston, MA (MIT), early 1980s through early 1990s</a></h2>
<ul>
<li>In the late 1970s, <a href="https://en.wikipedia.org/wiki/Richard_Stallman">Richard Stallman</a> began to notice that software began to become commoditized and as a result, hardware vendors were no longer sharing the code they developed to make their hardware work. During much of his education, software code was not eligible for copyright protection (changed under the Copyright Act of 1976).</li>
<li>Stallman, who thrived in a <em>hacker culture</em> (Wikipedia page on Stallman), began to wage battles against this.</li>
<li>Stallman created the [GNU project][gnuproject] and philosophy (also the creator of GNU Emacs). The project is an attempt to create a completely <strong>free</strong> operating system, that was Unix-like, called GNU.</li>
<li>By the early 1990s, Stallman and others had developed all the utilities needed to have a full operating system, except for a kernel.</li>
<li>This includes the Bash shell, written by <a href="https://opuslogica.com/">Brian Fox</a>.</li>
<li>The philosophy includes several propositions that define free software:</li>
</ul>
<h2 id="the-four-freedoms-per-gnu-project"><a class="header" href="#the-four-freedoms-per-gnu-project">The four freedoms, per GNU Project</a></h2>
<p>[https://www.gnu.org/philosophy/free-sw.html][fourfreedoms]</p>
<blockquote>
<ol start="0">
<li>The freedom to run the program as you wish, for any purpose (freedom 0).</li>
<li>The freedom to study how the program works, and change it so it does your computing as you wish (freedom 1). Access to the source code is a precondition for this.</li>
<li>The freedom to redistribute copies so you can help others (freedom 2).</li>
<li>The freedom to distribute copies of your modified versions to others (freedom 3). By doing this you can give the whole community a chance to benefit from your changes. Access to the source code is a precondition for this.</li>
</ol>
</blockquote>
<h2 id="the-unix-wars-and-the-lawsuit"><a class="header" href="#the-unix-wars-and-the-lawsuit">The Unix wars and the lawsuit</a></h2>
<ul>
<li>Differences in AT&amp;T Unix and BSD Unix arose. The former was aimed at commercialization and the latter aimed at researchers and academics.</li>
<li>UNIX Systems Laboratories, Inc. (USL, part of AT&amp;T) sued Berkeley Software Design, Inc. (BSDi, part of the University of California, Berkeley) for
copyright and trademark violations.</li>
<li>USL ultimately lost the case.</li>
</ul>
<h2 id="the-rise-of-linux-linus-torvalds-university-of-helsinki-finland"><a class="header" href="#the-rise-of-linux-linus-torvalds-university-of-helsinki-finland">The Rise of Linux, Linus Torvalds, University of Helsinki, Finland</a></h2>
<ul>
<li>On August 25, 1991 (30 years ago), [Linus Torvalds][linustorvalds] announced that he had started working on a <strong>free</strong> operating system kernel for the 386 CPU architecture and for the specific hard drives that he had. This <a href="https://www.kernel.org/">kernel</a> would later be named Linux.</li>
<li>Linux technically refers only to the kernel. An operating system kernel handles startup, devices, memory, resources, etc.</li>
<li>His motivation was to learn about OS development but also to have access to a Unix-like system. He already had access to an Unix-like system called
MINIX, but MINIX had some technical and copyright restrictions.</li>
<li>Torvalds has stated that if a BSD or if GNU Hurd were available, then he may not have created the Linux kernel.</li>
<li>But Torvalds and others took the GNU utilities and created what is now called Linux, or GNU/Linux.</li>
</ul>
<h2 id="distributions"><a class="header" href="#distributions">Distributions</a></h2>
<ul>
<li>Soon after Linux development, people would create their own Linux and GNU based operating systems and would distribute.</li>
<li>As such, they became referred to as <em>distributions</em>.</li>
<li>The two oldest distributions that are still in active development include:
<ul>
<li>Slackware</li>
<li>Debian</li>
</ul>
</li>
</ul>
<h2 id="short-history-of-bsd"><a class="header" href="#short-history-of-bsd">Short History of BSD</a></h2>
<ul>
<li>Unix version numbers 1-6 eventually led to BSD 1-4.</li>
<li>At BSD 4.3, all versions had some AT&amp;T code. Desire to remove this code led to BSD Net/1.</li>
<li>All AT&amp;T code was removed by BSD Net/2.</li>
<li>BSD Net/2 was ported to the Intel 386 processor. This became 386BSD and was made available a year after the Linux kernel was released, in 1992.</li>
<li>386BSD split into two projects:
<ul>
<li>NetBSD</li>
<li>FreeBSd</li>
</ul>
</li>
<li>NetBSD split into another project: OpenBSD.</li>
<li>All three of these BSDs are still in active development. From a bird's eye point of view, they each have different foci:
<ul>
<li><a href="https://www.netbsd.org/">NetBSD</a> focuses on portability (MacOS, NASA)</li>
<li><a href="https://www.freebsd.org/">FreeBSD</a> focuses on wide applicability (WhatsApp, Netflix, PlayStation 4, MacOS)</li>
<li><a href="https://www.openbsd.org/">OpenBSD</a> focuses on security (has contributed a number of very important applications)</li>
</ul>
</li>
</ul>
<p>Note: MacOS is based on [Darwin][puredarwin], is <a href="https://www.opengroup.org/membership/forums/platform/unix">technically UNIX</a>, and is partly based on FreeBSD with some code coming from the other BSDs.</p>
<h2 id="short-history-of-gnu"><a class="header" href="#short-history-of-gnu">Short History of GNU</a></h2>
<ul>
<li>The GNU Hurd is still being developed, but it's only in the pre-production state. The last release was 0.9 on December 2016. A complete OS based on the GNU Hurd can be downloaded and ran.</li>
</ul>
<h2 id="free-and-open-source-licenses"><a class="header" href="#free-and-open-source-licenses">Free and Open Source Licenses</a></h2>
<ul>
<li>[GNU General Public License (GPL)][gnugpl]</li>
<li>[BSD License][bsdlicense]</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="quick-ssh-connect"><a class="header" href="#quick-ssh-connect">Quick SSH Connect</a></h1>
<p>Later in the semester, each of you will install virtual machine software so
that you can install a Linux operating system and manage it on your own
computer. Until then, we will need to connect to a remote server in order to
acquire some basic Linux command line skills. To do that, we will use what is
called <a href="https://en.wikipedia.org/wiki/Secure_Shell">SSH</a>, or <a href="https://www.openssh.com/">Secure Shell</a>.</p>
<p>How you use SSH will depend on which operating system or OS version you are
using. If you are using a macOS computer, then everything I do in this video
will be exactly the same for you. Use SpotLight to search for the
<em>terminal.app</em> and open it. You will see a command line prompt similar to mine
(although by default, I think macOS uses black text on a white background, but
you can configure this in the app preferences).</p>
<p>If you are on a Windows machine, then I hope you are using version 10. If so,
then you can install a <em>SSH client</em>. I don't use Windows and can't create
a video for you, but I found one that looks pretty helpful. Follow the
instructions in that video and see if it works for you. Alternatively, below is
a link to some other instructions. I am not sure which one is more current, but
between the two, you should be able to figure it out:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=xIfzZXHaCzQ">How to enable and install Built-in SSH in Windows 10 using the windows
command prompt or powershell</a></li>
<li><a href="https://www.howtogeek.com/336775/how-to-enable-and-use-windows-10s-built-in-ssh-commands/">How to Enable and Use Windows 10â€™s New Built-in SSH
Commands</a></li>
</ul>
<p>If neither of those work for you, then you should install <a href="https://www.chiark.greenend.org.uk/%7Esgtatham/putty/">PuTTY</a>. This is
a great app, and since it's available on Linux, I will show you how to use it
in this video.</p>
<h2 id="linux-and-macos"><a class="header" href="#linux-and-macos">Linux and macOS</a></h2>
<ul>
<li>Open terminal</li>
<li>type: <code>ssh username@ip-address</code></li>
<li>Enter your password</li>
<li>type <code>less README</code></li>
<li>press <code>q</code></li>
<li>type <code>exit</code> to exit the session</li>
</ul>
<h2 id="windows-with-putty"><a class="header" href="#windows-with-putty">Windows with PuTTY</a></h2>
<ul>
<li>Open PuTTY</li>
<li>Enter IP Address in field marked <em>Host Name (or IP address)</em></li>
<li>Click Open at the bottom</li>
<li>Enter your username at the prompt: <code>login as: </code></li>
<li>Enter your password</li>
<li>type <code>less README</code></li>
<li>press <code>q</code></li>
<li>type <code>exit</code> to exit the session</li>
</ul>
<h2 id="putty-configuration"><a class="header" href="#putty-configuration">PuTTY Configuration</a></h2>
<p>If you use PuTTY, then you can configure font size and screen colors, if you
want. The default font size is too small for me, and so that's something I'd
change right away. To change the font size, in the PuTTY window:</p>
<ul>
<li>Click on <em>Fonts</em> under the <em>Window</em> category</li>
<li>Click on <em>Change...</em> next to the item labeled <em>Font used for ordinary text</em>.</li>
<li>Select the font and size that you prefer</li>
</ul>
<p>That's all for today. Keep these notes and next week we start to connect to our
remote Linux server in order to learn some command line basics.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-linuxunix-file-system-and-file-types"><a class="header" href="#the-linuxunix-file-system-and-file-types">The Linux/Unix File System and File Types</a></h1>
<p>In this demo, we will cover the:</p>
<ul>
<li>the Linux file system and how it is organized, and</li>
<li>the basic commands to work with directories and files</li>
</ul>
<p>Throughout this demonstration, I encourage you to <code>ssh</code> into our remote server and follow along with the commands that I use.</p>
<h2 id="visualizing-the-tree-structure"><a class="header" href="#visualizing-the-tree-structure">Visualizing the Tree Structure</a></h2>
<p>First, the term <strong>file system</strong> may refer to different concepts. In come cases, it refers to how data is <a href="https://en.wikipedia.org/wiki/File_system">stored and retrieved</a> on a device like a hard drive, USB drive, etc. For example, macOS uses the <a href="https://support.apple.com/guide/disk-utility/file-system-formats-available-in-disk-utility-dsku19ed921c/mac">Apple File System (APFS)</a> by default, and Windows uses the <a href="https://docs.microsoft.com/en-us/troubleshoot/windows-client/backup-and-storage/fat-hpfs-and-ntfs-file-systems">New Technology File System (NTFS)</a>. Linux and other unix-like operating systems use a variety of file systems. Presently, the two major ones include <strong>ext4</strong> and <strong>btrfs</strong>. The former is the default file system on distributions like <a href="https://www.debian.org/">Debian</a> and <a href="https://ubuntu.com">Ubuntu</a>, but the <a href="https://getfedora.org/">Fedora</a> distribution recently switched to the latter. <a href="https://opensource.com/article/18/4/ext4-filesystem">Opensource.com</a> has a nice overview of file systems under this concept, and we will learn how to use some of them later in the semester when we will create partitions, manage disk volumes, and learn about backups.</p>
<p>The other way that the term <strong>file system</strong> might be used is to refer to the directory structure of a system. This concept is not always directly related to the prior concept of a file system. For example, on Windows, the root file system is identified by a letter, like the <strong>C:</strong> drive regardless if the disk has a NTFS file system or a FAT file system. macOS adheres to a root file system like Linux and other unix-like operating systems. In these operating systems, we have a root, top-level directory identified by a <strong>/</strong>, and then sub-directories (or folders in GUI-speak) under that root directory. <a href="https://www.linux.com/tutorials/linux-filesystem-explained/">Linux.com</a> has a nice overview of the most common directory structure that Linux distributions use along with an explanation for the major bottom level directories.</p>
<p>On Linux, we can visualize the filesystem with the <code>tree</code> command. </p>
<ul>
<li><code>tree</code> : list contents of directories in a tree-like format
<ul>
<li><code>tree -dfL 1</code> : directories only, full path, one level</li>
</ul>
</li>
</ul>
<h3 id="the-root-directory-and-its-base-level-directories"><a class="header" href="#the-root-directory-and-its-base-level-directories">The root Directory and its Base Level Directories</a></h3>
<p>As explained on the Linux.com page, here are the major sub directories under <strong>/</strong>:</p>
<ul>
<li><code>/bin</code> : binary files needed to use the system</li>
<li><code>/boot</code>  : files needed to boot the system</li>
<li><code>/dev</code> : device files -- all hardware has a file</li>
<li><code>/etc</code> : system configuration files</li>
<li><code>/home</code> : user directories</li>
<li><code>/lib</code> : libraries/programs needed for other programs</li>
<li><code>/media</code> : external storage is mounted</li>
<li><code>/mnt</code> : other file systems may be mounted</li>
<li><code>/opt</code> : store software code to compile software</li>
<li><code>/proc</code> : files containing info about your computer</li>
<li><code>/root</code> : home directory of superuser</li>
<li><code>/run</code> : used by system processes</li>
<li><code>/sbin</code> : like <code>/bin</code>, binary files that require superuser privileges</li>
<li><code>/usr</code> : user binaries, etc that might be installed by users</li>
<li><code>/srv</code> : contains data for servers</li>
<li><code>/sys</code> : contains info about devices</li>
<li><code>/tmp</code> : temp files used by applications</li>
<li><code>/var</code> : variable files, used often for system logs</li>
</ul>
<p>Although there are 18 directories listed here and that stem from the root directory, there are some that we'll use much more often than others. For example, since the <strong>/etc</strong> directory contains system configuration files, we will use the contents of this directory, along with the <strong>/var</strong> directory, quite a bit when we set up our web servers, relational database servers, and more. The <strong>/home</strong> directory is where our default home directories are stored, and thus if you manage a multi-user system, like I do for this class, then this will be an important directory. </p>
<p>Source: [Linux Filesystem Explained][8]</p>
<h2 id="basic-directory-and-file-commands"><a class="header" href="#basic-directory-and-file-commands">Basic Directory and File commands</a></h2>
<p>In order to explore the above directories but also to create new ones and work with files, we need to know some basic commands. A lot of these commands are <a href="https://www.gnu.org/software/coreutils/manual/coreutils.html">GNU Coreutils</a>, and in this demo, we will specifically cover some of the following:</p>
<ul>
<li><a href="https://www.gnu.org/software/coreutils/manual/coreutils.html#Directory-listing">Directory Listing</a></li>
<li><a href="https://www.gnu.org/software/coreutils/manual/coreutils.html#Basic-operations">Basic Operations</a></li>
<li><a href="https://www.gnu.org/software/coreutils/manual/coreutils.html#Special-file-types">Special File Types</a></li>
<li><a href="https://www.gnu.org/software/coreutils/manual/coreutils.html#Printing-text">Printing Text</a></li>
</ul>
<h3 id="directory-listing"><a class="header" href="#directory-listing">Directory Listing</a></h3>
<p>We have a few options to list directories, but the most common command is the <code>ls</code> command, and we use it like so:</p>
<pre><code>ls
</code></pre>
<p>However, most commands can be used with <strong>options</strong>. In order to see what options are available for the <code>ls</code> command, we use look at it's <strong>man(ual) page</strong>:</p>
<pre><code>man ls

</code></pre>
<p>From the <code>ls</code> <strong>man page</strong>, we learn that we can use the <code>-l</code> option to format the output of the <code>ls</code> command as a long-list, or a list that provides more information about the files and directories in the working directory.</p>
<p>We can use the <code>-a</code> option to list hidden files. In Linux, hidden files are hidden from the default <code>ls</code> command if the files begin with a period. We have a number of those files in hour <strong>$HOME</strong> directories, and we can see them like so:</p>
<pre><code>ls -a
</code></pre>
<p>We can also combine options. For example, to view all files, including hidden ones, in the long-list format, we can use:</p>
<pre><code>ls -al
</code></pre>
<h2 id="basic-operations"><a class="header" href="#basic-operations">Basic Operations</a></h2>
<p>Some basic operation commands include:</p>
<ul>
<li><code>cp</code> for copying files and directories</li>
<li><code>mv</code> for moving (or renaming) files and directories</li>
<li><code>rm</code> for removing (or deleting) files and directories</li>
</ul>
<p>These commands also have various options that can be viewed in their respective <strong>man pages</strong>. See:</p>
<pre><code>man cp
man mv
man rm
</code></pre>
<p>Here are some ways to use these commands:</p>
<h3 id="copy"><a class="header" href="#copy">copy</a></h3>
<p>To copy an existing file to a new file:</p>
<pre><code>cp file.txt newfile.txt
</code></pre>
<h3 id="move"><a class="header" href="#move">move</a></h3>
<p>To move an existing file in our <strong>$HOME</strong> directory to a subdirectory, like into our <strong>public_html</strong> directory:</p>
<pre><code>mv file.html public_html/file.html
</code></pre>
<h3 id="rename"><a class="header" href="#rename">rename</a></h3>
<p>To rename a file, we also use the <code>mv</code> command:</p>
<pre><code>mv file.html newfile.html
</code></pre>
<h3 id="move-and-rename"><a class="header" href="#move-and-rename">move and rename</a></h3>
<p>To move and rename a file:</p>
<pre><code>mv file.html public_html/newfile.html
</code></pre>
<h3 id="remove-or-delete"><a class="header" href="#remove-or-delete">remove or delete</a></h3>
<p>Finally, to delete a file:</p>
<pre><code>rm file.html
</code></pre>
<h2 id="special-file-types"><a class="header" href="#special-file-types">Special File Types</a></h2>
<p>For now, let's only cover two commands here:</p>
<ul>
<li><code>mkdir</code> for creating a new directory </li>
<li><code>rmdir</code> for deleting a directory</li>
</ul>
<p>Like the above commands, these commands also have their own set of options that can be viewed in their respective <strong>man pages</strong>:</p>
<pre><code>man mkdir
man rmdir
</code></pre>
<h3 id="make-or-create-a-new-directory"><a class="header" href="#make-or-create-a-new-directory">make or create a new directory</a></h3>
<p>We use these commands like we do the ones above. If we are in our <strong>$HOME</strong> directory and we want to create a new directory, we do:</p>
<pre><code>mkdir documents
</code></pre>
<p>And if we run <code>ls</code>, we can see that it was successful.</p>
<h3 id="delete-a-directory"><a class="header" href="#delete-a-directory">delete a directory</a></h3>
<p>The <code>rmdir</code> command is a bit weird because it only removes <strong>empty</strong> directories. To remove the directory we just created, we use it like so:</p>
<pre><code>rmdir documents
</code></pre>
<p>However, if you want to remove a directory that contains files or other sub-directories, then you will have to use the <code>rm</code> command along with the <code>-r</code> option:</p>
<pre><code>rm -r directory-with-content
</code></pre>
<h2 id="printing-text"><a class="header" href="#printing-text">Printing Text</a></h2>
<p>There a number of ways to print text to <strong>standard output</strong>, which is our screen by default in the terminal. We could redirect standard output to a file or to a printer or to a remote shell. We'll get to examples like that later in the semester. Here let's cover two commands:</p>
<ul>
<li><code>echo</code> to print a line of text to standard output</li>
<li><code>cat</code> to concatenate and write files</li>
</ul>
<h3 id="print-to-screen"><a class="header" href="#print-to-screen">print to screen</a></h3>
<p>To use <code>echo</code>:</p>
<pre><code>echo &quot;hello world&quot;
echo &quot;Today is a good day.&quot;
</code></pre>
<h3 id="print-file-to-screen"><a class="header" href="#print-file-to-screen">print file to screen</a></h3>
<p><code>cat</code> is listed elsewhere in the GNU Coreutils page. The primary use of the <code>cat</code> command is to join, combine, or concatenate files, but if used on a single file, it has this nice side effect of printing the content of the file to the screen:</p>
<pre><code>cat file.html
</code></pre>
<p>If the file is very long, we might want to use a <strong>pager</strong>. There are a few options, but the <code>less</code> command is very useful:</p>
<pre><code>less file.html
</code></pre>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>In this demo, we learned about the file system or directory structure of Linux, and we also learned some basic command to work with directories and files. You should practice using these commands as much as possible. The more you use them, the easier it'll get. Also, be sure to review the <strong>man pages</strong> for each of the commands, especially to see what options are available for each of them.</p>
<p>Basic commands covered in this demo include:</p>
<ul>
<li><code>ls</code> : list </li>
<li><code>man</code> : manual pages</li>
<li><code>cp</code> : copy</li>
<li><code>mv</code> : move or rename</li>
<li><code>rm</code> : remove or delete a file or directory</li>
<li><code>mkdir</code> : create a directory</li>
<li><code>rmdir</code> : delete an empty directory</li>
<li><code>echo</code> : print a line of text</li>
<li><code>cat</code> : display contents of a file</li>
<li><code>less</code> : display contents of a file by page </li>
<li><code>tree</code> : list contents of directories in a tree-like format</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="file-attributes"><a class="header" href="#file-attributes">File Attributes</a></h1>
<p>Let's take a look at file attributes. Often we'll have to change the file permissions and owners of a file. This will become really important when we create our web servers.</p>
<ol>
<li><code>chmod</code> for changing file permissions (or file mode bits)</li>
<li><code>chown</code> for changing file owner and group</li>
</ol>
<p>We use <code>chmod</code> to change the file permissions:</p>
<pre><code># Make a file readable and writer for user:
chmod u+rw file.txt

# Make a file executable for user and group:
chmod ug+x file.sh

# Make a file readable by the world:
chmod o+r file.html
</code></pre>
<p>Let's change the ownership of a file so that it's owned by a group we're in:</p>
<pre><code>chown sean:sis_fac_staff file.sh

# Let's make it read only for the group:
chmod g-wx+r file.sh
</code></pre>
<h2 id="conclusion-1"><a class="header" href="#conclusion-1">Conclusion</a></h2>
<p>In this demo, we looked at two ways to change the attributes of a file. This includes changing the ownership of a file and the read, write, and execute permissions of a file.</p>
<p>The commands we used to change these attributes include:</p>
<ul>
<li><code>chmod</code> : for changing file permissions (or file mode bits)</li>
<li><code>chown</code> : for changing file ownwership</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="processing-data-gnu-coreutils-part-1"><a class="header" href="#processing-data-gnu-coreutils-part-1">Processing Data: GNU Coreutils (Part 1)</a></h1>
<h2 id="text-processing"><a class="header" href="#text-processing">Text Processing</a></h2>
<p>We've touched on a few of these commands already, such as:</p>
<ol>
<li><code>touch</code></li>
<li><code>cat</code></li>
<li><code>echo</code></li>
<li><code>pwd</code></li>
<li><code>mkdir</code></li>
<li><code>rmdir</code></li>
<li><code>head</code></li>
<li><code>wc</code></li>
</ol>
<p>We have commands also for getting data on the users:</p>
<ol>
<li><code>who</code></li>
<li><code>w</code></li>
</ol>
<p>Or the local time:</p>
<ol>
<li><code>date</code></li>
</ol>
<p>Today I want to cover some file related commands for processing data in a file; specifically:</p>
<ol>
<li><code>sort</code> for sorting lines of text files</li>
<li><code>uniq</code> for reporting or omitting repeats lines</li>
<li><code>cut</code> for removing from each line of files</li>
<li><code>head</code> for outputting the first part of files</li>
<li><code>tail</code> for outputting the last part of files</li>
</ol>
<p>Let's look at a toy, sample file that contains structured data as a CSV (comma separated value) file:</p>
<pre><code>cat operating-systems.csv

Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
Linux, GPL, 1991
iOS, Propietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>To get data from file:</p>
<pre><code># get the second field, where the fields are separated by a comma &quot;,&quot;
cut -d&quot;,&quot; -f2 operating-system.csv

# get the third field
cut -d&quot;,&quot; -f3 operating-system.csv

# sort it, unique it, and save it in a separate file
cut -d&quot;,&quot; -f3 operating-system.csv | sort | uniq &gt; os-years.csv
</code></pre>
<p>If that CSV file has a header line, then we may want to remove it from the output. First, let's look at the file:</p>
<pre><code>cat operating-systems.csv

OS, License, Year
Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
Linux, GPL, 1991
iOS, Propietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>Say we want the license field data but we want to remove that first line, then we need the tail command:</p>
<pre><code>tail -n +2 operating-system-csv | cut -d, -f2 | sort | uniq &gt; license-data.csv
</code></pre>
<h2 id="conclusion-2"><a class="header" href="#conclusion-2">Conclusion</a></h2>
<p>In this lesson, we learned how to process and make sense of data held in a text file. We drew upon some commands we learned in prior lessons that help us navigate the command line and create files and directories. We also added commands that let us sort and view data in different ways. The commands we used in this lesson include:</p>
<ul>
<li><code>sort</code> : for sorting lines of text files</li>
<li><code>uniq</code> : for reporting or omitting repeats lines</li>
<li><code>cut</code> : for removing from each line of files</li>
<li><code>head</code> : for outputting the first part of files</li>
<li><code>tail</code> : for outputting the last part of files</li>
<li><code>who</code>  : show who is logged on</li>
<li><code>w</code> : show who is logged on and what they are doing.</li>
<li><code>touch</code> : change file timestamps</li>
<li><code>cat</code> : concatenate files and print on the standard output</li>
<li><code>echo</code> : display a line of text</li>
<li><code>pwd</code> : print name of current/working directory</li>
<li><code>mkdir</code> : show who is logged on</li>
<li><code>rmdir</code> : remove empty directories</li>
<li><code>head</code> : output the first part of files</li>
<li><code>wc</code> : print newline, word, and byte counts for each file</li>
</ul>
<p>We also used two types of operators, the pipe and the redirect:</p>
<ul>
<li><code>|</code> : redirect standard output command1 to standard input of command2</li>
<li><code>&gt;</code> : redirect to standard output to a file, overwriting</li>
<li><code>&gt;&gt;</code> : redirect to standard output to a file, appending</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="processing-data-grep-sed-awk-part-2"><a class="header" href="#processing-data-grep-sed-awk-part-2">Processing Data: Grep, Sed, Awk (Part 2)</a></h1>
<h2 id="introduction-1"><a class="header" href="#introduction-1">Introduction</a></h2>
<p>Hi Class -- in this demo, I will cover three additional utilities for processing text: <code>grep</code>, <code>sed</code>, and <code>awk</code>. This page contains the entire transcript for the three programs, but I will break the video up into the three respective parts.</p>
<p>Thus far in class, we have learned about commands like <code>wc</code>, <code>cat</code>, <code>cut</code>, <code>head</code>, <code>tail</code>, <code>sort</code>, and <code>uniq</code>. There are other utilities that help us process data, and these include:</p>
<ul>
<li><code>join</code> for joining lines of two files on a common field</li>
<li><code>paste</code> for merging lines of files</li>
</ul>
<p>We have learned about the <code>|</code> pipe operator, which we use to redirect <strong>standard output</strong> to a different command so that second (or third) command can process the output. An example is: <code>sort file | uniq</code>, which sorts a file first and then identifies the unique lines (by the way, files must be sorted before piped to <code>uniq</code>).</p>
<p>We have learned about the <code>&gt;</code> and <code>&gt;&gt;</code> redirect operators. They work like the pipe operator, but instead of directing output to a new command for the new command to process, they direct output to a file. As a reminder, the single redirect <code>&gt;</code> will overwrite a file or create a file if it does not exist. The double redirect <code>&gt;&gt;</code> will append to an existing file or create a file if it does not exist. It's safer thus to use the double redirect, but if you are processing large amounts of data, it could also mean creating really large files really quickly. If that gets out of hand, then you might crash your system.</p>
<p>The real magic of the Linux command line (and other Unix-like OSes) is this ability to use the pipe and redirect operators to string together multiple commands like the ones that we have covered and to redirect output to files.</p>
<h2 id="grep-sed-and-awk"><a class="header" href="#grep-sed-and-awk">Grep, Sed, and Awk</a></h2>
<p>In addition to the above commands (or utilities) described above, we have additional, and very powerful, programs available to us for processing data. In this demo, I will introduce us to these, and they include <code>grep</code>, <code>sed</code>, and <code>awk</code>. I use these more than I use some of the utilities we have covered so far.</p>
<h3 id="grep"><a class="header" href="#grep">Grep</a></h3>
<p>The <code>grep</code> command is one of my most often used commands. Basically, <code>grep</code> &quot;prints lines that match patterns&quot; (see <code>man grep</code>). In other words, it's search, and it's super powerful.</p>
<p><code>grep</code> works line by line. So when we use it to search a file for a string of text, it will return the whole line that includes the match. Remember, this <strong>line by line</strong> idea is part of the history of Unix-like operating systems, and it's super important to remember that most utilities and programs that we use on the command line have this as the basis of their approach.</p>
<p>Let's consider the file <strong>operating-systems.csv</strong>, as seen below:</p>
<pre><code>OS, License, Year
Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
Linux, GPL, 1991
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p><strong>Quick note:</strong> In the code snippets below, and like in many of my examples, lines starting with a pound sign <strong>#</strong> signal a comment that explains the purpose of the command that follows on the next line.</p>
<pre><code># to search for a string; here we search for the string &quot;Chrome&quot;
grep &quot;Chrome&quot; operating-systems.csv
# repeat the search by be case insensitive; the default is case sensitive
grep -i &quot;chrome&quot; operating-systems.csv
# return lines that do not match and that are case insensitive
grep -vi &quot;chrome&quot; operating-systems.csv
</code></pre>
<p>I used the <code>tail</code> command in class to show how we might use that to remove the header (1st line) in a file, but I don't use <code>tail</code> very often because I have <code>grep</code>. Part of the power with <code>grep</code> is that we can use what are called regular expressions (<strong>regex</strong> for short). Regex is a method used to identify patterns in text via abstractions. They can get complicated, but we can use some easy regex methods.</p>
<pre><code># remove the first line from the output; the carat indicates the start of the line
# thus, this returns results that do not match lines where the start of the line begins with &quot;os&quot;
grep -vi &quot;^os&quot; operating-systems.csv
# remove the first line from the output; the dollar sign indicates the end of the line
# thus, this returns results that do not match lines where the start of the line ends with &quot;year&quot;
grep -vi &quot;year$&quot; operating-systems.csv
</code></pre>
<p>Other <code>grep</code> options:</p>
<pre><code># returns lines that have the string &quot;proprietary&quot;
grep -i &quot;proprietary&quot; operating-systems.csv
# get a count of those lines
grep -ic &quot;proprietary&quot; operating-systems.csv
# print only the match and not the whole line
grep -io &quot;proprietary&quot; operating-systems.csv

</code></pre>
<h3 id="sed"><a class="header" href="#sed">Sed</a></h3>
<p>I spoke about the <code>ed</code> command. That and editors like <code>vi</code> or <code>vim</code> all belong to the same family of programs. <code>sed</code> belongs to this family, too. Specifically, <code>sed</code> is a &quot;stream editor ... used to perform basic text transformations on an input stream (a file or input from a pipeline&quot;) (see <code>man sed</code>). By default, <code>sed</code> works on <strong>standard output</strong>, but it can be used to edit and write to files.</p>
<p>Like <code>ed</code>, <code>vim</code>, and <code>grep</code>, <code>sed</code> works line by line. Unlike <code>grep</code>, <code>sed</code> uses <strong>addresses</strong> to specify lines or ranges of lines, and these addresses are followed by a command. </p>
<p>All text files are considered to have lines that start with the number 1. So another way to remove the header line of our <strong>operating-systems.csv</strong> file is to simply delete the first line:</p>
<pre><code># delete (d command) line one from standard output; 
sed '1d' operating-systems.csv
</code></pre>
<p>If I wanted to make that a permanent deletion, then I would use the <code>-i</code> option, which means that I would edit the file in place (see <code>man sed</code>).</p>
<pre><code># Let's work on a copy and not the original file just for the example
cp operating-systems.csv os.csv
# now let's delete the first line from standard output
sed -i '1d' os.csv
</code></pre>
<p>To refer to line <strong>ranges</strong>, then I add a comma between <strong>addresses</strong>:</p>
<pre><code># delete the lines one through three; you would add the -i option to edit the file inplace
sed '1,3d' operating-systems.csv
</code></pre>
<p>I can use <code>sed</code> to <strong>find and replace</strong> strings:</p>
<pre><code># find string &quot;Linux&quot; and replace with &quot;GNU/Linux&quot;
# the 's' command means search
# the string within after the forward slash indicates the search term
# the string after the second forward slash indicates the replace term
# the \ is an escape character so that sed interprets the forward slash literally
# the ending 'g' command means &quot;global&quot;, or all instances.
# Without it, it would stop after the first instance

sed 's/Linux/GNU\/Linux/g' operating-systems.csv
</code></pre>
<p>I can append <code>a</code> or insert <code>i</code> text:</p>
<pre><code># append line after line 3 with the 'a' command
sed '3a iOS, Proprietary, 2007' operating-systems.csv
# insert line at line 3 with the 'i' command
sed '3i iOS, Proprietary, 2007' operating-systems.csv
</code></pre>
<p>For example, say I forgot to add the <strong>shebang</strong> at the top of a script named <strong>test.sh</strong>, I could use <code>sed</code> like so (<strong>Note:</strong> the above command will only work on a non-empty file):</p>
<pre><code>sed -i '1i #!/usr/bin/bash' test.sh
</code></pre>
<h3 id="awk"><a class="header" href="#awk">Awk</a></h3>
<p><code>awk</code> or <code>gawk</code> is a complete scripting language for &quot;pattern scanning and processing&quot; text (see <code>man awk</code>). It's a powerful language, and its focus is on columns of structured data.</p>
<p>In <code>awk</code>, columns of a file are identified by a dollar sign and then the number of the column. So, <code>$1</code> indicates column 1, and <code>$2</code> indicates column 2. If we use <code>$0</code>, then we refer to the entire file.</p>
<p>The syntax for <code>awk</code> is a little different. Basically, <code>awk</code> uses the following syntax, where <strong>pattern</strong> is optional.</p>
<pre><code>awk pattern { action statements }
</code></pre>
<p>To print the first column of our file, then:</p>
<pre><code># print column one
awk '{ print $1 }' operating-systems.csv
# print column one that includes the term 'Linux'
awk '/Linux/ { print $1 }' operating-systems.csv
</code></pre>
<p><code>awk</code> by default considers the first empty space as the field delimiter. That's why when I printed the first column above, only the term <strong>Windows</strong> appeared in the results even though it should be <strong>Windows NT</strong>. To specify that we want <code>awk</code> to treat the comma as a field delimiter, we use the <code>-F</code> option and we surround the comma with a couple of single quotes:</p>
<pre><code># use -F to tell awk that the comma is the separator or delimiter
awk -F',' '{ print $1 }' operating-systems.csv
</code></pre>
<p>Now we can do a bit more with columns:</p>
<pre><code># print select columns, like column 1 and 3
awk -F',' '{ print $1 $3 }' operating-systems.csv
# make a report by adding some text
awk -F',' '{ print $1 &quot; was founded in&quot; $3 }' operating-systems.csv
</code></pre>
<p>Since <code>awk</code> is a full-fledged programming language, it understands data structures, which means it can do math or work on strings of text. Let's return lines where the year is greater than some number. </p>
<pre><code># print all of column 3
awk -F',' '{ print $3 }' operating-systems.csv
# print only the parts of column 3 that are greater than 2005
awk -F',' '$3 &gt; 2005 { print $3 }' operating-systems.csv
# print only the parts of column 3 that are equal to 2007
awk -F',' '$3 == 2007 { print $3 }' operating-systems.csv
# print only the parts of columns 1 and 3 where column 3 equals 2007
awk -F',' '$3 == 2007 { print $1 $3 }' operating-systems.csv
# print the entire line where column three equals 2007
awk -F',' '$3 == 2007 { print $0 }' operating-systems.csv
# print only those lines where column 3 is greater than 200 and less than 2008
awk -F',' '$3 &gt; 2000 &amp;&amp; $3 &lt; 2008 { print $0 }' operating-systems.csv
# even though we wouldn't normally add years up, let's print the sum of column 3
awk -F',' 'sum += $3 { print sum }' operating-systems.csv
</code></pre>
<p>Here are a few basic string operations:</p>
<pre><code>awk -F',' '{ print toupper($1) }' operating-systems.csv
awk -F',' '{ print tolower($1) }' operating-systems.csv
awk -F',' '{ print length($1) }' operating-systems.csv
</code></pre>
<p>We can add additional logic. The double ampersands <code>&amp;&amp;</code> indicate a Boolean/Logical <strong>AND</strong>. The exclamation point <code>!</code> indicates a Boolean/Logical <strong>NOT</strong>.</p>
<pre><code># print only those lines where column three is greater than 1990
# and the line has the string &quot;BSD&quot; in it
awk -F',' '$3 &gt; 1990 &amp;&amp; /BSD/ { print $0 }' operating-systems.csv
# print only those lines where column three is greater than 1990
# and the line DOES NOT have the string &quot;BSD&quot; in it; here we use the 
# exclamation point to signal a Boolean NOT
awk -F',' '$3 &gt; 1990 &amp;&amp; !/BSD/ { print $0 }' operating-systems.csv
</code></pre>
<p>And now, the double vertical bar <code>||</code> indicates a Boolean/Logical <strong>OR</strong>:</p>
<pre><code># print only those lines that contain the string &quot;Proprietary&quot; or the string &quot;Apache&quot; (prints both)
awk -F',' '/Proprietary/ || /Apache/ { print $0 }' operating-systems.csv
# consider lower case letters. Here use the square brackets to indicate alternate letters
awk -F',' '/[pP]roprietary/ || /[aA]pache/ { print $0 }' operating-systems.csv
</code></pre>
<p><code>awk</code> is full-fledged programming language. It provides all sorts of conditionals, control structures, variables, etc. Feel free to explore at:</p>
<p>Here's an example of how I've used <code>awk</code> recently:</p>
<pre><code>#!/bin/bash

# Check how much time left to sync email
# Sean Burns

systemctl status --user mbsync.timer |\
         awk -F&quot;;&quot;\
         '/Trigger:/ &amp;&amp; $2 == &quot;&quot; { print &quot;Syncing...&quot;}
         /Trigger:/ &amp;&amp; $2 != &quot;&quot; { print &quot;Time left to sync: &quot; $2}'
</code></pre>
<h2 id="conclusion-3"><a class="header" href="#conclusion-3">Conclusion</a></h2>
<p>The Linux (and other Unix-like OSes) command line offers a lot of utilities to examine data. Prior to this lesson, we covered a few of them that help us get parts of a file and then pipe those parts through other commands or redirect output to files. We can use pipes and redirects with <code>grep</code>, <code>sed</code>, and <code>awk</code>, also, if needed, but we may be able to avoid using the basic utilities like <code>cut</code>, <code>wc</code>, etc if want to learn more powerful programs like <code>grep</code>, <code>sed</code>, and <code>awk</code>.</p>
<p>It's fun to learn and practice these. Despite this, you do not have to become a <code>sed</code> or an <code>awk</code> programmer. Like the utilities that we've discussed in prior lectures, the power of programs like these is that their on hand and easy to use as <strong>one-liners</strong>. If you want to get started, the resources below offer nice lists of pre-made one-liners:</p>
<ul>
<li><a href="https://edoras.sdsu.edu/doc/sed-oneliners.html">sed one-liners</a></li>
<li><a href="https://catonmat.net/awk-one-liners-explained-part-one">awk one-liners</a> : this is part 1 with links to additional parts</li>
<li><a href="https://wikis.utexas.edu/display/bioiteam/Scott%27s+list+of+linux+one-liners">compilation of one-liners</a> : this one is good just in that is shows how you can use the pipe operator with a bunch of the utilities we've discussed</li>
</ul>
<p>The commands we used in this session incuded:</p>
<ul>
<li><code>join</code> : join lines of two files on a common field</li>
<li><code>paste</code> : merge lines of files</li>
<li><code>grep</code> : print lines that match patterns</li>
<li><code>sed</code> : stream editor for filtering and transforming text</li>
<li><code>awk</code> : pattern scanning and text processing language</li>
</ul>
<p>We also used two types of operators, the pipe and the redirect:</p>
<ul>
<li><code>|</code> : redirect standard output command1 to standard input of command2</li>
<li><code>&gt;</code> : redirect to standard output to a file, overwriting</li>
<li><code>&gt;&gt;</code> : redirect to standard output to a file, appending</li>
</ul>
<p>Please explore and try these out yourselves!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="text-editors"><a class="header" href="#text-editors">Text editors</a></h1>
<p>In addition to writing commands at the command prompt, we can also write commands (and other kinds of text) in text editors, save those files as scripts, and then execute the files so that the commands in the script run. This process can save lots of time, especially when we find ourselves writing longer commands. We can enter long commands at the command prompt, but it is difficult to fix errors when writing multi-line commands there.</p>
<p>It's important to have some familiarity with command line text editors not just because we may need to write out longer scripts, but also because command line text editors may be the primary way we have of modifying configuration files on a server. We'll learn more about configuration files later in the semester, but these are files, often in the <code>/etc/</code> directory, which define the parameters of various services on a server, such as how a web server delivers web sites or how a firewall blocks certain kinds of internet connections. Graphical based text editors can be nice, but graphical user environments are not always available on servers because of the computer resources they require, which are better used for the purposes of the server, and because the security bugs that come with graphical user software unnecessarily increase the <a href="https://en.wikipedia.org/wiki/Attack_surface">attack surface</a> of the server.</p>
<p>In this demo, I am going to address three text editor programs and I will start with the most difficult one to learn (<code>ed</code>) and end with the easiest one to learn (<code>nano</code>). For this course, I suggest that you use <code>nano</code>, but the first two text editors, <code>ed</code> and <code>vim</code>, are very much a part of Unix and Linux culture. I want you to be familiar with them for that reason but also because their basic designs have influenced a lot of other common technologies.</p>
<h2 id="ed"><a class="header" href="#ed"><code>ed</code></a></h2>
<p><code>ed</code> is specifically a line editor, and it's the most likely text editor to be installed on a Linux distribution (<code>nano</code> is installed by default on Fedora now). <code>ed</code>, or an early version of it, is also the first text editor for the Unix operating system and was developed by Ken Thompson, one of the Unix creators, in the late 1960s. It was written without computer monitors in mind, because those were still uncommon, and instead for <a href="https://en.wikipedia.org/wiki/Teleprinter">teletypewriters (TTYs)</a> and <a href="https://www.youtube.com/watch?v=2B-U-5ylvWo">printers</a>. If you visit that second link, what you will essentially see is the terminal interface from those earlier days, and it is the same basic interface you're using when you use your terminal applications, which are now virtualised versions of those old teletypewriters. It's a testament of the power of the terminal that advanced computer users still use the same basic technology today.</p>
<p>In practice, when we use a line editor like <code>ed</code>, the main process of entering text is like any other editor. The big difference is when we need to manipulate the text. In a graphical based text editor, if we want to delete a word or edit some text, we might just backspace over the text or highlight a word and delete it. In a line editor, we manipulate text by referring to lines or across multiple lines and then run commands on the text in those line(s). To operationalize this, this means that each line has an <strong>address</strong>, and the address for line 7 is, for example, <strong>7</strong>, and so forth. Line editors like <code>ed</code> are command driven. There is no menu to select from at the top of the <em>window</em>. Instead, if a user wants to delete a word, the user first has to direct the line editor to the relevant line by its address and then command the line editor to delete the word on that line. Line editors can also work on ranges of line, including all the lines in the file.</p>
<p>Commands are cryptic in line editors and usually are called by a single letter. For example, to delete a line in <code>ed</code>, we use the <strong>d</strong> command. To print a line, we use the <strong>p</strong> command. To <strong>substitute</strong> (or replace) a word in a line, we use the <strong>s</strong> command. If I wanted to delete line 7 in <code>ed</code>, I'd first enter the address and then the <strong>d</strong> command at the <code>ed</code> prompt:</p>
<pre><code>7d
</code></pre>
<p>And to print it, I would enter the address and then the <strong>p</strong> command:</p>
<pre><code>7p
</code></pre>
<p>Substituting a word is a tiny bit more complicated because it involves first addressing the line and then searching the line for the word to substitute. This process means that there is a bit more to the command. Here the syntax is:</p>
<pre><code>[ADDRESS[,ADDRESS]]COMMAND[PARAMETERS]
</code></pre>
<p>The square brackets in this format example are not used in the actual commands but only to demarcate the parts of the command. The first ADDRESS is required, but the second ADDRESS is optional and would be used only if I wanted to indicate a range of lines. The COMMAND is stated, and if additional parameters are needed, then those are optional. Imagine then that on line 7, I had the following sentence:</p>
<pre><code>I use linux.
</code></pre>
<p>Now imagine that I am editing the file and realize that the word <strong>linux</strong> is a proper noun and should be capitalized. The substitute command requires that I first <strong>address</strong> line 7, then state the command <strong>s</strong>, and then search for the word <strong>linux</strong>, and then replace it with the word <strong>Linux</strong>.</p>
<pre><code>7s/linux/Linux/
</code></pre>
<p>You can see that the operation we're doing is familiar to you already because it's like finding and replacing text in a word processor:</p>
<pre><code>7s/find/replace/
</code></pre>
<p>If I wanted to substitute or replace the word <strong>linux</strong> with <strong>Linux</strong> on lines 5-7, then I'd indicate that on the <strong>address range</strong> by typing <code>5,7</code>, which <code>ed</code> interprets as lines 5, 6, 7 (like <strong>5-7</strong>):</p>
<pre><code>5,7s/linux/Linux/
</code></pre>
<p>Line editors like <code>ed</code> are also modal, which means they have separate <a href="https://en.wikipedia.org/wiki/Mode_(user_interface)">modes</a> for inputting text and for issuing commands on text. Text editors in graphical user environments, like Notepad on Microsoft Windows or TextEdit on macOS, are <strong>modeless</strong>---the user can switch between writing text and editing text without changing the environment and by using keyboard shortcuts (like Ctrl-c or Cmd-c to copy) or using the menu bar. But in modal text editors, <code>vim</code> included, the user has to enter one mode to write text (the <strong>input mode</strong>) and another mode to run commands on the text (the <strong>command mode</strong>) (<code>vim</code> has many modes but three main ones).</p>
<p>To start with ed, I simply type <code>ed</code> on the Bash prompt followed by an optional file name to work on, which could be a new file or an existing file. Let's say I wanted to create a file called <strong>letter.txt</strong>, then I'd type:</p>
<pre><code>ed letter.txt
letter.txt: No such file or directory
</code></pre>
<p>Here we see that when <code>ed</code> opens, it's not very forthcoming or user friendly and if the file <strong>letter.txt</strong> does not already exist, it returns an error message informing of us that. Also, by default we are in command mode. To enter <strong>insert</strong> mode so that I an start writing my letter, I can type an <strong>i</strong> for <strong>insert</strong> or an <strong>a</strong> for <strong>append</strong>:</p>
<pre><code>a
Dear Students,

I hope you find this really interesting and that you feel free to practice and play on the command line, as well as use tools like ed, the standard editor.

Sincerely,
Dr. Burns
.
</code></pre>
<p>After I've typed that letter, my goal is to leave <strong>insert</strong> mode and enter <strong>command</strong> mode, which I need to do if I just want to save and exit <code>ed</code>. I do that at the end when I press return to get a new line and typed a period by itself. This is how we tell <code>ed</code> to exit <strong>input</strong> mode and enter <strong>command</strong> mode.</p>
<p>The first line is line 1, but it's not obvious that this is always so, and it would be hard to know a line number in <code>ed</code> when the file is long. To see line numbers, I can tell <code>ed</code> to show them to me with the following command:</p>
<pre><code>,n
</code></pre>
<p>That will display all the line numbers in the file because the comma is
shorthand for the entire address space. Or I could tell <code>ed</code> to show me line
numbers for a range:</p>
<pre><code>2,3n
</code></pre>
<p>And that will print out lines 2 and 3 with line numbers. If I wanted to print those two lines without line numbers, then I switch <strong>n</strong> for <strong>p</strong>:</p>
<pre><code>2,3p
</code></pre>
<p>The non-shorthand way to refer to the entire address space, range 1 to the last line, would be to write <code>1,$n</code>, where <strong>1</strong> marks the first line and <strong>$</strong> marks the last line.</p>
<p>There's a lot more we can do with this text editor because it's extremely powerful, but for now, let me just show you how to exit. To do so, make sure you're in <strong>command</strong> mode (press enter to get a new line and then press <strong>.</strong> (or period) to enter <strong>command</strong> mode. If you want to save the file and then quit, then type:</p>
<pre><code>w
q
</code></pre>
<p>If you want to quit without saving, then type:</p>
<pre><code>Q
</code></pre>
<p>It's good to know something about <code>ed</code> not just for cultural reasons, but also because the line editing technology developed for it is still in use today, and is a basic part of the <code>vim</code> text editor, which is a very widely used application.</p>
<h2 id="vim"><a class="header" href="#vim"><code>vim</code></a></h2>
<p>The <code>vim</code> text editor is a take on the <code>vi</code> text editor and is in fact called <strong>Vi IMproved</strong>. Although <code>vim</code> is not a line editor, but a screen-oriented editor, it is multi-modal like <code>ed</code> and in fact is its direct descendant through <a href="https://en.wikipedia.org/wiki/Vi">vi</a>.  Due to this genealogy, <code>vim</code> can use many of the same commands as <code>ed</code> does when <code>vim</code> is in command mode. Like <code>ed</code>, we can start <code>vim</code> at the Bash prompt with or without a file name. Here I will open the <strong>letters.txt</strong> file with <code>vim</code>, and will automatically be in <strong>command mode</strong>:</p>
<pre><code>vim letters.txt
</code></pre>
<p>To enter <strong>insert mode</strong>, I can type <strong>i</strong> or <strong>a</strong> for <strong>insert</strong> or <strong>append</strong> mode. The difference is that <strong>i</strong> will start <strong>insert</strong> mode where the cursor lies, and <strong>a</strong> will start <strong>insert</strong> mode right-adjacent to the cursor. Once in <strong>insert</strong> mode, you can type text as you normally would and use the arrow keys to navigate around the file.</p>
<p>To get into <strong>command mode</strong> in <code>vim</code>, you can press the <strong>Esc</strong> key. And then you can enter commands like you would with <code>ed</code>, using the same syntax:</p>
<pre><code>[ADDRESS[,ADDRESS]]COMMAND[PARAMETERS]
</code></pre>
<p>Unlike <code>ed</code>, when in <strong>command mode</strong>, the commands we type are not wherever the cursor is, but at the bottom of the screen. Let's first turn on line numbers so we know which address is which, and then we'll replace <strong>ed</strong> with <strong>Ed</strong>. Note that I precede these commands with a colon:</p>
<pre><code>:set number
:3s/ed/Ed/
</code></pre>
<p>One of the more powerful things about both <code>ed</code> and <code>vim</code> is that I can call Bash shell commands from the editors. Let's say that I wanted to add the date to my letter file. To do that, Linux has a command called <code>date</code> that when typed and executed, will return today's date. To call the <code>date</code> command within Vim and insert the output into the file, I press <strong>Esc</strong> to enter <strong>command mode</strong> (if I'm not already in it), enter a colon, and then use the shell escape command, which is an exclamation point <code>!</code>, type a space, then <code>r</code> for the read file into buffer command, and then the Bash shell <code>date</code> command:</p>
<pre><code>:! r date
</code></pre>
<p>Vim/vi users also love the navigation keystrokes to move around <code>vim</code>, which are the <strong>j,k,l,h</strong> keystrokes:</p>
<ul>
<li><strong>j</strong> moves down line by line</li>
<li><strong>k</strong> moves up line by line</li>
<li><strong>l</strong> moves right letter by letter</li>
<li><strong>h</strong> moves left letter by letter</li>
</ul>
<p>Like the other commands, you can precede this with addresses. To move 2 lines down in <code>vim</code>, you type <code>2j</code>, and so forth. Vi/Vim have had such a powerful impact on software development that you can in fact use these same keystrokes to navigate a number of sites such as Gmail and Facebook.</p>
<p>To save the file and exit <code>vim</code>, we go into <strong>command mode</strong> by pressing the <strong>Esc</strong> key, and then:</p>
<pre><code>:wq
</code></pre>
<p>The above only barely scratches the surface and there are whole books on these editors as well as websites, videos, etc that explore them, and especially <code>vim</code> in more detail. But now that you have some familiarity with them, you might find this hilarious: <a href="https://www.gnu.org/fun/jokes/ed-msg.en.html">Ed, man! !man ed</a>.</p>
<h2 id="nano"><a class="header" href="#nano"><code>nano</code></a></h2>
<p>The <code>nano</code> text editor is the user-friendliest of these text editors but still requires some adjustment as a new command line user. The friendliest thing about <code>nano</code> is that it is modeless, which is what you're already accustomed to using, because it can be used to enter text and manipulate the text without changing to insert or command mode. It is also friendly because, like many graphical text editors and other graphical software, it uses control keys to perform its operations. The tricky part is that the control keys are assigned to different keystroke combinations than what many graphical editors (or word processors) use. For example, instead of Ctrl-c or Cmd-c to copy, in <code>nano</code> you press the <strong>Alt-6</strong> keys (press <strong>Alt</strong> and <strong>6</strong>). Then to paste, you press <strong>Ctrl-u</strong> instead of the more common <strong>Ctrl-v</strong>. Fortunately, <code>nano</code> lists the shortcuts at the bottom of the screen.</p>
<p>The shortcuts listed need some explanation. The carat mark is shorthand for the keyboard's <strong>Control (Ctrl)</strong> key. Therefore to Save As a file, we <strong>write</strong> out the file by pressing <strong>Ctrl-o</strong> (<strong>Ctrl-s</strong> works but will not return any prompts). The <strong>Alt</strong> key is also important, and the shorthand for that is <strong>M-</strong>. To mark (highlight) text, you press <strong>Alt-a</strong>, which is listed as <strong>M-A</strong> in the shortcut list at the bottom of the screen, then move the cursor over the text that you want to highlight. If your goal is to copy, then press <strong>Alt-6</strong> to copy the marked (highlighted) text. Move to where you want to paste the text, and press <strong>Ctrl-u</strong> to paste.</p>
<p>For the purposes of this class, that's all you really need to know about <code>nano</code>. Use it and get comfortable writing in it. Some quick tips:</p>
<ol>
<li><code>nano file.txt</code> will open the file named file.txt</li>
<li><code>nano</code> will open to an empty page</li>
<li>In <code>nano</code>, save a file by pressing <code>Ctrl-o</code> or <code>Ctrl-s</code></li>
<li>Be sure to follow the prompts at the bottom of the screen</li>
<li>Use the arrow keys to navigate around the page/file</li>
</ol>
<h2 id="conclusion-4"><a class="header" href="#conclusion-4">Conclusion</a></h2>
<p>In prior lessons, we learned how to use the Bash interactive shell and how to view, manipulate, and edit files from that shell. In this lesson, we learned how to use several command line text editors. This allows us to save our commands and create scripts. The commands we used in this lesson include:</p>
<ul>
<li><code>ed</code> : line-oriented text editor</li>
<li>``vim` : Vi IMproved, a programmer's text editor</li>
<li><code>nano</code> : Nano's ANOther editor, inspired by Pico</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="revisiting-paths"><a class="header" href="#revisiting-paths">Revisiting Paths</a></h1>
<p>Here's a video on using the command line to navigate the file system or the paths. This is not a transcript, but in this video, I use commands like:</p>
<ul>
<li><code>cd</code> to change directories
<ul>
<li><code>cd -</code> (cd dash) to change to the previous working directory</li>
<li><code>cd ~</code> (cd tilde) to change to the home directory</li>
<li><code>cd ..</code> (cd dot dot) to change to the directory up one level</li>
</ul>
</li>
<li><code>mkdir -p</code> to make multiple directories</li>
<li><code>rm</code> to remove files
<ul>
<li><code>rm ../file.txt</code> to remove a file up one level </li>
<li><code>rm ~/file.txt</code> to remove a file in my home directory</li>
<li><code>rm ~/test0/test1/test2/file.txt</code> to remove a file nested in multiple sub-directories</li>
</ul>
</li>
<li><code>cp</code> to copy files
<ul>
<li><code>cp file.txt ../../../</code> to copy a file multiple directories up from current position</li>
<li><code>cp bin/file.txt documents/file.txt</code> to copy a file in my bin directory to my documents directory</li>
</ul>
</li>
<li><code>mv</code> to move or rename a file
<ul>
<li><code>mv file.txt test0/test1/test2/</code> to move a file in my home directory to the nested directories</li>
<li><code>mv bin/file.txt documents/file.txt</code> to move a file from my bin directory to my documents directory</li>
</ul>
</li>
<li><code>tree -d</code> to visualize the directory structure from my current directory</li>
<li><code>find . -name &quot;file.txt&quot;</code> to search for a file in my directories that's named &quot;file.txt&quot;</li>
</ul>
<p>I hope this video helps. Please let me know if you have any questions.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bash-scripting"><a class="header" href="#bash-scripting">Bash Scripting</a></h1>
<h2 id="resources"><a class="header" href="#resources">Resources</a></h2>
<p>Here are some useful guides and cheat sheets on Bash scripting:</p>
<ul>
<li><a href="https://devhints.io/bash">Bash scripting cheatsheet</a></li>
<li><a href="https://www.shellcheck.net/">Bash shellcheck</a></li>
</ul>
<h2 id="variables"><a class="header" href="#variables">Variables</a></h2>
<p>Declare a variable with the name of the variable, an equal sign, and then the value of the variable within double quotes. Do not insert spaces:</p>
<pre><code>name=&quot;Sean&quot;
backup=&quot;/media/&quot;
# test it out:
echo &quot;$name&quot;
echo &quot;$backup&quot;
cd &quot;$backup&quot;
cd
</code></pre>
<p>Variables may include values that may change given some context. For example, if we want a variable to refer to today's day of week, we can use <a href="https://www.gnu.org/software/bash/manual/html_node/Command-Substitution.html">command substitution</a>, which &quot;allows the output of a command to replace the command name&quot; (see <code>man bash</code>). Thus, the output at the time this variable is set will differ if it is set on a different day.</p>
<pre><code>today=&quot;$(date +%A)&quot;
echo &quot;$today&quot;

</code></pre>
<p>We can print the variable a number of ways. We can call it with a dollar sign and the name of the variable:</p>
<pre><code>echo $today
</code></pre>
<p>But it's safer to wrap the variable in double quotes:</p>
<pre><code>echo &quot;$today&quot;
</code></pre>
<p>A useful and safe way to print or refer to a variable, is to use the dollar sign plus the variable name and surround these in curly braces and quotations:</p>
<pre><code>echo &quot;${name}&quot;
echo &quot;${backup}&quot;
echo &quot;${today}&quot;
</code></pre>
<p>The curly braces are not strictly necessary, but they offer benefits when we start to use things like <a href="https://tldp.org/LDP/Bash-Beginners-Guide/html/sect_10_02.html">array variables</a>. See:</p>
<ul>
<li><a href="https://www.howtogeek.com/725657/how-to-use-brace-expansion-in-linuxs-bash-shell/">How to use curly braces in Bash</a></li>
<li><a href="https://wiki.bash-hackers.org/syntax/expansion/brace">Brace Expansion</a></li>
</ul>
<p>For example, let's look at basic <strong>brace expansion</strong>, which can be used to generate arbitrary strings:</p>
<pre><code>echo {1..5}
echo {5..1}
echo {a..l}
echo {l..a}
</code></pre>
<p>Another example: generating two sub-directories. Start off in your home directory, and:</p>
<pre><code>mkdir -p documents/{drafts,notes}
</code></pre>
<p>But more than that, they allow us to deal with arrays (or lists):</p>
<pre><code>seasons=(winter spring summer fall)
echo &quot;${seasons[1]}&quot;
echo &quot;${seasons[2]}&quot;
echo &quot;${seasons[-1]}&quot;
</code></pre>
<p>See <a href="https://devhints.io/bash#parameter-expansion">Parameter expansions</a> for more advanced techniques.</p>
<h2 id="conditional-expression"><a class="header" href="#conditional-expression">Conditional Expression</a></h2>
<p>We can include a list of commands on one line in Bash with a semicolon:</p>
<pre><code>cd ; ls -lt
</code></pre>
<p>But we can use <a href="https://ss64.com/bash/syntax-execute.html">conditional expressions</a> and apply logic with <code>&amp;&amp;</code> (<strong>Logical AND</strong>) or <code>||</code> (<strong>Logical OR</strong>).</p>
<p>Here, <code>command2</code> is executed if and only if <code>command1</code> is successful:</p>
<pre><code>command1 &amp;&amp; command2
</code></pre>
<p>Here, <code>command2</code> is executed if and only if <code>command1</code> fails:</p>
<pre><code>command1 || command2
</code></pre>
<p>Example:</p>
<pre><code>cd documents &amp;&amp; echo &quot;success&quot;
cd documents || echo &quot;failed&quot;
# combine them:
cd test &amp;&amp; pwd || echo &quot;no such directory&quot;
mkdir test
cd test &amp;&amp; pwd || echo &quot;no such directory&quot;
</code></pre>
<h2 id="shebang-or-hashbang"><a class="header" href="#shebang-or-hashbang">Shebang or Hashbang</a></h2>
<p>When we start to write scripts, the first thing we add is a [shebang][shebang] at line one. We can do so a couple of ways:</p>
<pre><code>##!/usr/bin/env bash
</code></pre>
<p>The first one should be more portable, but alternatively, you could put the direct path to Bash:</p>
<pre><code>#!/usr/bin/bash
</code></pre>
<h2 id="looping"><a class="header" href="#looping">Looping</a></h2>
<p>There are several looping methods Bash, including: <code>for</code>, <code>while</code>, <code>until</code>, and <code>select</code>. The <code>for</code> loop is often very useful. </p>
<pre><code>for i in {1..5} ; do
  echo &quot;$i&quot;
done
</code></pre>
<p>With that, we can create a rudimentary timer:</p>
<pre><code>for i in {1..5} ; do
  echo &quot;$i&quot; ; sleep 1
done
</code></pre>
<p>We can loop through our <strong>seasons</strong> variable:</p>
<pre><code>for i in ${seasons[@]} ; do
  echo &quot;$i&quot;
done
</code></pre>
<h2 id="testing"><a class="header" href="#testing">Testing</a></h2>
<p>Sometimes we will want to test certain conditions. There are two parts to this, we can use <code>if; then ; else</code> commands, and we can also use the double square brackets: <code>[[</code>. There are a few ways to get documentation on these functions. See the following:</p>
<pre><code>man test
help test
help [
help [[
help if
</code></pre>
<p>We can test integers:</p>
<pre><code>if [[ 5 -ge 3 ]] ; then
  echo &quot;true&quot;
else
  echo &quot;false&quot;
fi
</code></pre>
<p>Reverse it to return the else statement:</p>
<pre><code>if [[ 3 -ge 5 ]] ; then
  echo &quot;true&quot;
else
  echo &quot;false&quot;
fi
</code></pre>
<p>We can test strings:</p>
<pre><code>if [[ &quot;$HOME&quot; = &quot;$PWD&quot; ]] ; then
 echo &quot;you are home&quot;
else
 echo &quot;you are not home, but I will take you there&quot;
 cd $HOME
 pwd
fi
</code></pre>
<p>We can test files. Let's first create a file called <strong>paper.txt</strong> and a file called <strong>paper.bak</strong>. We will add some trivial content to <strong>paper.txt</strong> but not to the second file. The following <code>if</code> statement will test if <strong>paper.txt</strong> has a more recent modification date, and if so, it'll back up the file with the <code>cp</code> and echo back its success:</p>
<pre><code>if [[ &quot;$HOME/paper.txt&quot; -nt &quot;$HOME/paper.bak&quot; ]] ; then
  cp &quot;$HOME/paper.txt&quot; &quot;$HOME/paper.bak&quot; &amp;&amp; echo &quot;Paper is backed up.&quot;
fi
</code></pre>
<p>Here's a script that does prints info depending on which day of the week it is:</p>
<pre><code>day1=&quot;Tue&quot;
day2=&quot;Thu&quot;
day3=&quot;$(date +%a)&quot;

if [[ &quot;$day3&quot; = &quot;$day1&quot; ]] ; then
  printf &quot;\nIf %s is %s, then class is at 9:30am.\n&quot; &quot;$day3&quot; &quot;$day1&quot;
elif [[ &quot;$day3&quot; = &quot;$day2&quot; ]] ; then
  printf &quot;\nIf %s is %s, then class is at 9:30am.\n&quot; &quot;$day3&quot; &quot;$day2&quot;
else
  printf &quot;\nThere is no class today.&quot;
fi
</code></pre>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>In this demo, we learned about:</p>
<ul>
<li>creating and referring to variables</li>
<li>conditional expressions with <code>&amp;&amp;</code> and <code>||</code></li>
<li>adding the <strong>shebang</strong> or <strong>hashbang</strong> at the beginning of a script</li>
<li>looping with the <code>for</code> statement</li>
<li>testing with the <code>if</code> statement</li>
</ul>
<p>These are the basics. I'll cover more practical examples in upcoming demos, but note that mastering the basics requires understanding a lot of the commands that we have covered so far in class. So keep practicing.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="grep-and-regular-expressions"><a class="header" href="#grep-and-regular-expressions">Grep and Regular Expressions</a></h1>
<p>Oftentimes, as systems administrators, we will need to search the contents of a file, like a log. One of the commands that we use to do that is the <code>grep</code> command. We have already discussed using the <code>grep</code> command, which is not unlike doing any kind of search, such as in Google. The command simply involves running <code>grep</code> along with the search string and against a file. So if I wanted to search a file called <strong>cities.txt</strong> for the search string <strong>Lexington</strong>, then I can do this:</p>
<pre><code>grep &quot;lexington&quot; cities.txt
</code></pre>
<h2 id="whole-words-case-sensitive-by-default"><a class="header" href="#whole-words-case-sensitive-by-default">Whole words, case sensitive by default</a></h2>
<p>However, <code>grep</code> can employ stricter and more powerful syntax than a Google search. Since the contents of <strong>cities.txt</strong> are all in lowercase, if I run the above command with the city named capitalized, then <code>grep</code> will return nothing:</p>
<pre><code>grep &quot;Lexington&quot; cities.txt
</code></pre>
<p>In order to tell grep to ignore case, I need to use the <code>-i</code> option. This is a reminder for you to run <code>man grep</code> and to read through the documentation and see what the various options exit for this command.</p>
<pre><code>grep -i &quot;Lexington&quot; cities.txt
</code></pre>
<h2 id="multiword-strings"><a class="header" href="#multiword-strings">Multiword strings</a></h2>
<p>If we would search for multiword strings, then we enclose them in quotes:</p>
<pre><code>grep &quot;lexington, ky&quot; cities.txt
</code></pre>
<h2 id="character-classes-and-bracket-expressions"><a class="header" href="#character-classes-and-bracket-expressions">Character Classes and Bracket Expressions</a></h2>
<p>In conjunction with the <code>grep</code> command, we can also use regular expressions to search the content of text files. For example, we can use what are called <strong>character classes</strong> and <strong>bracket expressions</strong> to search for patterns in the text. Here again <code>man grep</code> is very important.</p>
<p>Note that the regular expression that marks the beginning of a line is the carat key <code>^</code>, but the carat key serves a different function in bracket expressions. Specifically, it functions like a Logical NOT. Here are examples of bracket expressions and character class searches:</p>
<pre><code># bracket expressions
grep [a-d] cities.txt # matches any characters in the range a,b,c,d
grep [^a-d] cities.txt # matches any characters not in the range a,b,c,d
grep [1-3] cities.txt # matches any numbers in the range 1,2,3
grep [^1-3] cities.txt # matches any numbers not in the range 1,2,3

# character classes
grep [[:alpha:]] cities.txt
grep [^[:alpha:]] cities.txt
grep [[:lower:]] cities.txt
grep [^[:lower:]] cities.txt
grep [[:upper:]] cities.txt
grep [^[:upper:]] cities.txt
grep [[:digit:]] cities.txt
grep [^[:digit:]] cities.txt
</code></pre>
<h2 id="anchoring"><a class="header" href="#anchoring">Anchoring</a></h2>
<p>Outside of bracket expansions and character classes, we use the caret <code>^</code> to mark the beginning of a line. We can also use the <code>$</code> to match the end of a line:</p>
<pre><code>grep &quot;^l&quot; cities.txt # all lines beginning with a &quot;l&quot;
grep &quot;9$&quot; cities.txt # all lines ending with the number &quot;9&quot;
</code></pre>
<h2 id="repetition"><a class="header" href="#repetition">Repetition</a></h2>
<p>If we want to use regular expressions to identify repetitive patterns, then we can use repetition operators. The most useful one is the <code>*</code> asterisk, but there are other options:</p>
<pre><code>grep &quot;l*&quot; cities.txt # the preceding item &quot;l&quot; matched zero or more times

# In come cases, we need to add the -E option to extend grep's basic functionality:
grep -E &quot;l?&quot; cities.txt    # the preceding item &quot;l&quot; is matched at most once
grep -E &quot;l+&quot; cities.txt    # the preceding item &quot;l&quot; is matched one or more times
grep -E &quot;l{2}&quot; cities.txt  # the preceding item &quot;l&quot; is matched exactly 2 times
grep -E &quot;l{2,}&quot; cities.txt # the preceding item &quot;l&quot; is matched 2 or more times
</code></pre>
<h2 id="or-searches"><a class="header" href="#or-searches">OR searches</a></h2>
<p>Here we search for either <strong>lexington</strong> or <strong>lansing</strong>. Since they both appear in the file, both lines that contain them are returned:</p>
<pre><code>grep &quot;lexington\|lansing&quot; cities.txt
</code></pre>
<p>This works like a Boolean OR statement, which means it'll return one or the other or both if one is True, the alternate is True, or both are True. If we repeat this line with a city name that is not in the file, but with one that is, then it'll return the city name that is in the file since at least that is True:</p>
<pre><code>grep &quot;lexington\|london&quot; cities.txt
</code></pre>
<h2 id="real-world-example"><a class="header" href="#real-world-example">Real World Example</a></h2>
<p>The log file at <code>/var/log/auth.log</code> records all attempts to authenticate and login to the server, including &quot;invalid&quot; attempts. Invalid attempts will include actual invalid, malicious attempts but may also capture real user mistakes when logging into the server via <code>ssh</code>. We're interested in the malicious attempts, made by automated bots, on the system. Let's use <code>less</code> to take a quick look at that file:</p>
<pre><code>less /var/log/auth.log
Sep 12 00:00:08 sised-summer2020 sshd[78312]: Invalid user uu from 152.231.25.170 port 61921
Sep 12 00:00:08 sised-summer2020 sshd[78312]: pam_unix(sshd:auth): check pass; user unknown
Sep 12 00:00:08 sised-summer2020 sshd[78312]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=152.231.25.170 
Sep 12 00:00:10 sised-summer2020 sshd[78312]: Failed password for invalid user uu from 152.231.25.170 port 61921 ssh2
Sep 12 00:00:11 sised-summer2020 sshd[78312]: Received disconnect from 152.231.25.170 port 61921:11: Bye Bye [preauth]
Sep 12 00:00:11 sised-summer2020 sshd[78312]: Disconnected from invalid user uu 152.231.25.170 port 61921 [preauth]
Sep 12 00:00:40 sised-summer2020 sshd[78314]: User root from 107.170.153.57 not allowed because none of user's groups are listed in AllowGroups
Sep 12 00:00:40 sised-summer2020 sshd[78314]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=107.170.153.57  user=root
Sep 12 00:00:42 sised-summer2020 sshd[78314]: Failed password for invalid user root from 107.170.153.57 port 60118 ssh2
Sep 12 00:00:44 sised-summer2020 sshd[78314]: Received disconnect from 107.170.153.57 port 60118:11: Bye Bye [preauth]
</code></pre>
<p>If we continue to peruse that log file, we can also see valid, successful authentications. They follow the pattern below.</p>
<pre><code>Sep 12 02:20:05 sised-summer2020 sshd[79540]: Accepted password for user1 from 192.128.0.1 port 56000 ssh2
Sep 12 15:08:10 sised-summer2020 sshd[87434]: Accepted password for user2 from 192.128.0.2 port 43501 ssh2
Sep 12 17:02:55 sised-summer2020 sshd[89235]: Accepted password for user3 from 192.128.0.3 port 57996 ssh2
Sep 12 17:03:36 sised-summer2020 sshd[89341]: Accepted password for user4 from 192.128.0.4 port 56188 ssh2
</code></pre>
<p>Note: I've obfuscated the usernames and IP addresses in the above snippet. Where it our reports <strong>user1, user2, ...</strong>, it would report our usernames, and the IP addresses are made up:</p>
<p>As we examine the file, we should look for patterns in the text. For example, we see the following kind of line over and over again:</p>
<pre><code>Sep 12 00:00:08 sised-summer2020 sshd[78312]: Invalid user uu from 152.231.25.170 port 61921
</code></pre>
<p>The user listed here is <code>uu</code>. That's a made up user. So let's grep for one of the fixed parts of that string, which is <code>Invalid user</code>. We can pipe the output through the <code>head</code> command to look the first ten results:</p>
<pre><code>grep &quot;Invalid user&quot; /var/log/auth.log | head
Sep 12 00:00:08 sised-summer2020 sshd[78312]: Invalid user uu from 152.231.25.170 port 61921
Sep 12 00:00:52 sised-summer2020 sshd[78316]: Invalid user reshma from 42.200.109.74 port 33028
Sep 12 00:02:16 sised-summer2020 sshd[78320]: Invalid user julie from 95.85.43.241 port 50010
Sep 12 00:02:39 sised-summer2020 sshd[78322]: Invalid user sasha from 113.161.37.216 port 46615
Sep 12 00:02:49 sised-summer2020 sshd[78324]: Invalid user a from 177.83.39.253 port 39699
Sep 12 00:05:39 sised-summer2020 sshd[78330]: Invalid user scan from 152.231.25.170 port 64587
Sep 12 00:06:45 sised-summer2020 sshd[78334]: Invalid user postgres from 95.85.43.241 port 37766
Sep 12 00:08:48 sised-summer2020 sshd[78341]: Invalid user apidoc from 113.161.37.216 port 32963
Sep 12 00:09:10 sised-summer2020 sshd[78407]: Invalid user sentry from 124.89.83.117 port 42690
Sep 12 00:09:15 sised-summer2020 sshd[78414]: Invalid user apidoc from 177.83.39.253 port 10693
</code></pre>
<p>Let's apply a brace expression and a asterisk to extract the list of invalid users from that output. I want everything from this log file, but I'll pipe the output through the <code>head</code> command to examine the validity of the results:</p>
<pre><code># note: we may also not grep for the string &quot;from&quot;
grep -o &quot;Invalid user [a-zA-Z]* from&quot; auth.log | head
Invalid user uu from
Invalid user reshma from
Invalid user julie from
Invalid user sasha from
Invalid user a from
Invalid user scan from
Invalid user postgres from
Invalid user apidoc from
Invalid user sentry from
Invalid user apidoc from
</code></pre>
<p>This is good progress, but I really just want the list of usernames. Let's modify that to remove the text &quot;Invalid user &quot; and &quot;from &quot;. We can use the <code>cut</code> or the <code>awk</code> command. I'll show both and just a bit of the output. The output is same with both commands:</p>
<pre><code># Using cut
grep -o &quot;Invalid user [a-zA-Z]* from&quot; auth.log | cut -d' ' -f3

# Using awk
grep -o &quot;Invalid user [a-zA-Z]* from&quot; auth.log | awk '{ print $3 }'
uu
reshma
julie
sasha
a
scan
postgres
apidoc
sentry
apidoc
</code></pre>
<p>Goal accomplished, but we can do better. Right now we have an un-ordered list of users. Let's sort them, get a count and list of usernames that are the most commonly used, and then sort those by their counts. We'll continue to use the <code>|</code> pipe operator, along with an assortment of utilities, to create a powerful command:</p>
<pre><code>grep -o &quot;Invalid user [a-zA-Z]* from&quot; auth.log | awk '{ print $3 }' | sort | uniq -c | sort
</code></pre>
<p>Once we have that, we may want to save the data to a file:</p>
<pre><code>grep -o &quot;Invalid user [a-zA-Z]* from&quot; auth.log | awk '{ print $3 }' | sort | uniq -c | sort &gt; invalid-user-attempts.txt
</code></pre>
<p>Or, we may want to save our command as a script in order to automate the process. In the following code snippet, I use the <strong>backslash</strong> to split our single command over multiple lines. This makes the command more readable. I also save the output to a file with the current date as part of the file name. This makes the file name unique, which is good since I only use a single <code>&gt;</code> redirect.</p>
<pre><code>#!/usr/bin/env bash

# Get sorted list of invalid attempts to ssh into server
grep -o &quot;Invalid user [a-zA-Z]* from&quot; auth.log |\
  awk '{ print $3 }' |\
  sort |\
  uniq -c |\
  sort &gt; invalid-user-attempts-&quot;$(date +%Y-%m-%d)&quot;.txt
</code></pre>
<p>And from there we can investigate whether any of these users truly exist on the system and conduct other security checks.</p>
<h2 id="addendum"><a class="header" href="#addendum">Addendum</a></h2>
<p>The goal in this lesson is to learn a bit about regular expressions, but there are a number of ways to get a list of users from the <strong>auth.log</strong> file and also avoid using complicated regular expressions. We can <code>grep</code> for a multistring and take more advantage of <code>awk</code>. For example:</p>
<pre><code>grep &quot;Invalid user &quot; auth.log | awk '{ print $8 }' | sort | uniq -c | sort
</code></pre>
<p>We can also not <code>grep</code> at all, and use only <code>awk</code>, because <code>awk</code> can search. To search in <code>awk</code>, we insert the search string within forward slashes, i.e., <code>/search string/</code>:</p>
<pre><code>awk '/Invalid user / { print $8 }' auth.log | sort | uniq -c | sort
</code></pre>
<p>In both examples above, we depend on the default behavior of <code>awk</code> to treat spaces as a field separator. Hence, in order for me to know that the users are listed in field 8 (<code>$8</code>), I had to count the columns.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="managing-services-and-software"><a class="header" href="#managing-services-and-software">Managing Services and Software</a></h1>
<p>This section covers installing Linux, using Linux with VirtualBox, systemd, creating backups, and using DNF.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installing-and-configuring-fedora-34-linux-server"><a class="header" href="#installing-and-configuring-fedora-34-linux-server">Installing and Configuring Fedora 34 Linux Server</a></h1>
<h2 id="download-and-install-virtualbox--download-fedora"><a class="header" href="#download-and-install-virtualbox--download-fedora">Download and Install VirtualBox &amp;&amp; download fedora</a></h2>
<ol>
<li>Download fedora Server Edition. We'll install the x86_64 netinstall ISO image because it's a smaller download, and then we can install other items once Fedora is running.
<ul>
<li><a href="https://getfedora.org/">https://getfedora.org/</a></li>
<li><a href="https://getfedora.org/en/server/download/">https://getfedora.org/en/server/download/</a></li>
</ul>
</li>
<li>Download VirtualBox. This will vary depending on whether you run macOS or Windows. If you have issues here, please seek tutorials elsewhere, like YouTube.
<ul>
<li>Download VirtualBox: <a href="https://www.virtualbox.org/">https://www.virtualbox.org/</a></li>
</ul>
</li>
<li>Install VirtualBox however you install software for your operating system. 
<ul>
<li>Instructions for <a href="https://www.youtube.com/watch?v=1ASMgibukWI">macOS Big Sur</a>. <strong>Note: instructions from this video are only valid until the 4:20 time. Do not use these instructions after that point of the video.</strong></li>
<li>Instructions for <a href="https://www.youtube.com/watch?v=8mns5yqMfZk">Windows 10</a>. <strong>Note: instructions from this video are only valid until the 2:30 second mark. Do not use these instructions after that point.</strong></li>
</ul>
</li>
<li>Be aware of the <a href="https://www.virtualbox.org/manual/">VirtualBox user manual</a>. I'm not asking you to read it, but if you have any issues, you should search this documentation.</li>
</ol>
<h2 id="host-machine-set-up"><a class="header" href="#host-machine-set-up">Host machine set up</a></h2>
<ol>
<li>Create a directory on your own Windows or macOS computer, and call it <strong>iso</strong>. It's fine to create this directory in your home directory, or in your documents directory, or wherever.</li>
<li>Move the fedora ISO file that you downloaded to your new <strong>iso</strong> directory.</li>
<li>In your <strong>iso</strong> directory, create a new directory called <strong>virtualbox</strong>.</li>
</ol>
<h2 id="set-up-fedora-in-virtualbox"><a class="header" href="#set-up-fedora-in-virtualbox">Set up fedora in VirtualBox</a></h2>
<ol>
<li>Click on the <strong>New</strong> button</li>
<li>In the <strong>Name:</strong> field, type in <strong>Fedora-Base-34</strong>. As you type this in, VirtualBox should automatically recognize the <strong>Type:</strong> and <strong>Version</strong>. Click <strong>Next &gt;</strong>.</li>
<li><strong>Memory size</strong>: Depending on your laptop's memory capabilities, you can set this higher, but it's not necessary. The default <strong>1024 MB</strong> should be fine.</li>
<li><strong>Hard disk</strong>: The default is 8.00 GB. We will change this to 100 GB on an upcoming screen. For now, make sure you select the default <strong>Create a virtual hard disk now</strong>, and then click on <strong>Create</strong>.</li>
<li><strong>Hard disk file type</strong>: Accept the default, which is <strong>VDI</strong>.</li>
<li><strong>Storage on physical hard disk</strong>: Accept the default, which is <strong>Dynamically allocated</strong></li>
<li><strong>File location and size</strong>: Here you adjust to the disk size to 100 GB. Note that you will not use all of this space on your hard drive. It's the maximum amount that you can use. Click on <strong>Create</strong>.</li>
</ol>
<p>The settings box should close. Now highlight the virtual machine in the left pane of the VirtualBox menu, and click on Start.</p>
<h2 id="install-fedora-in-virtualbox"><a class="header" href="#install-fedora-in-virtualbox">Install fedora in VirtualBox</a></h2>
<ol>
<li>
<p>When you start, a window will pop up and ask you to select a virtual optical disk. This is the fedora 34 ISO that you downloaded and that you saved to your new <strong>iso</strong> folder. We have to select the file icon in the window and then find and select the ISO that we downloaded. Once you do that, click on <strong>Start</strong>.</p>
</li>
<li>
<p>A terminal will open up. Press <strong>Enter</strong> on the Installing Fedora 34 option. Some setup text will scroll by and soon a graphical installer will launch.</p>
</li>
<li>
<p>In the graphical installer, you'll get a message: &quot;WELCOME TO FEDORA 34.&quot; US English should be the default options in both panes. Click on <strong>Continue</strong>.</p>
</li>
<li>
<p>We only have to configure a few things. Click on <strong>Software Selection</strong>. In
the right pane, under <strong>Additional software for Selected Environment</strong>, select <strong>Headless Management</strong> and then click on <strong>Done</strong>.</p>
</li>
<li>
<p>Now we have to partition our hard drive. We could accept automatic partitioning, but we want to fine tune this. So click on <strong>Installation Destination</strong>.</p>
</li>
<li>
<p>At the bottom of the window it says <strong>Storage Configuration</strong>. Select <strong>Custom</strong> and then <strong>Done</strong>.</p>
</li>
<li>
<p><strong>Manual Partitioning</strong>: In the next screen, the <strong>LVM</strong> option should already be selected. This stands for <strong>Logical Volume Management</strong>. Make sure that stays selected.</p>
</li>
<li>
<p>Now we create some partitions. Partitioning a drive is a way to slice up a drive into parts so that we better manage the use of the drive. As we create these partitions, note the two pieces of information at the bottom of the screen: the <em>Available Space</em> and the <em>Total Space</em>. The Available Space will change as we add partitions.</p>
</li>
<li>
<p>Click on the <strong>+</strong> icon. In the <strong>Mount Point</strong> box, we'll first create the  <strong>root partition</strong>, which is indicated with the forward slash: <strong>/</strong>. For <strong>Desired Capacity</strong>, we should input <strong>20 GB</strong>. In the next screen, change the <strong>File System</strong> to <strong>ext4</strong>.</p>
</li>
<li>
<p>Next we create our other partitions. These include <strong>/boot</strong>, <strong>/home</strong>, <strong>/var</strong>, <strong>/tmp</strong> partitions and the <strong>swap</strong> file (note the missing slash). Click on the plus sign and repeat the process for these partitions. We'll leave about 34 GB of free disk space available for later use. Altogether, our partition map should look like this, but <strong>fedora</strong> will adjust the sizes a bit:</p>
<p>| Mount Point/Partition | Size  | File System |
|-----------------------|-------|-------------|
| /home                 | 30 GB | ext4        |
| /                     | 20 GB | ext4        |
| /tmp                  | 6 GB  | ext4        |
| /var                  | 10 GB | ext4        |
| /boot                 | 1 GB  | ext4        |
| swap                  | 4 GB  | swap        |</p>
<p>Note that the <strong>/boot</strong> partition is mapped to <strong>sda1</strong>. This is handy to remember.</p>
<p>Note also that the Available Space listed at the bottom should be about 33.86 GiB.</p>
<p>After you've inputted the above info, click on <strong>Done</strong>. Then click on <strong>Accept Changes</strong> in the next window.</p>
</li>
<li>
<p>Set up Root Password. Save this password!</p>
</li>
<li>
<p>Click on <strong>Begin Installation</strong>. This might take up to 15 minutes depending on the strength of your internet connection and what kind of hardware you have. </p>
</li>
<li>
<p>Wait until installation is complete and you are able to Reboot System. HOWEVER, do not reboot yet. Instead, choose <strong>Close</strong> from the <strong>File</strong> menu, and then click <strong>Power off the machine.</strong> </p>
</li>
<li>
<p>In VirtualBox settings, click on the settings for this machine.</p>
</li>
<li>
<p>In the window that pops up, click on the <strong>System</strong> tab (this may look different if you're on macOS, especially).</p>
</li>
<li>
<p>Deselect the Floppy and Optical options next to <strong>Boot Order</strong>, and then click <strong>Okay</strong>.</p>
</li>
<li>
<p>Click on <strong>Start</strong> to boot your system back.</p>
</li>
</ol>
<h2 id="boot-fedora-update-system-and-create-regular-user"><a class="header" href="#boot-fedora-update-system-and-create-regular-user">Boot fedora; update system; and create regular user</a></h2>
<ol>
<li>
<p>Once your system is running, you will get a login prompt. Login as the user <code>root</code>.</p>
</li>
<li>
<p>Update your system right away with the following commands:</p>
<pre><code>dnf updateinfo
dnf upgrade
</code></pre>
<p>The first command will sync your local repository with the remove repositories that manage software updates. The second command will update the software on your system if updates are available.</p>
</li>
<li>
<p>We do not normally want to work in the <code>root</code> account. So next we need to a regular user. To create a new user, do the next command. Instead of <strong>sean</strong>, create a username that you like. Make sure it is one word and that it is all lowercase:</p>
<pre><code>useradd -m -U -s /usr/bin/bash -G wheel sean
</code></pre>
<p>The above command will create a new user named <em>sean</em> and put that user in group of the same name, create a home directory for that user, make <code>bash</code> the default shell for that user, and assign that user to the <strong>wheel</strong> group, which will make that user an administrator of the system. Read <code>man useradd</code> for more details.</p>
</li>
<li>
<p>Next create a password for your new user:</p>
<pre><code>passwd sean
</code></pre>
<p>Once you have completed these steps, you can power off the machine:</p>
<pre><code>poweroff
</code></pre>
</li>
</ol>
<h2 id="clone-the-machine"><a class="header" href="#clone-the-machine">Clone the machine</a></h2>
<p>In the VirtualBox Manager, right click on our installation, and then select <strong>Clone</strong>. Accept the default name or rename it as you prefer. Be sure to choose <strong>Full clone</strong>.</p>
<p>That's good for now. Congratulations! You have just completed your first installation of a Linux server.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="logical-volume-management"><a class="header" href="#logical-volume-management">Logical Volume Management</a></h1>
<h2 id="background-reading-and-documentation"><a class="header" href="#background-reading-and-documentation">Background Reading and Documentation</a></h2>
<p>Please read the following two articles before proceeding:</p>
<ul>
<li><a href="https://www.digitalocean.com/community/tutorials/an-introduction-to-lvm-concepts-terminology-and-operations">An Introduction to LVM Concepts, Terminology, and Operations</a></li>
<li><a href="https://opensource.com/business/16/9/linux-users-guide-lvm">A Linux User's Guide to Logical Volume Management</a></li>
</ul>
<p>Additionally, you should review / skim some helpful <code>man</code> or <code>info</code> pages before proceeding:</p>
<ul>
<li><code>man filesytems</code></li>
<li><code>man ext4</code></li>
<li><code>man btrfs</code></li>
<li><code>man vgdisplay</code></li>
<li><code>man pvdisplay</code></li>
<li><code>man lvdisplay</code></li>
<li><code>man pvcreate</code></li>
<li><code>man lvcreate</code></li>
<li><code>man vgextend</code></li>
<li><code>man fdisk</code></li>
<li><code>man lsblk</code></li>
<li><code>man fstab</code></li>
<li><code>man parted</code></li>
<li><code>man mount</code></li>
<li><code>man cfdisk</code></li>
</ul>
<p>The second link above demonstrates some other logical volume commands that we are not using here. Give the <code>man</code> or <code>info</code> pages for those a read, too.</p>
<h2 id="our-motivation"><a class="header" href="#our-motivation">Our motivation</a></h2>
<p>When we installed Fedora in VirtualBox, we told VirtualBox that our hard drive would be a 100 GB in size. However, when we partitioned our hard drive, we only partitioned around 67 GB of that space. In this lesson, we are going to create a new partition of the <strong>sda</strong> partition, and then expand our logical volume to include this partition. We'll allocate 15 GB of the remaining space to <strong>sda3</strong>.</p>
<p>Briefly:</p>
<ul>
<li>Physical volumes (the <em>pv</em> commands) are related to the physical devices.</li>
<li>Volume groups (the <em>vg</em> commands) organize the physical and logical volumes.</li>
<li>Logical volumes (the <em>lv</em> commands) are about partitions.</li>
</ul>
<h2 id="procedure"><a class="header" href="#procedure">Procedure</a></h2>
<h3 id="administrative-commands"><a class="header" href="#administrative-commands">Administrative commands</a></h3>
<p>We need to use the <code>sudo</code> command to run many of the commands below or login as <strong>root</strong> user. Either way, be careful about running commands with <code>sudo</code> or as root. Mistyping a command may harm your system beyond repair. If you do harm your system beyond repair, delete your clone in VirtualBox and reclone the original install. In the demonstration that follows, I will login as the <strong>root</strong> user.</p>
<p>If you would like to login as root, you can login as root at the intitial prompt after you system boots up; or, if you are already logged in as a regular user, you can type the <code>su root</code> command and then enter the root password that you set when you installed Fedora, or you can use the <code>sudo su</code> command if you are in the wheel group:</p>
<pre><code>su root
</code></pre>
<p>Or:</p>
<pre><code>sudo su
</code></pre>
<h3 id="gather-information"><a class="header" href="#gather-information">Gather information</a></h3>
<p>First we need take a look at what we have before we start. Pay some attention to the details:</p>
<pre><code>lsblk
fdisk -l | less
</code></pre>
<h3 id="create-a-partition"><a class="header" href="#create-a-partition">Create a Partition</a></h3>
<p>We can use a program called <code>parted</code> or a slightly more user friendly program called <code>cfdisk</code>. We'll use <code>cfdisk</code>:</p>
<pre><code>cfdisk
</code></pre>
<p>In <code>cfdisk</code>, complete the following steps:</p>
<ul>
<li>Arrow down to the <strong>Free space</strong> section, and press Enter on <strong>New</strong>.</li>
<li>Next to Partition size, backspace over value and then type <strong>15GB</strong></li>
<li>Set to <strong>primary</strong></li>
<li>Use right arrow key to select <strong>Type</strong></li>
<li>Arrow down to the <strong>8e Linux LVM</strong> selection and press enter</li>
<li>User right arrow key to select <strong>Write</strong>, and then type <strong>yes</strong> at the prompt to write the partition to the virtual disk</li>
</ul>
<h3 id="creating-a-physical-volume"><a class="header" href="#creating-a-physical-volume">Creating a Physical Volume</a></h3>
<p>Next let's create a new physical volume to refer to our new partition. It's important to read the man pages for <em>pvdisplay</em> and <em>pvcreate</em> before you start so that you get a better idea of what you're doing, above and beyond what I'm detailing here or the links above describe. Here we'll use <code>pvdisplay</code> before and after we use <code>pvcreate</code> to note the differenc after we use the latter command:</p>
<pre><code>pvdisplay
pvcreate /dev/sda3
pvdisplay
</code></pre>
<h3 id="add-a-physical-volume-to-a-volume-group"><a class="header" href="#add-a-physical-volume-to-a-volume-group">Add a Physical Volume to a Volume Group</a></h3>
<p>Now we add our new physical volume to an existing volume group, which was created when we installed Fedora. Usage note: <code>vgextend VG PV</code>. (See man page, of course :)</p>
<p>Below, the volume group name is <strong>fedora_fedora</strong> and the physical volume name is, per the last set of commands, <strong>/dev/sda3</strong>. By extending the volume group, we'll have extended its size to encompass the new partition:</p>
<pre><code>vgdisplay
vgextend fedora_fedora /dev/sda3
vgdisplay
</code></pre>
<h3 id="creating-a-logical-volume"><a class="header" href="#creating-a-logical-volume">Creating a Logical Volume</a></h3>
<p>We create a logical volume to allow us to mount the partition and make it accessible to the other parts of the file system. Note: man pages!!!</p>
<pre><code>lvdisplay | less
lsblk
vgdisplay # note Free PE / Size space
lvcreate -L +15GiB --name projects fedora_fedora
lvdisplay
</code></pre>
<h3 id="creating-a-file-system-for-the-lv"><a class="header" href="#creating-a-file-system-for-the-lv">Creating a File System for the LV</a></h3>
<p>Now we need to <strong>format the logical volume</strong>: read the man pages for the commands below, including <code>man fstab</code>.</p>
<pre><code>mkfs.ext4 /dev/fedora_fedora/projects
mkdir /projects
mount /dev/fedora_fedora/projects /projects
</code></pre>
<p>In <code>nano</code>, enter this in the <strong>/etc/fstab</strong> file:</p>
<pre><code>/dev/mapper/fedora_fedora-projects  /projects ext4   defaults    1 2
</code></pre>
<p>Per the instructions in that file, run the following command:</p>
<pre><code>systemctl daemon-reload
</code></pre>
<p>Now reboot the machine. When you reboot, your new partition should be recognized and mounted automatically.</p>
<pre><code>reboot now
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nat-network-address-translation"><a class="header" href="#nat-network-address-translation">NAT (Network Address Translation)</a></h1>
<h2 id="set-up-nat"><a class="header" href="#set-up-nat">Set up NAT</a></h2>
<p>We will want to SSH into our machines without having to use the VirtualBox GUI, and later connect to these virtual machines using other protocols. We can do so by setting up NAT in VirtualBox.</p>
<p>To set up NAT:</p>
<p>In VirtualBox, go to Settings, Network, Advanced, Port Forwarding, and enter the info in the table below. Be sure to replace the <strong>Host IP</strong> address with the IP address of your laptop or desktop. You can find your <strong>Host IP</strong> in your system settings on your Windows or Mac computers, or by opening up a terminal session and typing <code>ifconfig</code> or the equivalent for your operating system.</p>
<table><thead><tr><th style="text-align: left">Name</th><th style="text-align: center">Protocol</th><th style="text-align: center">Host IP</th><th style="text-align: center">Host Port</th><th style="text-align: center">Guest IP</th><th style="text-align: right">Guest Port</th></tr></thead><tbody>
<tr><td style="text-align: left">SSH</td><td style="text-align: center">TCP</td><td style="text-align: center">10.163.36.88</td><td style="text-align: center">2222</td><td style="text-align: center">10.0.2.15</td><td style="text-align: right">22</td></tr>
</tbody></table>
<p>Once you have that IP, and have made the above changes, start your Fedora clone in headless mode.</p>
<p>Now you can SSH into your virtual machine using the terminal of your choice (e.g., the one you used to connect to the remote server).</p>
<p>From a command line, we are going to SSH through port 2222 via our Host IP address. For me, that looks like this:</p>
<pre><code>ssh -p 2222 user@10.163.36.88
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-console-and-nat"><a class="header" href="#web-console-and-nat">Web Console and NAT</a></h1>
<p>We set NAT to allow SSH traffic between the Host computer (our computers) and the Guest computer (the virtual machines).</p>
<p>[ Insert video demo ]</p>
<p>In VirtualBox, go to Settings, Network, Advanced, Port Forwarding, and add the info in the table below. Be sure to replace the <strong>[ YOUR IP ]</strong> address with the IP address of your laptop or desktop.</p>
<table><thead><tr><th style="text-align: center">Name</th><th style="text-align: center">Protocol</th><th style="text-align: center">Host IP</th><th style="text-align: center">Host Port</th><th style="text-align: center">Guest IP</th><th style="text-align: right">Guest Port</th></tr></thead><tbody>
<tr><td style="text-align: center">Console</td><td style="text-align: center">TCP</td><td style="text-align: center">[ YOUR IP ]</td><td style="text-align: center">9091</td><td style="text-align: center">10.0.2.15</td><td style="text-align: right">9090</td></tr>
</tbody></table>
<p>Now you can access the console from your regular web browser by visiting the following URL:</p>
<pre><code>https://YOURIP:9091
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="managing-users"><a class="header" href="#managing-users">Managing Users</a></h1>
<h2 id="the-passwd-file"><a class="header" href="#the-passwd-file">The passwd file</a></h2>
<p>On my Fedora 34 virtual machine, I can see the following information about my user account in the <strong>passwd</strong> file:</p>
<pre><code>cat /etc/passwd
</code></pre>
<p>Or, I can also <code>grep</code> or <code>awk</code> for specific accounts:</p>
<pre><code>grep &quot;$(whoami)&quot; /etc/passwd
sean:x:1000:1000:sean::/home/sean:/usr/bin/bash

grep &quot;sean&quot; /etc/passwd
sean:x:1000:1000:sean::/home/sean:/usr/bin/bash

awk '/sean/ { print $0 }' /etc/passwd
sean:x:1000:1000:sean::/home/sean:/usr/bin/bash
</code></pre>
<p>Any of those commands can be piped through <code>sed</code> to look at the individual fields, one line at a time:</p>
<pre><code>grep &quot;sean&quot; /etc/passwd | sed 's/:/\n/g'
sean
x
1000
1000

/home/sean
/usr/bin/bash
</code></pre>
<p>The fields represent the following information:</p>
<ul>
<li>username</li>
<li>password indicator</li>
<li>user id</li>
<li>group id</li>
<li>user name or comment</li>
<li>home directory</li>
<li>default shell</li>
</ul>
<p>You can read about these fields via <code>man 5 passwd</code>. [ EXPLAIN THE 5 ]</p>
<p>Note that the <strong>user name or comment</strong> line is blank. We can add a comment using the <code>chfn</code>, and there are multiple options to use. If I use the <code>-f</code> option, I can set my full name to appear here. See <code>man chfn</code> for more options to set:</p>
<pre><code>sudo chfn -f &quot;Sean Burns&quot; sean
</code></pre>
<p>The <strong>/etc/passwd</strong> file is a pretty standard Linux file, but some things will change depending on the distribution. For example, the user id may start at a different point depending on the system. However, nowadays both Ubuntu and Fedora set the starting UID and group ID for new users at 1000.</p>
<h2 id="the-shadow-file"><a class="header" href="#the-shadow-file">The shadow file</a></h2>
<p>The <strong>/etc/passwd</strong> file does not contain any passwords but a simple <strong>x</strong> to mark the password field. Passwords on Linux are stored in <strong>/etc/shadow</strong> and are hashed with <strong>sha512</strong>, which is indicated by <strong>$6$</strong>. You need to be root to examine the shadow file or use <code>sudo</code>:</p>
<pre><code>sudo su
grep &quot;sean&quot; /etc/shadow
sean:ENCRYPTED_PASSWORD::0:99999:7:::
grep &quot;sean&quot; /etc/shadow | sed 's/:/\n/g'
sean
ENCRYPTED_PASSWORD

0
99999
7
</code></pre>
<p>The fields are (see <code>man 5 passwd</code>):</p>
<ul>
<li>login name (username)</li>
<li>encrypted password</li>
<li>days since 1/1/1970 since password was last changed</li>
<li>days after which password must be changed</li>
<li>minimum password age</li>
<li>maximum password age</li>
<li>password warning period</li>
<li>password inactivity period</li>
<li>account expiration date</li>
<li>a reserved field</li>
</ul>
<h2 id="the-group-file"><a class="header" href="#the-group-file">The group file</a></h2>
<p>The <strong>/etc/group</strong> file holds group information about the entire system (see <code>man group</code>). In the following command, you can see that I'm a member of the <strong>wheel</strong> group (which allows my account to use the <code>sudo</code> command) and that there's a group name that is also the name of my user account. The <strong>sean</strong> at the end of the <strong>wheel</strong> line indicates that I am a member of the <strong>wheel</strong> group. Although user <strong>sean</strong> is a member of group <strong>sean</strong>, users do not have to be listed as members of their own group.</p>
<pre><code>grep -E 'wheel|^sean' /etc/group
wheel:x:10:sean
sean:x:1000:
</code></pre>
<p>The fields are:</p>
<ul>
<li>group name</li>
<li>group password</li>
<li>group ID (GID)</li>
<li>group members (user list)</li>
</ul>
<h2 id="management-tools"><a class="header" href="#management-tools">Management Tools</a></h2>
<p>Other user and group utilities include:</p>
<ul>
<li><code>/usr/sbin/useradd</code></li>
<li><code>/usr/sbin/usermod</code></li>
<li><code>/usr/sbin/userdel</code></li>
<li><code>/usr/sbin/groupadd</code></li>
<li><code>/usr/sbin/groupdel</code></li>
<li><code>/usr/sbin/groupmod</code></li>
<li><code>/usr/sbin/gpasswd</code></li>
</ul>
<h2 id="practice"><a class="header" href="#practice">Practice</a></h2>
<h3 id="modify-default-new-user-setttings"><a class="header" href="#modify-default-new-user-setttings">Modify default new user setttings</a></h3>
<p>In today's demo, we will modify some default user account settings for new users, and then we'll create a new user account.</p>
<p>Before we proceed, let's review several important configuration files that establish some default settings:</p>
<ul>
<li><strong>/etc/login.defs</strong> : see <code>man login.defs</code></li>
<li><strong>/etc/skel</strong></li>
<li><strong>/etc/default/useradd</strong></li>
</ul>
<p>Let's change some defaults. We can either user <code>sudo</code> or become <code>su</code>. Here I use <code>sudo</code> to become root:</p>
<pre><code>sudo su
</code></pre>
<p>Let's edit the default <strong>.bashrc</strong> file:</p>
<pre><code>nano /etc/skel/.bashrc
</code></pre>
<p>We want to add these lines at the end of the file:</p>
<pre><code># Dear New User,
#
# I have made the following settings to make your life a bit easier:
#
# make &quot;c&quot; a shortcut for &quot;clear&quot;
alias c='clear'
#
# make vi the default command line keybinding
set -o vi
</code></pre>
<p>Now use <code>nano</code> again to create a README file. This file will be added to the home directories of all new users. Add any welcome message you want to add, plus any guidelines for using the system.</p>
<pre><code>nano /etc/skel/README
</code></pre>
<h3 id="add-new-user-account"><a class="header" href="#add-new-user-account">Add new user account</a></h3>
<p>After writing (saving) and exiting <code>nano</code>, we can go ahead and create a new user named <strong>linus</strong>. The <code>-m</code> option creats the user's home directory, the <code>-U</code> option creates a group with the same name as the user, and the <code>-s</code> option sets the default shell to <code>/usr/bin/bash</code>.</p>
<pre><code>useradd -m -U -s /usr/bin/bash linus
grep &quot;linus&quot; /etc/passwd
</code></pre>
<p>Let's add the user's full name:</p>
<pre><code>chfn -f &quot;Linus Torvalds&quot; linus
</code></pre>
<p>The user does not yet have a password set. Let's create a password for <em>linus</em>:</p>
<pre><code>grep &quot;linus&quot; /etc/shadow
passwd linus
grep &quot;linus&quot; /etc/shadow
</code></pre>
<p>Let's modify the minimum days and maximum days of the password's lifetime:</p>
<pre><code>passwd -n 90 linus
passwd -x 180 linus
</code></pre>
<h3 id="create-a-new-group-add-users-to-the-group"><a class="header" href="#create-a-new-group-add-users-to-the-group">Create a new group; add users to the group</a></h3>
<p>Let's now create a new group, and then I will add my account and my new user's account to the group:</p>
<pre><code>grep &quot;linus&quot; /etc/group
groupadd developers
grep &quot;developers&quot; /etc/group
gpasswd -a linus developers
gpasswd -a sean developers
grep &quot;developers&quot; /etc/group
</code></pre>
<p>Exit out of root if logged in as root.</p>
<p>Now login as user linus and examine the user's group memberships:</p>
<pre><code>su linus
groups
</code></pre>
<p>Great! Let's exit out and become root again:</p>
<pre><code>exit
sudo su
</code></pre>
<p>Let's make the <strong>/projects</strong> directory/logical volume a shared directory:</p>
<pre><code>ls -ld /projects
# change ownership of the directory to the group developers
chown :developers /projects
# allow all group users to add and delete from the folder and read/write to each other's files
# See this post for various options:
# https://ubuntuforums.org/showthread.php?t=2138476&amp;p=12616640#post12616640
chmod 2770 /projects
exit
</code></pre>
<p>Log all the way out and then login again:</p>
<pre><code>exit # from root
exit # from regular user
</code></pre>
<p>And then relogin so that the group modification will take affect. Check with the <code>groups</code> command:</p>
<pre><code>groups
</code></pre>
<h3 id="user-account-and-group-deletion"><a class="header" href="#user-account-and-group-deletion">User account and group deletion</a></h3>
<p>If we want to delete the new user's account:</p>
<pre><code>userdel -r linus
grep &quot;linus&quot; /etc/passwd
grep &quot;linus&quot; /etc/shadow
cd /home ; ls -l
</code></pre>
<p>And then delete the new group:</p>
<pre><code>grep &quot;developers&quot; /etc/group
groupdel developers
grep &quot;developers&quot; /etc/group
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="systemd"><a class="header" href="#systemd">systemd</a></h1>
<ul>
<li><strong>systemd</strong> is an init system that aims to provide better boot time and a better way to manage services and processes.</li>
<li><strong>systemd</strong> is a replacement of the <strong>System V like init</strong> system that most Linux distributions used.</li>
<li><strong>systemd</strong> includes additional utilities to help manage services on a Linux system; essentially, it's much more than an init system</li>
</ul>
<p>There are only two basic aspects of <strong>systemd</strong> that I want to cover in this lesson, but know that <strong>systemd</strong> is a big, complicated suite of software that provides a lot of functions. In this lesson, though, we will cover using <strong>systemd</strong> to:</p>
<ol>
<li>manage services</li>
<li>examine logs</li>
</ol>
<h2 id="manage-services"><a class="header" href="#manage-services">Manage Services</a></h2>
<p>When we install a complicated piece of software like a web server (e.g., Apache2), a SSH server (e.g., openssh-server), or a database server (e.g., MySQL), then it's helpful if we have some commands that will help us manage that service (the web service/server, the SSH service/server, etc).</p>
<p>For example, after installing a SSH server, we might like to know if it's running, or we might want to stop it if it's running, or start it if it's not. Let's see what that looks like. In the following commands, I will use the <code>dnf</code> utility to install the <code>openssh-server</code>. Then I will check the status of the server using the <code>systemctl status</code> command. I will enable it so that it starts automatically when the operating system is rebooted using the <code>systemctl enable</code> command. Finally, I will make sure the firewall allows outside access to the operating system via <code>ssh</code>. I use the <code>sudo</code> command to run the relevant commands as administrator:</p>
<pre><code>dnf search openssh
sudo dnf install openssh-server
systemctl status sshd.service
sudo systemctl enable sshd.service
sudo firewall-cmd --add-service=ssh --permanent
</code></pre>
<p>There are similar commands to stop a service or to reload a service if a service configuration file has changed. As an example of the latter, let's say that I wanted to present a message to anyone who logs into my system remotely using <code>ssh</code>. In order to do that, I need to edit the main <code>ssh</code> configuration file, which is located in <strong>/etc/ssh/sshd_config</strong>:</p>
<pre><code>cd /etc/ssh
sudo nano sshd_config
</code></pre>
<p>Then I will remove the beginning pound sign and thus un-comment the following line:</p>
<pre><code>#Banner none
</code></pre>
<p>And replace it with a path a file that will contain my message:</p>
<pre><code>Banner /etc/ssh/ssh-banner
</code></pre>
<p>After saving and closing <strong>/etc/ssh/sshd_config</strong>, I will create and open the banner file using <code>nano</code>:</p>
<pre><code>sudo nano /etc/ssh/ssh-banner
</code></pre>
<p>And add the following:</p>
<pre><code>Unauthorized access to this system is not permitted and will be reported to the authorities.
</code></pre>
<p>Since we have changed a configuration for the <code>sshd.service</code>, we need to reload the service so that <code>sshd.service</code> becomes aware of the new configuration. To do that, I use <code>systemctl</code> like so:</p>
<pre><code>sudo systemctl reload sshd.service
</code></pre>
<p>Now, when you log into your Fedora system, you will see that new banner displayed.</p>
<h2 id="examine-logs"><a class="header" href="#examine-logs">Examine Logs</a></h2>
<p>The <code>journalctl</code> command is also part of the <strong>systemd</strong> software suite and is used to monitor logs on the system.</p>
<p>If we just type <code>journalctl</code> at the command prompt, we will be presented with the logs for the entire system. These logs can be paged through by pressing the space bar, the page up/page down keys, or the up/down arrow keys, and they can also be searched by pressing the forward slash <code>/</code>.</p>
<pre><code>journalctl
</code></pre>
<p>However, it's much better to use various options. If you <code>tab tab</code> after typing <code>journalctl</code>, command line completion will provide additional fields (see man page: <code>man 7 systemd.journal-fields</code> and see <code>man man</code> for numbering options) to examine logs for. There are many, but as an example, we see that there is an option called _UID=, which allows us to examine the logs for a user with a specific user id. For example, on our independent Fedora systems, our user ID numbers are 1000. So that means I can see the logs for my account by:</p>
<pre><code>journalctl _UID=1000
</code></pre>
<p>The above shows journal entries related to user ID of 1000, which is my user id. We can see other user IDs by concatenating (<code>cat</code>) the <strong>passwd</strong> file. Not only do real humans who have accounts on the system have user IDs, but many services do to. Here I look at journal entries for <code>chronyd</code>, with a user ID of 992. This is a service that manages the system's time:</p>
<pre><code class="language-bash">cat /etc/passwd
journalctl _UID=984
</code></pre>
<p>I can more specifically look at the logs files for a service by using the <code>-u</code> option with <code>journalctl</code>:</p>
<pre><code>journalctl -u sshd.service
</code></pre>
<p>I can examine logs since last boot:</p>
<pre><code>journalctl -b
</code></pre>
<p>Or I can follow the logs in real-time (press <strong>ctrl-c</strong> to quit the real-time view):</p>
<pre><code>journalctl -f
</code></pre>
<h2 id="useful-systemd-commands"><a class="header" href="#useful-systemd-commands">Useful Systemd Commands</a></h2>
<p>You can see more of what <code>systemctl</code> or <code>journalctl</code> can do by reading through their documentation:</p>
<pre><code>man systemctl
man journalctl
</code></pre>
<p>You can get the status, start, stop, reload, restart a servicer; e.g., sshd:</p>
<pre><code>systemctl status sshd.service
systemctl start sshd.service
systemctl stop sshd.service
systemctl reload sshd.service
systemctl restart sshd.service
systemctl reload-or-restart sshd.service
</code></pre>
<p>To enable, disable sshd (or some service):</p>
<pre><code>systemctl enable sshd.service
systemctl disable sshd.service
</code></pre>
<p>You can check if a service if enabled:</p>
<pre><code>systemctl is-enabled sshd.service
</code></pre>
<p>You can reboot, poweroff, or suspend a system:</p>
<pre><code>systemctl reboot
systemctl poweroff
systemctl suspend
</code></pre>
<p>To show configuration file changes to the system:</p>
<pre><code>systemd-delta
</code></pre>
<p>To list real-time control group process, resource usage, and memory usage:</p>
<pre><code>systemd-cgtop
</code></pre>
<ul>
<li>to search failed processes/services:</li>
</ul>
<pre><code>systemctl --state failed
</code></pre>
<ul>
<li>to list services</li>
</ul>
<pre><code>systemctl list-unit-files -t service
</code></pre>
<ul>
<li>to examine boot time:</li>
</ul>
<pre><code>systemd-analyze
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="backing-up-and-managing-software"><a class="header" href="#backing-up-and-managing-software">Backing up and Managing Software</a></h1>
<h2 id="backup-with-rsync"><a class="header" href="#backup-with-rsync">Backup with <code>rsync</code></a></h2>
<h3 id="using-our-backups-directory"><a class="header" href="#using-our-backups-directory">Using our /backups directory</a></h3>
<p>To complete this assignment, you must have successfully completed <strong>Assignment 5: Logical Volumes</strong>.</p>
<p>In <strong>Assignment 5: Logical Volumes</strong>, we created an additional volume at <strong>/backups</strong>. In a real production scenario, we'd use separate drives and remote machines to store backups in order to full prepare for and recover from data loss. But for us, this <strong>/backups</strong> partition will work just fine.</p>
<h3 id="backup-with-rsync-1"><a class="header" href="#backup-with-rsync-1">Backup with <code>rsync</code></a></h3>
<p>In the <strong>Managing Users and Groups</strong> forum, we created a new user for our system. This means that we have at least two user accounts to backup: ours and the new uers.</p>
<p>Now we'll use the <code>rsync</code> command to backup these users' home directories to the <strong>/backups</strong> volume/partition. See <code>man rsync</code> for documentation. The basic syntax is:</p>
<pre><code>rsync option source-directory destination-directory
</code></pre>
<p>Syntax matters here. Specifically, there are two ways to backup the home directories using <code>rsync</code> depending on a small detail in our commands. Consider the next two examples:</p>
<p>In this first example, the <code>rsync</code> command will back up the home directory and all subdirectories to the <code>/backups</code> directory. Thus, <code>rsync</code> behaves differently whether I include or leave out the trailing slash after the <strong>home</strong> source-directory.</p>
<p>Thus, if I run <code>rsync</code> this way:</p>
<pre><code>rsync -ahv --delete /home /backups/
</code></pre>
<p>The results will look like this:</p>
<pre><code>ls /backups
home
ls /backups/home
linus sean
</code></pre>
<p>If I include the trailing slash after the <strong>/home/</strong> directory, like so:</p>
<pre><code>rsync -ahv --delete /home/ /backups/
</code></pre>
<p>Then <code>rsync</code> will sync the contents of the <strong>/home/</strong> directory, and the results will include not <strong>/home</strong> but the specific directories contained in <strong>/home</strong>:</p>
<pre><code>ls /backups
linus sean
</code></pre>
<h3 id="delete-option"><a class="header" href="#delete-option">Delete Option</a></h3>
<p>The <code>--delete</code> option is important. Without it, <code>rsync</code> will add new files to the destination directory when it backs up the source directory. With it, <code>rsync</code> truly syncs. Thus, if a file that was previously backed up to the destination directory and later deleted in the source directory (e.g., because it was no longer needed), then it will be deleted from the destination directory when the <code>--delete</code> option is used. This is how services like Dropbox work.</p>
<p>See other options and functionality for <code>rsync</code> here: <a href="https://www.linux.com/tutorials/how-backup-files-linux-rsync-command-line/">https://www.linux.com/tutorials/how-backup-files-linux-rsync-command-line/</a>. One of the most important options is the ability to backup up to remote machines over a network, and this can be done with the the <code>rsync</code> command.</p>
<h3 id="managing-software"><a class="header" href="#managing-software">Managing Software</a></h3>
<p>Many modern Linux distros offer some kind of package management for installing, managing, and removing software. On RedHat based systems, package management is based on <code>rpm</code> (the RedHat Package Manager). On Debian based systems, package management is based on <code>dpkg</code>.</p>
<p>There are some advanced things you can do with these base package management systems (<code>rpm</code> or <code>dpkg</code>), but most of the time it will be easier to use their front ends. For RedHat systems, the current front end is called <code>dnf</code>, and for Debian systems, it's <code>apt</code> or <code>apt-get</code>. Since the Fedora distribution is part of the RedHat universe, we'll use the <code>dnf</code> command to manage software. As always, read the <code>man dnf</code> manual for more information. See also <a href="https://dnf.readthedocs.io/en/latest/command_ref.html">the online documentation on dnf</a>.</p>
<p>Let's look at a few of the basic <code>dnf</code> commands.</p>
<h3 id="dnf-info-and-search-commands"><a class="header" href="#dnf-info-and-search-commands">dnf info and search commands</a></h3>
<p>To see a history of how <code>dnf</code> has been used on the system:</p>
<pre><code>dnf history
</code></pre>
<p>We get info on the history of a specific package on our system. Since we haven't installed anything yet, there's nothing to look at yet, but the basic syntax looks like this.</p>
<pre><code>dnf history package_name
</code></pre>
<p>To search for a package, we can use the following command to search for the <code>bash</code> package:</p>
<pre><code>dnf search bash
</code></pre>
<p>If the output is more than one page, we can <strong>pipe</strong> it through <code>less</code>.</p>
<p>To get technical information on a specific package, which we might want to do before we install it:</p>
<pre><code>dnf info bash
</code></pre>
<p>We can use <code>dnf</code> to search by tag in order to get information about a package. To get a list of possible tags to search by, we can use the following command:</p>
<pre><code>dnf reqoquery --querytags
</code></pre>
<p>Then to search by tag, we uset the following format that will show us tag-related information for the <code>bash</code> package:</p>
<pre><code>dnf repoquery --queryformat &quot;%{arch}&quot; bash
dnf repoquery --queryformat &quot;%{name}&quot; bash
dnf repoquery --queryformat &quot;%{release}&quot; bash
dnf repoquery --queryformat &quot;%{reponame}&quot; bash
</code></pre>
<p>Software managed by <code>dnf</code> is organized into groups, which contain multiple software packages. We can see a list of groups with this command:</p>
<pre><code>dnf group list
</code></pre>
<p>You should see a category called <strong>Installed Gruops</strong> and listed under that is <strong>Headless Management</strong>. You might recognize that from when we installed Fedora.</p>
<p>To see what packages would be installed with a group, such as the <strong>System Tools</strong> group, we can do:</p>
<pre><code>dnf group info &quot;System Tools&quot;
</code></pre>
<p>If we want to install the default packages with a group, then:</p>
<pre><code>sudo dnf group install &quot;System Tools&quot;
</code></pre>
<h3 id="dnf-install-process-and-commands"><a class="header" href="#dnf-install-process-and-commands">dnf install process and commands</a></h3>
<p>It's pretty simple to install a software package. The hard part will involve configuring a package after it's installed, if it's a complicated piece of software. For now, let's install <code>tmux</code>, which is a terminal multiplexer that we can use to open and manage multiple terminals in a single window.</p>
<pre><code>dnf search tmux
dnf info tmux
sudo dnf install tmux
dnf history tmux
</code></pre>
<p>To use <code>tmux</code>, I like to use the <strong>ctrl-a</strong> keybinding to control it. By default it's set to use <strong>ctrl-b</strong>. Let's configure the new keybinding like so. Here we redirect the configuration to the configureation file in our home directory. Since I'm using a single redirect <strong>&gt;</strong>, this file gets created. Remember to use a double redirect <strong>&gt;&gt;</strong> if appending to the file.</p>
<pre><code>echo &quot;set-option -g prefix C-a&quot; &gt; $HOME/.tmux.conf
</code></pre>
<p>And then start <code>tmux</code> like so:</p>
<pre><code>tmux
</code></pre>
<p>When done, just type <code>exit</code>.</p>
<h4 id="updating-the-system"><a class="header" href="#updating-the-system">Updating the system</a></h4>
<p>It's easy to update the entire system:</p>
<pre><code>sudo dnf update
sudo dnf clean all
</code></pre>
<p>The <code>dnf clean all</code> command removes the downloaded files, thereby freeing up storage space, used to update the system. It does not reverse the update.</p>
<h3 id="dnf-basics"><a class="header" href="#dnf-basics">dnf basics</a></h3>
<p>Here are the basic <code>dnf</code> commands. See <code>man dnf</code> for details:</p>
<ul>
<li><code>dnf search [name]</code></li>
<li><code>dnf install [name]</code></li>
<li><code>dnf remove [name]</code></li>
<li><code>dnf repolist</code></li>
<li><code>dnf list installed</code></li>
<li><code>dnf list available</code></li>
<li><code>dnf provides /usr/bin/bash</code></li>
<li><code>dnf info [name]</code></li>
<li><code>dnf update [name]</code></li>
<li><code>dnf check-update</code></li>
<li><code>dnf update OR dnf upgrade</code></li>
<li><code>dnf autoremove</code></li>
<li><code>dnf clean all</code></li>
<li><code>dnf help clean</code></li>
<li><code>dnf help</code></li>
<li><code>dnf history</code></li>
<li><code>dnf group list 'Python Science'</code></li>
<li><code>dnf group info 'Python Science'</code></li>
<li><code>dnf group install 'Python Science'</code></li>
<li><code>dnf group install --with -optional 'Python Science'</code></li>
<li><code>dnf group upgrade 'Python Science'</code></li>
<li><code>dnf group remove 'Python Science'</code></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="introduction-2"><a class="header" href="#introduction-2">Introduction</a></h1>
<p>This section covers basic networking, DNS, chroot, and firewalls.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="networking"><a class="header" href="#networking">Networking</a></h1>
<p>Wikipedia has a good primer on the <a href="https://en.wikipedia.org/wiki/Internet_protocol_suite">Internet protocol suite</a>.</p>
<h2 id="link-layer"><a class="header" href="#link-layer">Link Layer</a></h2>
<h3 id="arp-address-resolution-protocol"><a class="header" href="#arp-address-resolution-protocol">ARP (Address Resolution Protocol)</a></h3>
<p><em>ARP</em> or Address Resolution Protocol is a protocol used to map a network address, like the IP address, to the ethernet address (aka, the MAC or Media Access Control address, or the hardware address). Routers use MAC addresses to enable communication inside networks (w/in subnets) so that computers within a local network can talk to each other. Networks are designed so that IP addresses must be associated with MAC addresses before systems can communicate over a network.</p>
<p>To get ARP info for a system, we can use the <code>ip</code> command, which uses regular options (like <code>-b</code>) but also various <strong>objects</strong> (see <code>man ip</code> for details). Here is the IP info, the ARP output, and the routing table on my Fedora virtual machine (<strong>10.0.2.15</strong>) running on my desktop via a NAT connection:</p>
<pre><code>ip a
ip neigh show
ip route show
</code></pre>
<p>Where:</p>
<ul>
<li><strong>10.0.2.15</strong> is the IP address of my fedora server</li>
<li><strong>10.0.2.2</strong> is the first usable address on subnet, and is likely the virtual router; likewise, <strong>52:54:00:12:35:02</strong> is the MAC/hardware address for that virtual router</li>
<li><strong>10.0.2.0</strong> is called the <strong>network address (signified by the /24 part)</strong>, which is a unique identifier IP address for the subnet</li>
</ul>
<p>The above information is used or created in the following way: A router gets configured to use a specific <strong>network address</strong>, when it's brought online, it searches the network for connected MAC addresses that are assigned to wireless or ethernet cards, it assigns to each of those MAC addresses an available IP address based on the network address,</p>
<h2 id="internet-layer"><a class="header" href="#internet-layer">Internet Layer</a></h2>
<h3 id="ip-internet-protocol"><a class="header" href="#ip-internet-protocol">IP (Internet Protocol)</a></h3>
<p>The Internet Protocol, or <em>IP</em>, address is used to uniquely identify a host on a network and place that host at a specific location (its IP <strong>address</strong>). If that network is subnetted (i.e., routed), then a host's IP address will have a subnet or private IP address that will not be directly exposed to the Internet.</p>
<p>These IP address ranges are reserved, private address ranges, which means no public internet device will have an IP address within these ranges. The private address ranges include:</p>
<table><thead><tr><th>Start Address</th><th>End Address</th></tr></thead><tbody>
<tr><td>10.0.0.0</td><td>10.255.255.255</td></tr>
<tr><td>172.16.0.0</td><td>172.31.255.255</td></tr>
<tr><td>192.168.0.0</td><td>192.168.255.255</td></tr>
</tbody></table>
<p>If you have a router at home, and look at the IP address for at any of your devices connected to that router, like your phone or computer, you will see that it will have an address within one of the ranges above. For example, it might have an IP address beginning with <strong>192.168.X.X</strong>. This a standard IP address range for a home router. The <strong>10.X.X.X</strong> private range can assign many more IP addresses on its network. This is why you'll see that IP range on bigger networks, like UK's. We'll talk more about subnetwork sizes, shortly.</p>
<h3 id="example-private-ip-usage"><a class="header" href="#example-private-ip-usage">Example Private IP Usage</a></h3>
<p>At work, at one time, the IP address on my desktop was <strong>10.163.34.59/24</strong> via a wired connection. I checked with my office neighbor and found that their desktop reported an IP address of <strong>10.163.34.65/24</strong>. These are on the same subnet, and later I will show you how this works.</p>
<p>At the time, if we both, using our respective wired connected computers, searched Google for <em>[ what's my IP address ]</em>, we will see that we share the same public IP address of <strong>128.163.8.25</strong>.</p>
<p>Without any additional information, this tells us that we know that all traffic coming from our computers and going out to the internet looks like it's coming from the same IP address (<strong>128.163.8.25</strong>). And in reverse, all traffic coming from outside our network first goes to <strong>128.163.8.25</strong> before it's routed to our respective computers via the router.</p>
<p>My laptop tells a different story because it is connected to UK wireless (eduroam). At the time of this writing, the laptop had the IP address <strong>10.47.34.150/16</strong>. You can see there's a different pattern with this IP address. The reason it has a different pattern is because this laptop is on an different subnet. This wireless subnet was configured to allow more hosts to connect to it since it must allow for more devices (i.e., laptops, phones, etc). When I searched Google for my IP address from this laptop, it reported <strong>128.163.238.148</strong>, indicating that UK owns a range of public IP address spaces.</p>
<p>Here's kind of visual diagram of what this network looks like:</p>
<table><thead><tr><th style="text-align: center"><img src="18-network.png" alt="network diagram" /></th></tr></thead><tbody>
<tr><td style="text-align: center"><b>Fig. 1. This figure contains a network switch, which is used to route traffic within a subnet. It relies solely on MAC addresses and not IP addresses to determine the location of devices on its subnet. The router is capable of transferring data across networks.</b></td></tr>
</tbody></table>
<h3 id="using-the-ip-command"><a class="header" href="#using-the-ip-command">Using the <code>ip</code> Command</a></h3>
<p>The <code>ip</code> command can do more than provide us information about our network. We can also use it to turn a connection to the network on or off (and more). Here is how to disable and then enable a connection on a machine. Note that <strong>enp0s3</strong> is the name of my network card/device. Yours might have a different name.</p>
<pre><code>sudo ip link set enp0s3 down
sudo ip link set enp0s3 up
</code></pre>
<h2 id="transport-layer"><a class="header" href="#transport-layer">Transport Layer</a></h2>
<h3 id="udp-user-datagram-protocol"><a class="header" href="#udp-user-datagram-protocol">UDP, User Datagram Protocol</a></h3>
<p><em>UDP</em> or User Datagram Protocol performs a similar function as TCP, but it does not error check and data may get lost. UDP is useful for conducting voice over internet calls or for streaming video, such as through YouTube, which uses a type of UDP transmission called QUIC that has builtin encryption. </p>
<h3 id="tcp-transmission-control-protocol"><a class="header" href="#tcp-transmission-control-protocol">TCP, Transmission Control Protocol</a></h3>
<p><em>TCP</em> or Transmission Control Protocol is responsible for the transmission of data and for making sure the data arrives at its destination w/o errors. If there are errors, the data is re-transmitted or halted in case of some failure. Much of the data sent over the internet is sent using TCP.</p>
<h3 id="tcp-and-udp-headers"><a class="header" href="#tcp-and-udp-headers">TCP and UDP Headers</a></h3>
<p>The above protocols send data in data packets (TCP) or datagrams (UDP), but <a href="https://www.cloudflare.com/learning/network-layer/what-is-a-packet/">these terms may be used interchangeably</a>. Packets for both protocols include header information to help route the data across the internet. TCP includes <a href="https://www.imperva.com/learn/ddos/tcp-transmission-control-protocol/">ten fields</a> of header data, and UDP includes <a href="https://www.imperva.com/learn/ddos/udp-user-datagram-protocol/">four fields</a>.</p>
<p>We can see this header data using the <code>tcpdump</code> command, which requires <code>sudo</code> or being <strong>root</strong> to use. The first part of the IP header contains the source address, then comes the destination address, and so forth. Aside from a few other parts, this is the primary information in an IP header.</p>
<p>To use <code>tcpdump</code>, we first identify the IP number of a host, which we can do with the <code>ping</code> command, and then run <code>tcpdump</code>:</p>
<pre><code>ping -c1 www.uky.edu
sudo tcpdump host 128.163.35.46
</code></pre>
<p>While that's running, we can type that IP address in our web browser, or enter <strong>www.uky.edu</strong>, and watch the output of <code>tcpdump</code>.</p>
<p>TCP headers include port information and other mandatory fields for both source and destination servers. The SYN, or synchronize, message is sent when a source or client requests a connection. The ACK, or acknowledgment, message is sent in response, along with a SYN message, to acknowledge the request for a connection. Then the client responds with an additional ACK message. This is referred to as the <a href="https://www.geeksforgeeks.org/tcp-3-way-handshake-process/">TCP three-way handshake</a>. In addition to the header info, TCP and UDP packets include the data that's being sent (e.g., a webpage) and error checking if it's TCP.</p>
<h3 id="ports"><a class="header" href="#ports">Ports</a></h3>
<p>TCP and UDP connections use ports to bind internet traffic to specific IP addresses. Specifically, a <em>port</em> associates a process with an application, such as a web service or outgoing email. That is, ports provide a way to distinguish and filter internet traffic through an IP address. E.g., all traffic going to IP address 10.0.5.33:80 means that this is <strong>http</strong> traffic for the http web service, since http is commonly associated with port 80. Note that the port info is attached to the end of the IP address via a colon. </p>
<p>Common ports include:</p>
<ul>
<li>21: FTP</li>
<li>22: SSH</li>
<li>25: SMTP</li>
<li>53: DNS</li>
<li>143: IMAP</li>
<li>443: HTTPS</li>
<li>587: SMTP Secure</li>
<li>993: IMAP Secure</li>
</ul>
<p>There's a complete list of the 317 default ports on your Linux systems. It's located in the following file:</p>
<pre><code>less /etc/services
</code></pre>
<p>And to get a count of the ports, we can invert grep for lines starting with a pound sign or are empty</p>
<pre><code>grep -Ev &quot;^#|^$&quot; /etc/services | wc -l
</code></pre>
<p>See also the Wikipedia page: <a href="https://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers">List of TCP and UDP port numbers</a></p>
<h2 id="ip-subnetting"><a class="header" href="#ip-subnetting">IP Subnetting</a></h2>
<h3 id="private-ip-ranges"><a class="header" href="#private-ip-ranges">Private IP Ranges</a></h3>
<p>When subnetting, we generally work with private IP ranges:</p>
<table><thead><tr><th>Start Address</th><th>End Address</th></tr></thead><tbody>
<tr><td>10.0.0.0</td><td>10.255.255.255</td></tr>
<tr><td>172.16.0.0</td><td>172.31.255.255</td></tr>
<tr><td>192.168.0.0</td><td>192.168.255.255</td></tr>
</tbody></table>
<h4 id="ip-meaning"><a class="header" href="#ip-meaning">IP Meaning</a></h4>
<p>An IP address is 32 bits (8 x 4), or four bytes, in size. In human readable context, it's usually expressed in the following, decimal-based, notation style:</p>
<ul>
<li><strong>192.168.1.6</strong></li>
<li><strong>172.16.3.44</strong></li>
</ul>
<p>Each set of numbers separated by a dot is referred to as an <strong>octet</strong>. An <strong>octet</strong> is a group of 8 <strong>bits</strong>. Eight <strong>bits</strong> equal a single <strong>byte</strong>. By implication, 8 gigabits equals 1 gigabyte, and 8 megabits equals 1 megabyte. We use these symbols to note the terms:</p>
<table><thead><tr><th>Term</th><th>Symbol</th></tr></thead><tbody>
<tr><td>bit</td><td><em>b</em></td></tr>
<tr><td>byte</td><td>B</td></tr>
<tr><td>octet</td><td><em>o</em></td></tr>
</tbody></table>
<p>Each bit is represented by either a 1 or a 0. For example, the first address above in binary is:</p>
<ul>
<li>11000000.10101000.00000001.00000110</li>
<li>192.168.1.6</li>
</ul>
<p>Or:</p>
<ul>
<li>11000000 = 192</li>
<li>10101000 = 168</li>
<li>00000001 = 1</li>
<li>00000110 = 6</li>
</ul>
<h3 id="ip-math"><a class="header" href="#ip-math">IP Math</a></h3>
<p>When doing IP math, one easy way to do it is to simply remember that each bit in each of the above bytes is a placeholder for the following values:</p>
<pre><code>128 64 32 16 8 4 2 1
</code></pre>
<p>Alternatively, from low to high:</p>
<table><thead><tr><th>base-2</th><th>Output</th></tr></thead><tbody>
<tr><td>2^0</td><td>1</td></tr>
<tr><td>2^1</td><td>2</td></tr>
<tr><td>2^2</td><td>4</td></tr>
<tr><td>2^3</td><td>8</td></tr>
<tr><td>2^4</td><td>16</td></tr>
<tr><td>2^5</td><td>32</td></tr>
<tr><td>2^6</td><td>64</td></tr>
<tr><td>2^7</td><td>128</td></tr>
</tbody></table>
<p>In binary, 192 is equal to 11000000. It's helpful to work backward. For IP addresses, all octets are 255 or less (256 total, from 0 to 255) and therefore do not exceed 8 bits or places. To convert the integer 192 to binary:</p>
<pre><code>1 * 2^7 = 128
1 * 2^6 =  64 (128 + 64 = 192)
</code></pre>
<p>STOP: There are no values left, and so the rest are zeroes. So: 11000000</p>
<p>Our everyday counting system is base-10, but binary is base-2, and thus another way to convert binary to decimal is to multiple each bit (1 or 0) by the power of base two of its placeholder:</p>
<pre><code>(0 * 2^0) = 0 +
(0 * 2^1) = 0 +
(0 * 2^2) = 0 +
(0 * 2^3) = 0 +
(0 * 2^4) = 0 +
(0 * 2^5) = 0 +
(1 * 2^6) = 64 +
(1 * 2^7) = 128 = 192
</code></pre>
<p>Another way to convert to binary: simply subtract the numbers from each value. As long as there is something remaining or the placeholder equals the remainder of the previous subtraction, then the bit equals 1. So:</p>
<ul>
<li>192 - 128 = 64 -- therefore the first bit is equal to 1.</li>
<li>Now take the leftover and subtract it:</li>
<li>64 - 64 = 0 -- therefore the second bit is equal to 1.</li>
</ul>
<p>Since there is nothing remaining, the rest of the bits equal 0.</p>
<h3 id="subnetting-examples"><a class="header" href="#subnetting-examples">Subnetting Examples</a></h3>
<p>Subnetting involves dividing a network into two or more subnets. When we subnet, we first identify the number of hosts we will require on the subnet. For starters, let's assume that we need a subnet that can assign at most 254 IP addresses to the devices attached to it via the router.</p>
<p>We need two additional IP addresses: the <strong>subnet mask</strong> and the <strong>network address/ID</strong>. The <strong>network address</strong> identifies the network and the <strong>subnet mask</strong> marks the boundary between the network and the hosts. Knowing or determining the <strong>subnet mask</strong> will allow us to determine how many hosts can exist on a network. Both the <strong>network address</strong> and the <strong>subnet mask</strong> can be written as IP addresses, but they cannot be assigned to computers on a network.</p>
<p>When we have determined these IPs, we will know the <strong>broadcast address</strong>. This is the last IP address in a subnet range, and it cannot be assigned to a connected device. The <strong>broadcast address</strong> is used by a router or other devices to communicate to all connected devices on the subnet.</p>
<p>For our sake, let's work backwards. We want to identify and describe a network that we are connected to. Let's work with two example private IP addresses that exist on two separate subnets.</p>
<h4 id="example-1-19216816"><a class="header" href="#example-1-19216816">Example 1: 192.168.1.6</a></h4>
<p>Let's derive the network mask and the network address (or ID) from this IP address.</p>
<pre><code>11000000.10101000.00000001.00000110 IP              192.168.1.6
11111111.11111111.11111111.00000000 Mask            255.255.255.0
-----------------------------------
11000000.10101000.00000001.00000000 Network Address 192.168.1.0
</code></pre>
<p>Note the mask has 24 ones followed by 8 zeroes. That 24 is used as CIDR notation:</p>
<p>192.168.1.6/24</p>
<p>For Example 1, we have the following subnet information:</p>
<table><thead><tr><th>Type</th><th>IP</th></tr></thead><tbody>
<tr><td>Netmask/Mask</td><td>255.255.255.0</td></tr>
<tr><td>Network ID</td><td>192.168.1.0</td></tr>
<tr><td>Start Range</td><td>192.168.1.1</td></tr>
<tr><td>End Range</td><td>192.168.1.254</td></tr>
<tr><td>Broadcast</td><td>192.168.1.255</td></tr>
</tbody></table>
<h4 id="example-2-101603875"><a class="header" href="#example-2-101603875">Example 2: 10.160.38.75</a></h4>
<p>For example 2:</p>
<pre><code>00001010.10100000.00100110.01001011 IP               10.160.38.75
11111111.11111111.11111111.00000000 Mask            255.255.255.0
-----------------------------------
00001010.10100000.00100110.00000000 Network Address   10.160.38.0
</code></pre>
<table><thead><tr><th>Type</th><th>IP</th></tr></thead><tbody>
<tr><td>Netmask/Mask</td><td>255.255.255.0</td></tr>
<tr><td>Network ID</td><td>10.160.38.0</td></tr>
<tr><td>Start Range</td><td>10.160.38.1</td></tr>
<tr><td>End Range</td><td>10.160.38.254</td></tr>
<tr><td>Broadcast</td><td>10.160.38.255</td></tr>
</tbody></table>
<h4 id="example-3-1721616224"><a class="header" href="#example-3-1721616224">Example 3: 172.16.1.62/24</a></h4>
<p>For example 3:</p>
<pre><code>10101100 00010000 00000001 00100111 IP                172.16.1.62
11111111 11111111 11111111 00000000 Mask            255.255.255.0
-----------------------------------
10101100 00010000 00000001 00000000 Network Address    172.16.1.0
</code></pre>
<table><thead><tr><th>Type</th><th>IP</th></tr></thead><tbody>
<tr><td>Netmask/Mask</td><td>255.255.255.0</td></tr>
<tr><td>Network ID</td><td>172.16.1.0</td></tr>
<tr><td>Start Range</td><td>172.16.1.1</td></tr>
<tr><td>End Range</td><td>172.16.1.254</td></tr>
<tr><td>Broadcast</td><td>172.16.1.255</td></tr>
</tbody></table>
<p>To determine the number of hosts on a CIDR /24 subnet, we look at the start and end ranges. In all three of the above examples, the start range begins with X.X.X.1 and ends with X.X.X.254. Therefore, there are 254 maximum hosts allowed on these subnets.</p>
<h4 id="example-4-10052316"><a class="header" href="#example-4-10052316">Example 4: 10.0.5.23/16</a></h4>
<p>The first three examples show instances where the CIDR is set to /24. This only allows 254 maximum hosts on a subnet. If the CIDR is set to /16, then we can theoretically allow 65,534 hosts on a subnet. </p>
<p>For example 4, then: 10.0.5.23/16</p>
<pre><code>00001010.00000000.00000101.00010111 IP Address: 10.0.5.23
11111111.11111111.00000000.00000000 Mask:       255.255.0.0
-----------------------------------------------------------
00001010.00000000.00000000.00000000 Network ID: 10.0.0.0
</code></pre>
<table><thead><tr><th>Type</th><th>IP</th></tr></thead><tbody>
<tr><td>IP Address</td><td>10.0.5.23</td></tr>
<tr><td>Netmask/Mask</td><td>255.255.0.0</td></tr>
<tr><td>Network ID</td><td>10.0.0.0</td></tr>
<tr><td>Start Range</td><td>10.0.0.1</td></tr>
<tr><td>End Range</td><td>10.0.255.254</td></tr>
<tr><td>Broadcast</td><td>10.0.255.255</td></tr>
</tbody></table>
<p>Hosts:</p>
<table><thead><tr><th>IPs</th><th></th></tr></thead><tbody>
<tr><td>10.0.0.1</td><td></td></tr>
<tr><td>10.0.0.255</td><td>= 256</td></tr>
<tr><td>10.0.1.1</td><td></td></tr>
<tr><td>10.0.255.255</td><td>= 256</td></tr>
</tbody></table>
<ul>
<li>Number of Hosts = 256 x 256 = 65536</li>
<li>Subtract Network ID (1) and Broadcast (1) = 2 IP addresses</li>
<li>Number of Usable Hosts = 256 x 256 - 2 = 65534</li>
</ul>
<h3 id="ipv6-subnetting"><a class="header" href="#ipv6-subnetting">IPv6 subnetting</a></h3>
<p>We're not going to cover IPv6 subnetting, but if you're interested, this is a nice article: <a href="https://supportforums.cisco.com/document/66991/ipv6-subnetting-overview-and-case-study">IPv6 subnetting overview</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="introduction-to-dns-the-domain-name-system"><a class="header" href="#introduction-to-dns-the-domain-name-system">Introduction to DNS, the Domain Name System</a></h1>
<h2 id="dns-intro-videos"><a class="header" href="#dns-intro-videos">DNS Intro Videos</a></h2>
<p>Two helpful YouTube videos. The first one provides an overview of the DNS system:</p>
<p><a href="https://www.youtube.com/watch?v=mpQZVYPuDGU">How a DNS Server (Domain Name System) works</a></p>
<p>The second video illustrates how to use a GUI to create and manage DNS records.</p>
<p><a href="https://www.youtube.com/watch?v=cwT82ibOM2Q">DNS Records</a></p>
<p>Here is a nice intro to recursive DNS:</p>
<p><a href="https://www.cloudflare.com/learning/dns/what-is-recursive-dns/">https://www.cloudflare.com/learning/dns/what-is-recursive-dns/</a></p>
<h2 id="fqdn-the-fully-qualified-domain-name"><a class="header" href="#fqdn-the-fully-qualified-domain-name">FQDN: The Fully Qualified Domain Name</a></h2>
<p>The structure of the domain name system is like the structure of the UNIX/Linux file hierarchy; that is, it is like an inverted tree.</p>
<p>The fully qualified domain name includes a period at the end of the top-level domain. Your browser is able to supply that dot since we often don't use it when typing website addresses.</p>
<p>Thus, for Google's main page, the FQDN is:</p>
<p>FQDN: www.google.com.</p>
<p>And the parts include:</p>
<pre><code>.           root domain
com         top-level domain
google.     second-level domain
www.        third-level domain
</code></pre>
<p>This is important to know so that you understand how the <strong>Domain Name System</strong> works and which DNS servers are responsible for their part of the network.</p>
<h3 id="root-domain"><a class="header" href="#root-domain">Root domain</a></h3>
<p>The root domain is managed by root name servers. These servers are listed on the <a href="https://www.iana.org/domains/root/servers">IANA</a>, the Internet Assigned Numbers Authority, website, but are managed by multiple operators. The root servers manage the root domain, alternatively referred to as the zone, or the <code>.</code> at the end of the <code>.com.</code>, <code>.edu.</code>, etc.</p>
<h4 id="alternative-dns-root-systems"><a class="header" href="#alternative-dns-root-systems">Alternative DNS root systems</a></h4>
<p>Aside: It's possible to have alternate internets by using outside root name servers. This is not common, but it happens. Read about a few of them here:</p>
<ul>
<li>sdf: <a href="https://web.archive.org/web/20081121061730/http://www.smtpnic.org/">https://web.archive.org/web/20081121061730/http://www.smtpnic.org/</a></li>
<li>opennic: <a href="https://www.opennicproject.org/">https://www.opennicproject.org/</a></li>
<li>alternic: <a href="https://en.wikipedia.org/wiki/AlterNIC">https://en.wikipedia.org/wiki/AlterNIC</a></li>
</ul>
<p>Russia, as an example, has threated to use it's own alternate internet based on a different DNS root system. This would essentially create a large, second internet. You can read about in this <a href="https://spectrum.ieee.org/tech-talk/telecom/internet/could-russia-really-build-its-own-alternate-internet">IEEE Spectrum article</a>.</p>
<h3 id="top-level-domain-tld"><a class="header" href="#top-level-domain-tld">Top level domain (TLD)</a></h3>
<p>We are all familiar with top level domains. Specific examples include:</p>
<ul>
<li>generic names: .org, .com, .net, .mil, .gov</li>
<li>and country code-based: .us, .uk, .ca</li>
</ul>
<p>We can download a list of those top level names from IANA, and get a total count:</p>
<pre><code>wget https://data.iana.org/TLD/tlds-alpha-by-domain.txt
sed '1d' tlds-alpha-by-domain.txt | wc -l
1495
</code></pre>
<h3 id="second-level-domain-names"><a class="header" href="#second-level-domain-names">Second-level domain names</a></h3>
<p>In the Google example, the second level domain is <strong>google</strong>. Other examples include: <strong>redhat</strong> in <strong>redhat.com</strong> and <strong>debian</strong> in <strong>debian.org</strong>. <a href="https://www.amazon.com/Linux-Administration-Beginners-Guide-Seventh/dp/0071845364">Soyinka, (2016)</a> refers to this part of the FQDN as that which makes up the &quot;organizational boundary of the namespace&quot; (p. 425).</p>
<h3 id="third-level-domain-names--hostnames--subdomains"><a class="header" href="#third-level-domain-names--hostnames--subdomains">Third-level domain names / hostnames / subdomains</a></h3>
<p>When you've purchased (leased) a top and second level domain like getfedora.org, you can choose whether you employ third level domains. For example: www is a third level domain. If you owned <code>example.org</code>, you could also have <code>www.example.org</code> resolve to a different location, or, <code>www.example.org</code> could resolve to the second-level domain itself. That is:</p>
<ul>
<li>www.debian.org can point to debian.org</li>
</ul>
<p>But it could also point to a separate server, such that <strong>debian.org</strong> and <strong>www.debian.org</strong> would be two separate servers with two separate websites or services. Although this is not common with third-level domains that start with <strong>www</strong>, it is common with others.</p>
<p>For example, with hostnames that are not <code>www</code>:</p>
<ul>
<li>google.com resolves to www.google.com</li>
<li>google.com does not resolve to:
<ul>
<li>drive.google.com, or</li>
<li>maps.google.com, or</li>
<li>mail.google.com</li>
</ul>
</li>
</ul>
<p>This is because those other three provide different, but specific services.</p>
<h2 id="dns-paths"><a class="header" href="#dns-paths">DNS Paths</a></h2>
<p>Recursive DNS is the first DNS server to be queried in the DNS system. This is the resolver server in the first video above. This server queries itself (recursive) to check if the domain to IP mapping has been cached in its system.</p>
<p>If it hasn't been cached, then the DNS query is <em>forwarded</em> to a root server and and so forth down the line.</p>
<p>We can use the <code>dig</code> command to query the non-cached DNS paths. Let's say we want to follow the DNS path for <strong>google.com</strong>, then we can start by querying any <a href="https://www.iana.org/domains/root/servers">root server</a>. In the output, we wan to pay attention to the QUERY field, the ANSWER field, and the Authority Section:</p>
<pre><code>dig @198.41.0.4 google.com 
</code></pre>
<p>The root servers only know about top level domains, and in this case, that's the <code>com.</code> domain. Fortunately, it lists some authoritative TLD servers and their IP addresses, and we can query one of those next:</p>
<pre><code>dig @192.12.94.30 google.com
</code></pre>
<p>Now we know something about the TLD. Here we still don't know the full path, but it does tell us that for <strong>google.com</strong>, we need to query one of Google's name servers:</p>
<pre><code>dig @216.239.34.10 google.com
</code></pre>
<p>And now we finally get our answer, which is that <strong>google.com</strong> resolves to 142.250.190.78, at least for me and at this instant.</p>
<h3 id="dns-record-types"><a class="header" href="#dns-record-types">DNS Record types</a></h3>
<ul>
<li>SOA:    Start of Authority: describes the site's DNS entries
<ul>
<li>IN:     Internet Record</li>
</ul>
</li>
<li>NS:     Name Server: state which name server provides DNS resolution</li>
<li>A:      Address records: provides mapping hostname to IPv4 address</li>
<li>AAAA:   Address records: provides mapping hostname to IPv6 address</li>
</ul>
<pre><code>dig google.com
google.com.     IN      A       142.251.32.78
</code></pre>
<ul>
<li>PTR:    Pointer Record: provides mapping from IP Address to Hostname</li>
<li>MX:     Mail exchanger: the MX record maps your email server.</li>
<li>CNAME:  Canonical name: used so that a domain name may act as an alias for another domain name. Thus, say someone visits www.example.org, but if no subdomain is set up for www, then the CNAME can point to example.org.</li>
</ul>
<h3 id="dns-toolbox"><a class="header" href="#dns-toolbox">DNS Toolbox</a></h3>
<p>It's important to be able to troubleshoot DNS issues. To do that, we have a few utilities available. Here are examples and you should read the <code>man</code> pages for each one:</p>
<p><code>host</code>: resolve hostnames to IP Address; or IP addresses to hostnames</p>
<pre><code>man -f host
host (1) - DNS lookup utility
host uky.edu
host 128.163.35.46
host -t MX uky.edu
host -t MX dropbox.com
host -t MX netflix.com
host -t MX wikipedia.org
</code></pre>
<p><code>dig</code>: domain information gopher -- get info on DNS servers</p>
<pre><code>man -f dig
dig (1) - DNS lookup utility
dig uky.edu
dig uky.edu MX
dig www.uky.edu CNAME
</code></pre>
<p><code>nslookup</code>: query internet name servers</p>
<pre><code>man -f nslookup
nslookup (1) - query Internet name servers interactively
nslookup
&gt; uky.edu
&gt; yahoo.com
&gt; exit
</code></pre>
<p><code>whois</code>: determine ownership of a domain</p>
<pre><code>man -f whois
whois (1) - client for the whois directory services
whois uky.edu | less
</code></pre>
<p><code>resolve.conf</code>: local resolver info; what's your DNS info</p>
<pre><code>man -f  resolv.conf
resolv.conf (5) - resolver configuration file
cat /etc/resolv.conf
resolvectl status
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="local-security-chroot"><a class="header" href="#local-security-chroot">Local Security: <code>chroot</code></a></h1>
<p>A <code>chroot jail</code> is a technology used to change the &quot;apparent root <code>/</code> directory for a user or a process&quot; and confine that user to that location on the system. A user or process that is confined to the <code>chroot jail</code> cannot easily see or access the rest of the file system and will have limited access to the binaries (executables/apps/utilities) on the system. From its <code>man</code> page:</p>
<pre><code>chroot (8) - run command or interactive shell with special root directory
</code></pre>
<p>Although it is not security proof, it does have some useful security use cases, from tampering. Some have used <code>chroot</code> to contain DNS servers, for example.</p>
<p><code>chroot</code> is also the conceptual basis for some kinds of virtualization technologies that are common today, like <a href="https://en.wikipedia.org/wiki/Docker_(software)">Docker</a>.</p>
<h2 id="chroot-a-current-user"><a class="header" href="#chroot-a-current-user">chroot a current user</a></h2>
<p>In this tutorial, we are going to create a <code>chroot</code> for a human user account.</p>
<p><strong>Step 1</strong>: Let's create a new user. After we create the new user, we will <code>chroot</code> that user going forward.</p>
<pre><code>sudo su
useradd -m -U -s /usr/bin/bash vader
passwd vader
</code></pre>
<p><strong>Step 2</strong>: Next, we <code>chroot</code> <em>vader</em> into a new directory. That directory will be located at <code>/var/chroot</code>. Note that the root directory for our regular users is <code>/</code>, but user <em>vader</em>'s root directory will be different <code>/var/chroot</code>, even if they can't tell.</p>
<pre><code>mkdir /var/chroot
</code></pre>
<p><strong>Step 3</strong>: Now we set up available binaries for the user. We'll only allow <code>bash</code> for now.  To do that, we'll create a <code>bin/</code> directory, and copy <code>bash</code> to that directory.</p>
<pre><code>which bash
mkdir -p /var/chroot/usr/bin
mkdir -p /var/chroot/bin
cp /usr/bin/bash /var/chroot/usr/bin/
cp /usr/bin/bash /var/chroot/bin/
</code></pre>
<p><strong>Step 4</strong>: Large software applications have dependencies (aka, libraries). Thus, next we copy the libraries that <code>bash</code> needs to run.</p>
<p>To identify libraries needed by bash:</p>
<pre><code>ldd /usr/bin/bash
</code></pre>
<p>Use the <code>locate</code> command to be sure you identify the exact locations of the libraries:</p>
<pre><code>locate libtinfo.so.6
...
</code></pre>
<p>Create a library directory. We'll name the library directory after lib64 since these are all lib64 libraries.</p>
<pre><code>mkdir /var/chroot/lib64
cp /usr/lib64/libtinfo.so.6 /var/chroot/lib64/
cp /usr/lib64/libdl.so.2 /var/chroot/lib64/
cp /usr/lib64/libc.so.6 /var/chroot/lib64/
cp /usr/lib64/ld-linux-x86-64.so.2 /var/chroot/lib64/
</code></pre>
<p><strong>Step 5</strong>: Create and test the <code>chroot</code></p>
<pre><code>chroot /var/chroot/
bash-5.1# ls
bash: ls: command not found
bash-5.1# help
bash-5.1# dirs
bash-5.1# cd bin/
bash-5.1# dirs
bash-5.1# cd ../lib64/
bash-5.1# dirs
bash-5.1# cd ..
bash-5.1# exit
</code></pre>
<p><strong>Step 6</strong>: Create a new group called <em>chrootjail</em>. We can add users to this group that we want to jail. Instructions are based on <a href="https://linuxconfig.org/how-to-automatically-chroot-jail-selected-ssh-user-logins">linuxconfig.org</a>.</p>
<pre><code>groupadd chrootjail
usermod -a -G chrootjail vader
groups vader
</code></pre>
<p><strong>Step 7</strong>: Edit <code>/etc/ssh/sshd_config</code> to direct users in the <code>chrootjail</code> group to the <code>chroot</code> directory. Add the following line at the end of the file. Then restart ssh server.</p>
<pre><code># nano /etc/ssh/sshd_config
Match group chrootjail
            ChrootDirectory /var/chroot/
</code></pre>
<p>Exit <code>nano</code>, and restart <code>ssh</code>:</p>
<pre><code>systemctl restart sshd
</code></pre>
<p>The logout of the server altogether:</p>
<pre><code>exit
</code></pre>
<p><strong>Step 8</strong>: Test <code>ssh</code>.</p>
<p>Connect to the Fedora server via <code>ssh</code> as the user <em>vader</em>:</p>
<pre><code>ssh vader@relevant_ip_address
-bash-5.1$ ls
-bash: ls: command not found
exit
</code></pre>
<p>That works as expected. The user <em>vader</em> is now restricted to a special directory and has limited access to the system or to any utilities on that system.</p>
<h2 id="exercise"><a class="header" href="#exercise">Exercise</a></h2>
<p>By using the <code>ldd</code> command, you can add additional binaries for this user. As an exercise, use the <code>ldd</code> command to locate the libraries for the <code>nano</code> editor, and make <code>nano</code> available to the user <em>vader</em> in the chrooted directory.</p>
<h3 id="nano-in-chroot"><a class="header" href="#nano-in-chroot">Nano in chroot</a></h3>
<p>After making Bash available in <code>chroot</code>:</p>
<p>(Side note: Unlike previous instances when I use the <strong>#</strong> sign to indicate a comment, below I'm using the <strong>#</strong> sign below to indicate the root prompt.)</p>
<pre><code># which nano
/usr/bin/nano
# cp /usr/bin/nano /var/chroot/bin/
# ldd /usr/bin/nano
linux-vdso.so.1 (0x00007fff5bdd5000)
  libmagic.so.1 =&gt; /lib64/libmagic.so.1 (0x00007f0ce11a7000)
  libncursesw.so.6 =&gt; /lib64/libncursesw.so.6 (0x00007f0ce1167000)
  libtinfo.so.6 =&gt; /lib64/libtinfo.so.6 (0x00007f0ce1138000)
  libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f0ce0f6e000)
  libz.so.1 =&gt; /lib64/libz.so.1 (0x00007f0ce0f54000)
  libdl.so.2 =&gt; /lib64/libdl.so.2 (0x00007f0ce0f4d000)
  /lib64/ld-linux-x86-64.so.2 (0x00007f0ce1232000)
# cp /usr/lib64/libmagic.so.1 /var/chroot/lib64/
# cp /usr/lib64/libncursesw.so.6 /var/chroot/lib64/
# cp /usr/lib64/libtinfo.so.6 /var/chroot/lib64/
# cp /usr/lib64/libc.so.6 /var/chroot/lib64/
# cp /usr/lib64/libz.so.1 /var/chroot/lib64/
# cp /usr/lib64/libdl.so.2 /var/chroot/lib64/
# cp /usr/lib64/ld-linux-x86-64.so.2 /var/chroot/lib64/
# chroot /var/chroot/
bash-5.1# nano
Error opening terminal: xterm-256color.
bash-5.1# exit
</code></pre>
<p>To fix this, install <code>ncurses-term</code> and copy over additional files:</p>
<pre><code># dnf install -y ncurses-term
# locate xterm-256color
/usr/share/terminfo/s/screen.xterm-256color
/usr/share/terminfo/x/xterm-256color
# mkdir -p /var/chroot/etc/terminfo/x/
# cp /usr/share/terminfo/x/* /var/chroot/etc/terminfo/x/
# chroot /var/chroot
# nano
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="security-firewalls-iptables-and-firewall-cmd"><a class="header" href="#security-firewalls-iptables-and-firewall-cmd">Security: Firewalls <code>iptables</code> and <code>firewall-cmd</code></a></h1>
<p>Netfilter is a part of the kernel that includes a suite of applications
that help manage how packets flow in and out of a server or internet
connected device. <code>iptables</code> is the command line user interface to
<strong>netfilter</strong> and is one of the main firewall applications on many
Linux distributions.</p>
<p>Fedora/RedHat offers a more user friendly interface to <code>iptables</code>
called <code>firewall-cmd</code> that I'll discuss below. Ubuntu offers its own
user friendly interface called <code>ufw</code>. In this lecture, I'll discuss
<code>iptables</code> and <code>firewall-cmd</code>.</p>
<h2 id="iptables"><a class="header" href="#iptables">iptables</a></h2>
<p>There are five predefined tables (<em>operations</em>) and five chains that
come with <code>iptables</code>. Tables define the kinds of operations that you
use to control the firewall and the packets that come in and out of the
system or through a system. The <em>filter</em> and <em>nat</em> tables are the most
commonly used ones.</p>
<p>The five <em>chains</em> are lists of rules that act on packets flowing through
the system. Finally, there are also <em>targets</em>. These are the actions to
be performed on packets. The main targets include <strong>ACCEPT</strong>, <strong>DROP</strong>,
and <strong>RETURN</strong>.</p>
<p>From <code>man iptables</code>, the tables and respective chains include:</p>
<ul>
<li>filter (the default table)
<ul>
<li>INPUT: for packets destined to local sockets</li>
<li>FORWARD: for packets being routed through the box</li>
<li>OUTPUT: for locally-generated packets</li>
</ul>
</li>
<li>nat
<ul>
<li>PREROUTING: for altering packets as soon as they come in</li>
<li>INPUT: for altering packets destined for local sockets</li>
<li>OUTPUT: for altering locally-generated packets</li>
<li>POSTROUTING: for altering packets as they are about to go out</li>
</ul>
</li>
<li>mangle
<ul>
<li>PREROUTING</li>
<li>OUTPUT</li>
<li>INPUT</li>
<li>FORWARD</li>
<li>POSTROUTING</li>
</ul>
</li>
<li>raw
<ul>
<li>PREROUTING</li>
<li>OUTPUT</li>
</ul>
</li>
<li>security
<ul>
<li>INPUT</li>
<li>OUTPUT</li>
<li>FORWARD</li>
</ul>
</li>
</ul>
<p>We'll cover the filter tables and the nat tables.</p>
<h3 id="usage"><a class="header" href="#usage">Usage</a></h3>
<p>First, we'll look at the default parameters for the <em>filter</em> table. You
need to be root to run this commands, or use <code>sudo</code>:</p>
<pre><code>sudo su
# -L: List all rules in the selected chain;
# if no chain is selected, then list all chains; and,
# -v: be verbose
iptables -L -v | less
iptables -L | grep policy
# specify a table
iptables -t filter -L -v
</code></pre>
<h3 id="allow-connections-only-from-subnet"><a class="header" href="#allow-connections-only-from-subnet">Allow connections only from subnet</a></h3>
<p>We can change the firewall to only allow communication on a subnet. Of
course, in order to do this, we need the subnet <strong>Network ID</strong> and the
<strong>CIDR</strong> number:</p>
<pre><code>ip a
</code></pre>
<p>Now that we have the Network ID and the CIDR number, we can set the
firewall (don't follow along here if you're connecting via SSH because
this will end your connection):</p>
<pre><code># comment: first, set policy to drop all incoming, forwarding, and
# outgoing
# packets; this means we're starting from a baseline
iptables --policy INPUT DROP
iptables --policy FORWARD DROP
iptables --policy OUTPUT DROP

# comment: review new policies for the above chains
iptables -L | grep policy

# comment: now accept only input, forwarding, and output from the
# following
# comment: network ranges:

iptables -A INPUT -s 10.163.36.0/24 -j ACCEPT
iptables -A FORWARD -s 10.163.36.0/24 -j ACCEPT
iptables -A OUTPUT -s 10.163.36.0/24 -j ACCEPT
</code></pre>
<p>To test this, we can try to connect to a remote server:</p>
<pre><code>w3m https://www.google.com
</code></pre>
<p>There are lots of examples on the web. Examples from:</p>
<ul>
<li><a href="http://www.tecmint.com/linux-iptables-firewall-rules-examples-commands/">http://www.tecmint.com/linux-iptables-firewall-rules-examples-commands/</a></li>
<li><a href="https://www.howtogeek.com/177621/the-beginners-guide-to-iptables-the-linux-firewall/">https://www.howtogeek.com/177621/the-beginners-guide-to-iptables-the-linux-firewall/</a></li>
</ul>
<h3 id="prerouting"><a class="header" href="#prerouting">PREROUTING</a></h3>
<p>Here is an example where we forward all traffic to port 25 to port 2525.
Here we use the <strong>NAT</strong> table, since NAT is responsible for network
address translation:</p>
<pre><code>iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 25 -j REDIRECT --to-port 2525
</code></pre>
<h3 id="output"><a class="header" href="#output">OUTPUT</a></h3>
<p>Here is an example where we disable outgoing email by disabling the
ports that are commonly associated with email. Of course, this could
be bypassed by using non-standard ports for email, but for out case,
it's a decent demonstration:</p>
<pre><code>## iptables -A OUTPUT -p tcp --dports 25,465,587 -j REJECT
</code></pre>
<h2 id="firewall-cmd"><a class="header" href="#firewall-cmd">firewall-cmd</a></h2>
<p><a href="https://docs.fedoraproject.org/en-US/Fedora/19/html/Security_Guide/sect-Security_Guide-Using_Firewalls.html">firewall-cmd documentation</a></p>
<p><strong>firewalld</strong> is a more user friendly interface to netfilters/iptables
in Red Hat based distros.</p>
<p>In <strong>firewalld</strong>, we use <strong>zones</strong> to manage internet traffic. It is
possible to define custom zones with <strong>firewalld</strong>, but it does come
included with the following predefined zones, and in many cases, these
might be all that we need:</p>
<ul>
<li>DROP : strictest. All incoming network packets are dropped</li>
<li>BLOCK : all very strict</li>
<li>PUBLIC : only selected incoming connections are accepted. Good zone
for web server, email server, etc.</li>
<li>EXTERNAL : external networks (useful for NAT)</li>
<li>DMZ : computers located in DMZ</li>
<li>work : trust most computers in network and accept some services</li>
<li>home : trust most computers in network and accept some services</li>
<li>trusted : trust all machines in network</li>
</ul>
<p>Check if running:</p>
<pre><code>firewall-cmd --state
</code></pre>
<p>Get active zones and interfaces attached to them:</p>
<pre><code>firewall-cmd --get-zones
firewall-cmd --get-default-zone
firewall-cmd --get-active-zones
FedoraServer
  interfaces: enp0s3
</code></pre>
<p>Allow port 22, list ports, remove services by name, add services by name:</p>
<pre><code>firewall-cmd --zone=FedoraServer --add-port=22/tcp
firewall-cmd --zone=FedoraServer --list-ports
firewall-cmd --zone=FedoraServer --remove-service=ssh --permanent
firewall-cmd --zone=FedoraServer --add-service=smtp --permanent
firewall-cmd --reload
</code></pre>
<p>Go into panic mode (drop all incoming/outgoing packets):</p>
<pre><code>firewall-cmd --panic-on
firewall-cmd --panic-off
</code></pre>
<p>To change default zone:</p>
<pre><code>firewall-cmd --permanent --set-default-zone=public
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="introduction-3"><a class="header" href="#introduction-3">Introduction</a></h1>
<p>This section shows how to create a LAMP (Linux, Apache2, MySQL, and PHP) server.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installing-apache2"><a class="header" href="#installing-apache2">Installing Apache2</a></h1>
<p>Let's install our first web server.</p>
<p>First, switch to Bridged mode in VirtualBox network settings and refresh
MAC address in VirtualBox.</p>
<h2 id="update-system-first"><a class="header" href="#update-system-first">Update system first</a></h2>
<p>Make sure your machine is up to date before installing Apache2.</p>
<p>Login as root, or switch to the <code>root</code> user, and update the machine:</p>
<pre><code>sudo su
dnf update
</code></pre>
<h2 id="install-httpd"><a class="header" href="#install-httpd">Install <code>httpd</code></a></h2>
<p>Now, that the machine is updated, install Apache2. On distributions that
use a package management system, such as <code>dnf</code> on Fedora and <code>apt</code>
on Ubuntu, we can use those systems to install the relevant software
and dependencies. However, different distributions use different names
for the packages. Fedora refers to the Apache2 package as <code>httpd</code>
while Ubuntu refers to it as <code>Apache2</code>. We can use <code>dnf</code> to search
for the appropriate package name:</p>
<pre><code>dnf search apache | grep &quot;httpd&quot;
</code></pre>
<p>Apache2 is not the only web server available. <a href="https://nginx.org/en/">nginx</a> is another
popular web server, and you should explore or learn about other options
on your own.  For now, let's get some basic info on the <code>httpd</code> package:</p>
<pre><code>dnf info httpd
</code></pre>
<p>Based on the output, and at the time of this writing, it looks like the
<code>httpd</code> package refers to the Apache HTTP Server, version 2.4.51. I
want to highlight this because it's important to know what version of
things are that we're installing, for a couple of reasons at least:</p>
<ol>
<li>
<p>First, although Apache2 has its own dependencies, other packages
will also depend on it. For example, say we wanted to install Drupal or
WordPress, we would first have to install a web server, like Apache2,
and it might be the case that Drupal or WordPress require a certain
minimum version of Apache2.</p>
</li>
<li>
<p>Second, some Linux operating systems focus on stability and thus do
not update to the most recent version of a package instead opting for
the most stable version of the software. The <a href="https://httpd.apache.org/">latest stable release of
Apache2</a> is 2.4.51. But it's not always likely that Fedora or
some other distribution will use that or some newer version until the
next distribution upgrade, for example, from Fedora 33 to Fedora 34.
For now, this is fine, and we can proceed with the install:</p>
</li>
</ol>
<pre><code>dnf -y install httpd
</code></pre>
<h2 id="basic-checks"><a class="header" href="#basic-checks">Basic checks</a></h2>
<p>One of the things that makes Apache2, and some other web servers, powerful
is the library of modules that extend Apache's functionality. We'll come
back to modules soon. For now, we're going to make sure the server is
up and running, configure some basic things, and then create a basic
web site.</p>
<p>To start, let's get some info about Apache2 and make sure it is <em>enabled</em>
and <em>running</em>:</p>
<pre><code>systemctl list-unit-files httpd.service
systemctl enable httpd.service
systemctl list-unit-files httpd.service
systemctl status httpd.service
systemctl start httpd.service
systemctl status httpd.service
</code></pre>
<h2 id="creating-a-web-page"><a class="header" href="#creating-a-web-page">Creating a web page</a></h2>
<p>Now that we have it up and running, let's look at the default web
page. We can use our loopback IP address (aka, <em>localhost</em>) and the
<code>w3m</code> text web browser to view the default page:</p>
<pre><code>dnf install -y w3m
w3m http://127.0.0.1
w3m http://localhost/
</code></pre>
<p>The <code>w3m</code> text-mode browser shows the <strong>Fedora Test Page</strong>. That's
a sign that the default install was successful.</p>
<p>Let's now create our first web page.  To do so, we need to know what
directory that <code>httpd</code> is using to serve websites. This directory is
called the <strong>DocumentRoot</strong> directory. If we read through that <strong>Fedora
Test Page</strong> document, it'll tell us that the default directory is
<code>/var/www/html/</code>. Let's go there and create a webpage with our text
editor of choice:</p>
<pre><code>cd /var/www/html/
nano index.html
</code></pre>
<p>Create a simple HTML page, something like this. Of course, modify the
content to suit your own interests:</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;My first web page using Apache2&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;h1&gt;Welcome&lt;/h1&gt;

&lt;p&gt;Welcome to my web site. I have ever created using Apache2 and Fedora
Linux.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;br/&gt;
Dr. Burns&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>After you're done, save and close the document. Let's visit our website
again with <code>w3m</code> to see if it works:</p>
<pre><code>w3m http://127.0.0.1
</code></pre>
<p>Let's open the firewall so that outside systems can access this page:</p>
<pre><code>firewall-cmd --list-all
firewall-cmd --get-active-zones
firewall-cmd --zone=FedoraServer --add-service=http
firewall-cmd --zone=FedoraServer --add-service=https
firewall-cmd --runtime-to-permanent
</code></pre>
<h2 id="changing-the-hostname"><a class="header" href="#changing-the-hostname">Changing the <code>hostname</code></a></h2>
<p>The <code>hostname</code> of a system is the label it uses to identify itself
to others (humans) on a (sub)network. If the hostname is on the web (or
the internet), it may also be part of its of the fully qualified domain
name (FQDN), which we studied during the DNS and networking weeks. For
example, on a server identified as <strong>enterprise.example.net</strong>, then
<strong>enterprise</strong>, is the hostname, <strong>example.net</strong> is the domain name,
and <strong>enterprise.example.net</strong> is the fully qualified domain name. If
two computers are on the same subnet, then they can be reachable via
the hostname only, but the domain name is part of the DNS system and is
required for two computers on the broader internet to reach each other.</p>
<p>We're going to check and set the system <code>hostname</code> on our Fedora
(virtual) machines using the <code>hostname</code> and <code>hostnamectl</code> commands:</p>
<p>Check the default hostname:</p>
<pre><code># hostname
localhost.localdomain
</code></pre>
<p>To change the default hostname from <strong>localhost</strong>, use the <code>hostnamectl</code>
command to update the system's hostname per the file. My new hostname
will be <strong>enterprise</strong>.  You can name your hostname whatever you want,
but be sure it's a single word with no punctuation.</p>
<pre><code>hostnamectl set-hostname enterprise
hostname
cat /etc/hostname
</code></pre>
<p>We can access our site by hostname rather than by IP:</p>
<pre><code>w3m http://enterprise
</code></pre>
<h3 id="optional"><a class="header" href="#optional">Optional</a></h3>
<p>After you've completed the above steps, do the following:</p>
<ol>
<li>
<p>On your host machine, find your OS's version of <code>/etc/hosts</code>. </p>
<ul>
<li>Windows instructions: <a href="https://gist.github.com/zenorocha/18b10a14b2deb214dc4ce43a2d2e2992">https://gist.github.com/zenorocha/18b10a14b2deb214dc4ce43a2d2e2992</a>.</li>
<li>macOS users can edit their <code>/etc/hosts</code> file.</li>
</ul>
</li>
<li>
<p>Map your guest IP address (your Fedora IP) to your new hostname:</p>
<pre><code>192.168.4.31 enterprise
</code></pre>
</li>
</ol>
<p>Then, in your Firefox, Chrome, or whatever browser, visit your new
website and replace <strong>enterprise</strong> with the hostname that you chose for
your guest OS:</p>
<pre><code>http://enterprise
</code></pre>
<h2 id="apache2-user-directories"><a class="header" href="#apache2-user-directories">Apache2 User Directories</a></h2>
<p>We can enable Apache2 so that users on our systems can run websites from
their home directories; that is, sites located at:</p>
<ul>
<li><code>$HOME/public_html</code></li>
</ul>
<h3 id="enable-userdir"><a class="header" href="#enable-userdir">Enable userdir</a></h3>
<p>Edit the <code>userdir.conf</code> file.</p>
<pre><code>cd /etc/httpd/conf.d/
nano userdir.conf
</code></pre>
<p>Make the following changes:</p>
<ul>
<li><code>UserDir disabled</code> to <code>UserDir enabled</code></li>
<li>Uncomment line <code>UserDir public_html</code></li>
</ul>
<p>After saving and exiting, restart <code>httpd.service</code>:</p>
<pre><code>systemctl restart httpd.service
</code></pre>
<h2 id="tasks"><a class="header" href="#tasks">Tasks</a></h2>
<ol>
<li>Exit out of root account</li>
<li>Go to your regular user's home directory</li>
<li>Make a directory titled <code>public_html</code> if it doesn't already exist</li>
<li>Set <code>public_html</code> directory permissions to 755:
<ul>
<li><code>chmod 755 public_html</code></li>
</ul>
</li>
<li>Change the user's directory permissions to 701:
<ul>
<li><code>chmod 701 /home/your_user</code></li>
</ul>
</li>
</ol>
<p><strong>SELinux</strong> needs to be configured to allow web access to our home
directories. Specifically, we need to set some SELinux switches. Using
<code>sudo</code> or logging in as <code>root</code>. Make sure you replace <strong>sean</strong>
with your username:</p>
<pre><code>setsebool -P httpd_enable_homedirs true
chcon -R -t httpd_sys_content_t /home/sean/public_html
</code></pre>
<p>Exit out of root if you need to.</p>
<h3 id="test"><a class="header" href="#test">Test</a></h3>
<p>Now test to see if your <code>public_html</code> site is operational by simply
visiting the site. For me, I use the following command:</p>
<pre><code>cd ~/public_html/
echo &quot;&lt;p&gt;Hello world&lt;/p&gt;&quot; &gt;&gt; index.html
w3m http://127.0.0.1/~sean
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installing-and-setting-php-for-apache"><a class="header" href="#installing-and-setting-php-for-apache">Installing and Setting PHP for Apache</a></h1>
<p>PHP is a server-side programming language. Client-side programming
languages, like JavaScript, are handled by the browser, but the PHP
software must be installed on the server and made to work with the Apache
<code>httpd</code> server.</p>
<p>In order for Apache and PHP to work together, we therefore need to
install PHP. Then we'll make some modifications to Apache so that it
defaults to PHP files rather than to HTML files.</p>
<p>To get started, let's work with last week's HTTP machine that we used to
set up Apache and user directories <code>userdir</code>. You can use that machine
or you can clone it to be sure that you have a good backup in case you
need to start over.</p>
<p>Let's find the relevant packages to install. Again, make sure your system
is up to date first.</p>
<pre><code>sudo su
dnf -y upgrade
dnf search php | less
dnf info php
dnf info php-common
dnf install php php-common
</code></pre>
<p>Since we are altering how the Apache <code>httpd</code> service functions, we
need to restart the service. To check and restart services:</p>
<pre><code>systemctl status httpd.service
systemctl restart httpd.service
systemctl status httpd.service
</code></pre>
<p>If all is well, our next task is to see if the Apache <code>httpd</code> service
recognizes PHP. We will proceed to the base HTTP directory, and use
<code>nano</code> to create and open a file called <code>info.php</code>.</p>
<pre><code>cd /var/www/html/
nano info.php
</code></pre>
<p>To make sure that the Apache web server can recognize that PHP is
installed and usable, we can add test code to the <code>info.php</code> file. The
test code will give us information about the version of PHP that we
just installed:</p>
<pre><code>&lt;?php
phpinfo();
?&gt;
</code></pre>
<p>Next, update file ownership for all files in this directory. They should
be owned be the Apache user:</p>
<pre><code>ls -l
chown apache:apache *
ls -l
w3m http://localhost/info.php
</code></pre>
<p>By default, if both an <strong>index.html</strong> file and an <strong>index.php</strong>
file exist in the same directory, the Apache web server will
display the <strong>index.html</strong> file if a user visits the directory (e.g.,
<code>http://example.com/</code> or <code>http://localhost/</code>). So we need to configure
Apache to display <em>index.php</em> files before displaying <em>index.html</em>
files in case both files exist in the same directory:</p>
<pre><code>cd /etc/httpd/conf/
nano httpd.conf
</code></pre>
<p>Change this line:</p>
<pre><code>DirectoryIndex index.html
</code></pre>
<p>To (that is, add <strong>index.php</strong> file to the line and make sure that it comes
before <strong>index.html</strong>. It should look like:</p>
<pre><code>DirectoryIndex index.php index.html
</code></pre>
<p>Since we have modified an Apache configuration file, we should check
that we haven't made a syntax mistake:</p>
<pre><code>apachectl configtest
</code></pre>
<p>If we get an <strong>Syntax Ok</strong> message (you can ignore the FQDN error
message), you can tell Apache to reload its config files:</p>
<pre><code>systemctl reload httpd.service
systemctl restart httpd.service
</code></pre>
<p>Now create a basic PHP page. <code>cd</code> back to the base HTTP directory and
use <code>nano</code> to create and open and <code>index.php</code> file:</p>
<pre><code>cd /var/www/html/
nano index.php
</code></pre>
<p>Add some HTML and PHP that will detect our browser to the <strong>index.php</strong>
(<a href="https://stackoverflow.com/questions/8754080/how-to-get-exact-browser-name-and-version">Source code link</a>):</p>
<pre><code>&lt;p&gt;You are using the following browser to view this site:&lt;/p&gt;

&lt;?php
echo $_SERVER['HTTP_USER_AGENT'] . &quot;\n\n&quot;;

$browser = get_browser(null, true);
print_r($browser);
?&gt;
</code></pre>
<p>Next, save and exit <code>nano</code>, change ownership of the file to Apache,
and view with <code>w3m</code>:</p>
<pre><code>chown apache:apache index.php
w3m http://localhost/
</code></pre>
<p>Of course, since we set up our hostname last week, we can use our hostname
in our URL:</p>
<pre><code>w3m http://enterprise/
</code></pre>
<p><strong>Your goal:</strong></p>
<ul>
<li>Create an <strong>index.php</strong> file in your <strong>userdir</strong></li>
<li>Add some PHP and submit screenshots, like last week, showing both
the code and the output.</li>
</ul>
<p>Test some sample PHP code from here: <a href="https://www.w3schools.com/php/php_syntax.asp">https://www.w3schools.com/php/php_syntax.asp</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="apache2-virtualhosts"><a class="header" href="#apache2-virtualhosts">Apache2 VirtualHosts</a></h1>
<p>In this tutorial, we use VirtualHosts so that our server may support
multiple domain names.</p>
<p>We do this by configuring Apache2 to recognize new DocumentRoot
directories for the additional domain names.</p>
<p>This allows us to serve multiple websites based on the same IP address.</p>
<h2 id="update-os"><a class="header" href="#update-os">Update OS</a></h2>
<p>As always, we need to keep our Fedora installation updated: </p>
<pre><code>dnf upgrade
</code></pre>
<h2 id="create-new-configurations"><a class="header" href="#create-new-configurations">Create new configurations</a></h2>
<p>So far we have learned how to create a main website at the following
document root:</p>
<p><strong>/var/www/html</strong> </p>
<p>We have also learned how to enable Apache2 to serve websites from user
directories:</p>
<p><strong>/home/USER/public_html/</strong>.</p>
<p>Websites that are stored at <strong>/var/www/html</strong> can eventually have a
domain name like <strong>example.org</strong> or <strong>biguniversity.edu</strong>. And then
websites at <strong>/home/USER/public_html/</strong> would have URLs like
<code>http://biguniversity.edu/~USER</code>.</p>
<p>The problem with creating a website at the <strong>/var/www/html</strong> DocumentRoot
is that, by default, we can only create the one main site; so either
<strong>example.org</strong> or <strong>biguniversity.edu</strong> but not both.</p>
<p><em>VirtualHosts</em> solve this problem. It allows a single server, with a
single IP address, to host websites linked to multiple domain names,
where all of these sites would have their own DocumentRoot directories
in the <strong>/var/www/html</strong> directory.</p>
<p>To start, we need to revisit the Apache configuration files and add
information about the VirtualHosts that we want to create. </p>
<p>We begin by adding VirtualHost information to the following file:</p>
<pre><code>less /etc/httpd/conf/httpd.conf
</code></pre>
<p>That file includes the following line:</p>
<ul>
<li><code>IncludeOptional conf.d/*.conf</code></li>
</ul>
<p>That option tells the Apache2 service to look for additional configuration
files in the <strong>conf.d/</strong> directory. Per that above line, the configuration
files that we add will need to end with <strong>.conf</strong>.</p>
<p>To get started, we'll name the files after some pretend domain names. I'll
create a domain called <strong>linuxonenterprise.com</strong> and another one called
<strong>websysadmins.com</strong>:</p>
<pre><code>cd /etc/httpd/conf.d/
touch linuxonenterprise.conf
</code></pre>
<p>In the <strong>linuxonenterprise.conf</strong> file, I'll add the following info:</p>
<pre><code>&lt;VirtualHost *:80&gt;
ServerAdmin webmaster@linuxonenterprise.com
DocumentRoot &quot;/var/www/html/linuxonenterprise/&quot;
ServerName linuxonenterprise.com
ServerAlias www.linuxonenterprise.com
ErrorLog &quot;/var/log/httpd/linuxonenterprise.com-error_log&quot;
CustomLog &quot;/var/log/httpd/linuxonenterprise.com-access_log&quot; combined

&lt;Directory &quot;/var/www/html/linuxonenterprise/&quot;&gt;
DirectoryIndex index.php index.html
Options FollowSymLinks
AllowOverride All
Require all granted
&lt;/Directory&gt;
&lt;/VirtualHost&gt;
</code></pre>
<p>Then I'll repeat the process with a new file called <strong>websysadmins.conf</strong>.
To make life easier, I can copy the <strong>linuxonenterprise.conf</strong> to
<strong>websysadmins.conf</strong>.</p>
<pre><code>cp linuxonenterprise.conf websysadmins.conf
</code></pre>
<p>And edit the websysadmins.conf file accordingly by replacing the names
of the site:</p>
<pre><code>&lt;VirtualHost *:80&gt;
ServerAdmin webmaster@websysadmins.com
DocumentRoot &quot;/var/www/html/websysadmins/&quot;
ServerName websysadmins.com
ServerAlias www.websysadmins.com
ErrorLog &quot;/var/log/httpd/websysadmins.com-error_log&quot;
CustomLog &quot;/var/log/httpd/websysadmins.com-access_log&quot; combined

&lt;Directory &quot;/var/www/html/websysadmins/&quot;&gt;
DirectoryIndex index.html index.php
Options FollowSymLinks
AllowOverride All
Require all granted
&lt;/Directory&gt;
&lt;/VirtualHost&gt;
</code></pre>
<p>When done, I'll exit out of my text editor and check the configuration
syntax with one of the following two commands:</p>
<pre><code>httpd -t
apachectl configtest
</code></pre>
<p>You should get an error stating that the sites don't exist at the
<strong>DocumentRoot</strong>, but we'll fix that in a second. For now, you want to get
a <code>Syntax OK</code> message.</p>
<h2 id="creating-the-sites"><a class="header" href="#creating-the-sites">Creating the sites</a></h2>
<p>The above two files tell Apache2 to look for the two websites
in:</p>
<ul>
<li><code>/var/www/html/linuxonenterprise</code></li>
<li><code>/var/www/html/websysadmins</code></li>
</ul>
<p>These are the <strong>DocumentRoot</strong>, i.e., the base directories for our
websites. We need to create those locations. I'll do that now for my
two domains, and I'll use Bash brace expansion to create both at the
same time:</p>
<pre><code>mkdir /var/www/html/{linuxonenterprise,websysadmins}
</code></pre>
<p>The above command creates two directories:</p>
<ul>
<li>/var/www/html/linuxonenterprise</li>
<li>/var/www/html/websysadmins</li>
</ul>
<p>Now create some basic web pages in each domain directory:</p>
<pre><code>cd /var/www/html/linuxonenterprise
echo &quot;&lt;h1&gt;Linux on the Enterprise&lt;/h1&gt;&quot; &gt;&gt; index.html
</code></pre>
<p>Then <code>cd</code> to <strong>websysadmins</strong> from the <strong>linuxonenterprise</strong> directory:</p>
<pre><code>cd ../websysadmins
echo &quot;&lt;h1&gt;Web Sys Admins&lt;/h1&gt;&quot; &gt;&gt; index.html
</code></pre>
<p>And now we have to make sure that the user <code>apache</code> owns
those two directories and all future files in them. We use
the user <code>apache</code> because the main Apache2 configuration file
(<code>/etc/httpd/conf/httpd.conf</code>) has two directives that state that the
names of the User/Group should be <code>apache</code>:</p>
<pre><code>cd .. # to return to the parent directory
chgrp -R apache /var/www/html/
chmod 2775 -R /var/www/html
</code></pre>
<p>By adding our account to the <code>apache</code> group, we can edit these and all
future files without using <code>sudo</code> or becoming <code>root</code>. Here I make user
'sean' part of the <code>apache</code> group:</p>
<pre><code>usermod -a -G apache sean
</code></pre>
<p>This group addition will not go into effect until the user logs out and
logs back in.</p>
<p>You can run <code>ls -ld</code> and <code>ls -l</code> on those directories and files to
confirm that the <code>apache</code> owner owns them. You can also run <code>httpd -t</code>
or <code>apachectl configtest</code> again to confirm that all the syntax is good.</p>
<h2 id="the-hosts-file-etchosts"><a class="header" href="#the-hosts-file-etchosts">The Hosts File: <code>/etc/hosts</code></a></h2>
<p>In order to resolve IP address to domain names, we need some kind of
system that will map these two identifiers to each other. We have already
covered DNS more extensively, but since we're not really creating new
websites for the web, we'll repeat what we did in the previous weeks
with the <code>/etc/hosts</code> file.</p>
<p>The <code>/etc/hosts</code> file is like a basic DNS system and we can use as a
&quot;static table lookup for hostnames&quot; (from <code>man hosts</code>). Let's modify
this so that our IP address is mapped to the our domain names. To do
that, let's add the following line just after the two localhost lines:
(<strong>USE YOUR IP NOT MINE</strong>)</p>
<pre><code>ip a
192.168.4.32
sudo nano /etc/hosts
</code></pre>
<p>Then let's map the IP address to the hostnames that we'll use for the
new websites.  Add the following to <code>/etc/hosts</code>, but replace my IP
with yours and my hostname with one of your own creation:</p>
<pre><code>192.168.4.32 linuxonenterprise.com
192.168.4.32 websysadmins.com
</code></pre>
<p>This is one way to create a kind of intranet that uses actual names instead of
just IP addresses. Say that you have a home network and one of the computers on
your network is running a web server. If you assign a static IP to this
computer using the software on your home router, modify the <code>/etc/hosts</code>
files on each of those three computers to point to that static IP via a domain
name, then you have basic DNS system for your subnet.</p>
<p>Now, let's restart Apache2 and see if we can visit our sites.</p>
<pre><code>systemctl reload httpd.service
systemctl restart httpd.service
w3m http://linuxonenterprise.com
w3m http://websysadmins.com
</code></pre>
<p>Success!</p>
<p>If you change the <code>/etc/hosts</code> file on your <strong>host</strong> machine (i.e., your
laptop) per the instructions in the last lecture, then you should be able to
visit <code>http://linuxonenterprise.com</code> and <code>http://websysadmins.com</code> in your
browser. Here is a snippet of what my <code>/etc/hosts</code> file looks like on my
desktop machine (i.e., my <strong>host</strong> machine):</p>
<pre><code>127.0.0.1      localhost
127.0.1.1      desktop
192.168.4.32    linuxonenterprise.com
192.168.4.32    websysadmins.com
</code></pre>
<h2 id="references"><a class="header" href="#references">References</a></h2>
<ul>
<li><a href="https://httpd.apache.org/docs/2.2/vhosts/name-based.html">Name-based Virtual Host Support</a></li>
<li><a href="https://httpd.apache.org/docs/2.4/vhosts/examples.html">VirtualHost Examples</a></li>
<li><a href="https://www.rosehosting.com/blog/apache-virtual-hosts-on-centos/">How to set up Apache Virtual Hosts on CentOS 7</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mysql-server-administration"><a class="header" href="#mysql-server-administration">MySQL Server Administration</a></h1>
<h2 id="install-and-set-up-mysql"><a class="header" href="#install-and-set-up-mysql">Install and Set Up MySQL</a></h2>
<p>This week we'll learn how to install, setup, secure, and configure
the MySQL relational database so that it works with the Apache2 web
server. First, a point on terms. This week we will be working as</p>
<ul>
<li>the Linux <strong>root</strong> user and as</li>
<li>the MySQL <strong>root</strong> user.</li>
</ul>
<p>These are two different users and accounts. To revisit, in Linux,
there is the <strong>root</strong> user, which has a home directory at <strong>/root</strong>,
and there is also the <strong>root</strong> directory at <strong>/</strong>.</p>
<p>In MySQL and other relational database software, there is also a <strong>root</strong>
user and this user is not the same as the Linux <strong>root</strong> user. It's
important to keep these concepts separate in our heads, and for most
of this transcript, I will refer to the MySQL root user or to the Linux
root user when I'm referring to either one.</p>
<p>First, let's install MySQL Community Server, and then log into the MySQL
shell under the <strong>MySQL root</strong> account.</p>
<pre><code>sudo su
dnf upgrade
dnf search mysql server
dnf info community-mysql-server
dnf info community-mysql-server
dnf install community-mysql-server
systemctl list-unit-files mysqld.service
systemctl status mysqld.service
systemctl start mysqld.service
systemctl enable mysqld.service
systemctl status mysqld.service
systemctl list-unit-files mysqld.service
mysql -u root
</code></pre>
<p>After we have logged in, we need to create a secure password for the
<strong>MySQL root</strong> account. Again, do not confuse the <strong>Linux root</strong> with
the <strong>MySQL root</strong> account. That is, these are two different accounts:
<em>Linux root</em> and <em>MySQL root</em>. Once we have created the password, we
will exit MySQL.</p>
<p>In MySQL, we will create the following root password: &quot;aNewPassword4!&quot;
(withouth the quotes), and then log out. In a production environment,
I would not use a basic password like this, but for our purposes, we
can keep things simple.</p>
<pre><code>mysql&gt; alter user 'root'@'localhost' identified by 'aNewPassword4!';
mysql&gt; \q
</code></pre>
<h2 id="secure-mysql-server"><a class="header" href="#secure-mysql-server">Secure MySQL Server</a></h2>
<p>Now we use a MySQL program called <code>mysql_secure_installation</code> to help
secure the MySQL installation. From the Bash shell and while logged in
as <strong>Linux root</strong>, run the following command, and respond to the command
line prompts as follows:</p>
<pre><code>mysql_secure_installation
Enter password for user root: aNewPassword4!
Validate Password: Y
Password Strength: 0
Change the password for root: N
Remove anonymous users: y
Disallow root login remotely: y
Remove test database: y
Reload privilege tables now: y
</code></pre>
<h2 id="create-and-set-up-a-regular-user-account"><a class="header" href="#create-and-set-up-a-regular-user-account">Create and Set Up a Regular User Account</a></h2>
<p>Now, log back into the MySQL shell as the <strong>MySQL root</strong> user. Here the
command is a bit different from the first one that we used to login to
MySQL because we now have to enter our password:</p>
<pre><code>mysql -u root -p
</code></pre>
<p>In MySQL, we need to create and set up a new account that is not <strong>root</strong>
and therefore does not have <strong>root</strong> privileges:</p>
<pre><code>mysql&gt; create user 'sean'@'localhost' identified by 'an0ldP4ssPhrase!';
</code></pre>
<h2 id="create-a-practice-database"><a class="header" href="#create-a-practice-database">Create a Practice Database</a></h2>
<p>Now let's create a linux-topic database for user 'sean'. This user will
be granted all privileges on this database, including all its tables.
Other than granting all privileges, we could only grant specific
privileges, including: CREATE, DROP, DELETE, INSERT, SELECT, UPDATE, and
GRANT OPTION. Such privileges may be called operations or functions. They
allow MySQL users to use and modify the database:</p>
<p>Don't use this exact command, but the syntax of the <code>grant</code> command
below is this:</p>
<pre><code>grant PRIVILEGE_OPTION on DATABASE.TABLE to 'USER'@'LOCALHOST';
</code></pre>
<p>In practice, we do this:</p>
<pre><code>mysql&gt; create database linuxdb;
mysql&gt; grant all privileges on linuxdb.* to 'sean'@'localhost';
mysql&gt; show databases;
mysql&gt; \q
</code></pre>
<h3 id="logging-in-as-regular-user-and-creating-tables"><a class="header" href="#logging-in-as-regular-user-and-creating-tables">Logging in as Regular User and Creating Tables</a></h3>
<p>Now, we can start doing MySQL work. We've created a new MySQL user named
<strong>sean</strong> and a new database for <strong>sean</strong> that is called <strong>linuxdb</strong>. Let's
logout out of the <strong>Linux root</strong> account and re-login under our regular
Linux account, for me that's <strong>sean</strong>, and create tables and data for
our database:</p>
<pre><code>$ mysql -u sean -p
mysql&gt; show databases;
mysql&gt; use linuxdb;
mysql&gt; create table distributions
    -&gt; (
    -&gt; id int unsigned not null auto_increment,
    -&gt; name varchar(150) not null,
    -&gt; developer varchar(150) not null,
    -&gt; founded date not null,
    -&gt; primary key (id)
    -&gt; );
Query OK, 0 rows affected (0.07 sec)

mysql&gt; show tables;
mysql&gt; describe distributions;
</code></pre>
<p>Congratulations! Now create some records for that table.</p>
<h3 id="adding-records-into-the-table"><a class="header" href="#adding-records-into-the-table">Adding records into the table</a></h3>
<p>We'll use the INSERT command to add records:</p>
<pre><code>mysql&gt; insert into distributions (name, developer, founded) values
    -&gt; ('Debian', 'The Debian Project', '1993-09-15'),
    -&gt; ('Ubuntu', 'Canonical Ltd.', '2004-10-20'),
    -&gt; ('Fedora', 'Fedora Project', '2003-11-06');
Query OK, 3 rows affected (0.06 sec)
Records: 3  Duplicates: 0  Warnings: 0
mysql&gt; select * from distributions;
</code></pre>
<p>Success! Now let's test our table. We will complete the following tasks
to refresh our MySQL knowledge:</p>
<ul>
<li>retrieve some records or parts of records, </li>
<li>delete a record,</li>
<li>alter the table structure so that it will hold more data, and</li>
<li>add a record:</li>
</ul>
<pre><code>mysql&gt; select name from distributions;
mysql&gt; select founded from distributions;
mysql&gt; select name, developer from distributions;
mysql&gt; select name from distributions where name='Debian';
mysql&gt; select developer from distributions where name='Ubuntu';
mysql&gt; # delete from distributions where name='Debian';
mysql&gt; select /* from distributions;
mysql&gt; alter table distributions add packagemanager char(3) after name;
mysql&gt; describe distributions;
mysql&gt; select * from distributions;
mysql&gt; update distributions set packagemanager=&quot;APT&quot; where id=&quot;1&quot;;
mysql&gt; update distributions set packagemanager=&quot;APT&quot; where id=&quot;2&quot;;
mysql&gt; update distributions set packagemanager=&quot;DNF&quot; where id=&quot;3&quot;;
mysql&gt; select * from distributions;
mysql&gt; insert into distributions (name, packagemanager, developer, founded) values
    -&gt; ('CentOS', 'YUM', 'The CentOS Project', '2004-05-14');
mysql&gt; select * from distributions;
mysql&gt; select name, packagemanager from distributions where founded &lt; '2004-01-01';
mysql&gt; select name from distributions order by founded;
mysql&gt; \q
</code></pre>
<h2 id="references-and-read-more"><a class="header" href="#references-and-read-more">References and Read More</a></h2>
<ol>
<li><a href="https://dev.mysql.com/doc/mysql-getting-started/en/">MySQL: Getting Started with MySQL</a></li>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-create-a-new-user-and-grant-permissions-in-mysql">How to Create a New User and Grant Permissions in MySQL</a></li>
<li><a href="https://dev.mysql.com/doc/refman/5.7/en/sql-syntax.html">MySQL: MySQL 5.7 Reference Manual: 13 SQL Statement Syntax</a></li>
</ol>
<h2 id="install-php-and-mysql-support"><a class="header" href="#install-php-and-mysql-support">Install PHP and MySQL Support</a></h2>
<p>The next goal is to complete the connection between PHP and MySQL so
that we can use both for our websites.</p>
<p>First install MySQL support for PHP. We're installing some modules alongside
the basic support. These may or may not be needed, but I'm installing them to
demonstrate some basics. Use <code>dnf info &lt;packagename&gt;</code> to get information
about each package before installing.</p>
<pre><code>sudo su
dnf install php-mysqlnd php-cli php-mbstring php-fpm
systemctl restart mysqld.service
systemctl restart httpd.service
</code></pre>
<h3 id="create-php-scripts"><a class="header" href="#create-php-scripts">Create PHP Scripts</a></h3>
<p>Let's move to the base web directory and create our login file, which
will contain the credentials for our <em>MySQL regular user</em> account. In
the previous week, I demonstrated VirtualHosts. We'll use one of our
virtual domains to connect to our MySQL server with PHP.</p>
<pre><code>cd /var/www/html/linuxonenterprise/
touch login.php
chmod 640 login.php
ls -l login.php
nano login.php
</code></pre>
<p>In the file, add the following credentials, substituting your credentials
where necessary:</p>
<pre><code>&lt;?php // login.php
$db_hostname = &quot;localhost&quot;;
$db_database = &quot;linuxdb&quot;;
$db_username = &quot;sean&quot;;
$db_password = &quot;an0ldP4ssPhrase!&quot;;
?&gt;
</code></pre>
<p>Now, in a separate file, which will be <strong>index.php</strong>, add the following
PHP to test our database connection and return some results:</p>
<pre><code>&lt;html&gt;
&lt;head&gt;&lt;title&gt;MySQL Server Example&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;

&lt;?php

// Load MySQL credentials
require_once 'login.php';

// Establish connection
$conn = mysqli_connect($db_hostname, $db_username, $db_password) or
  die(&quot;Unable to connect&quot;);

// Open database
mysqli_select_db($conn, $db_database) or
  die(&quot;Could not open database '$db_database'&quot;);

// QUERY 1
$query1 = &quot;show tables from $db_database&quot;;
$result1 = mysqli_query($conn, $query1);

$tblcnt = 0;
while($tbl = mysqli_fetch_array($result1)) {
  $tblcnt++;
}

if (!$tblcnt) {
  echo &quot;&lt;p&gt;There are no tables&lt;/p&gt;\n&quot;;
}
else {
  echo &quot;&lt;p&gt;There are $tblcnt tables&lt;/p&gt;\n&quot;;
}

// Free result1 set
mysqli_free_result($result1);

// QUERY 2
$query2 = &quot;select name, developer from distributions&quot;;
$result2 = mysqli_query($conn, $query2);

$row = mysqli_fetch_array($result2, MYSQLI_NUM);
printf (&quot;%s (%s)\n&quot;, $row[0], $row[1]);
echo &quot;&lt;br/&gt;&quot;;

$row = mysqli_fetch_array($result2, MYSQLI_ASSOC);
printf (&quot;%s (%s)\n&quot;, $row[&quot;name&quot;], $row[&quot;developer&quot;]);

// Free result2 set
mysqli_free_result($result2);

// Query 3
$query3 = &quot;select * from distributions&quot;;
$result3 = mysqli_query($conn, $query3);

while($row = $result3-&gt;fetch_assoc()) {
  echo &quot;&lt;p&gt;Owner &quot; . $row[&quot;developer&quot;] . &quot; manages distribution &quot; . $row[&quot;name&quot;] . &quot;.&lt;/p&gt;&quot;;
}

mysqli_free_result($result3);

$result4 = mysqli_query($conn, $query3);
while($row = $result4-&gt;fetch_assoc()) {
  echo &quot;&lt;p&gt;Distribution &quot; . $row[&quot;name&quot;] . &quot; was released on &quot; . $row[&quot;founded&quot;] . &quot;.&lt;/p&gt;&quot;;
}

// Free result4 set
mysqli_free_result($result4);

/* Close connection */
mysqli_close($conn);

?&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>After you save the file and exit the text editor, we need to test the
PHP syntax. If there are any errors in our PHP, these commands will show
the line numbers that are causing errors or leading up to errors. If all
is well with the first command, nothing will output. If all is well with
the second command, HTML should be outputted:</p>
<pre><code>php -f login.php
php -f index.php
chown :apache *php
</code></pre>
<h3 id="check-ip-and-hostname"><a class="header" href="#check-ip-and-hostname">Check IP and Hostname</a></h3>
<p>We want to make sure that <code>/etc/hosts</code> has the correct IP address
for <strong>linuxonenterprise</strong>:</p>
<pre><code>ip a
nano /etc/hosts # update IP address if changed
</code></pre>
<h2 id="tasks-1"><a class="header" href="#tasks-1">Tasks</a></h2>
<p>Copy the <em>login.php</em> and <em>index.php</em> to your <code>public_html</code> directory
(you should still have <em>userdir</em> enabled). Figure out what you need to
change in order to get your script to work there.</p>
<h2 id="references-1"><a class="header" href="#references-1">References</a></h2>
<ul>
<li><a href="https://www.tecmint.com/test-php-mysql-database-connection-using-script/">How to Test PHP MySQL Database Connection Using Script</a></li>
<li><a href="https://www.if-not-true-then-false.com/2010/install-apache-php-on-fedora-centos-red-hat-rhel/">Install Apache/PHP 7.2.12 on Fedora 29/28, CentOS/RHEL 7.5/6.10</a></li>
<li><a href="https://secure.php.net/manual/en/book.mysqli.php">MySQL Improved Extension</a></li>
<li><a href="https://www.w3schools.com/PHP/php_ref_mysqli.asp">PHP 5 MySQLi Functions</a></li>
</ul>
<p>Note: this doesn't seem to be a problem now, but in previous times,
there was an an error with authentication due to an upgrade in MySQL
that hadn't caught up with PHP yet. If so, you might need to login as
<strong>root</strong> to MySQL and run the following command, replacing the relevant
information with your non-root user info:</p>
<pre><code>ALTER USER 'mysqlUsername'@'localhost' IDENTIFIED WITH mysql_native_password BY 'mysqlUsernamePassword';
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
