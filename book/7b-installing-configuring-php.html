<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Installing and Configuring PHP - Linux Systems Administration</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Entry level book on Linux systems administration.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Linux Systems Administration</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/cseanburns/linux_sysadmin" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="installing-and-configuring-php"><a class="header" href="#installing-and-configuring-php">Installing and Configuring PHP</a></h1>
<p>By the end of this section, you will be able to:</p>
<ol>
<li>Install and configure PHP to work with Apache2, which will enable dynamic content on your web server.</li>
<li>Provide an overview of how PHP interacts with a web server.</li>
<li>Modify Apache settings to serve PHP files as the default content.</li>
</ol>
<h2 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h2>
<p>Client-side programming languages, like JavaScript, are handled by the browser.
Major browsers like Firefox, Chrome, Safari, Edge, etc. include <a href="https://en.wikipedia.org/wiki/JavaScript_engine">JavaScript engines</a> that use just-in-time compilers
to execute the JavaScript code (Mozilla has a <a href="https://blog.mozilla.org/javascript/">nice description</a> of the process.)
From an end user's perspective, you basically install JavaScript when you install a web browser.</p>
<p><a href="https://www.php.net/">PHP</a>, on the other hand, is a server-side programming language.
This means it must be installed on the server in order to be used by the browser.
From a system administrator's perspective, this means that not only does PHP have be installed on a server,
but it must also be configured to work with the HTTP server, which in our case is Apache2.</p>
<p>The main use of PHP is to interact with databases, like MySQL, MariaDB, PostgreSQL, etc., in order to create dynamic page content.
This is our end goal.
To accomplish this, we have to:</p>
<ol>
<li>Install PHP and relevant Apache2 modules</li>
<li>Configure PHP and relevant modules to work with Apache2</li>
<li>Configure PHP and relevant modules to work with MariaDB</li>
</ol>
<h2 id="install-php"><a class="header" href="#install-php">Install PHP</a></h2>
<p>PHP allows us to create dynamic content, which means we can customize what is displayed on a web page based on user inputs or data from a database.
As normal, we will use <code>apt install</code> to install PHP and relevant modules and then restart Apache2 using the <code>systemctl</code> command:</p>
<pre><code>sudo apt install php libapache2-mod-php
sudo systemctl restart apache2
</code></pre>
<p>We can check its status and see if there are any errors:</p>
<pre><code>systemctl status apache2
</code></pre>
<h2 id="check-install"><a class="header" href="#check-install">Check Install</a></h2>
<p>To check that it's been installed and that it's working with Apache2, we can create a small PHP file in our web document root.
To do that, we navigate to the <code>/var/www/html/</code> directory, and create a file called <code>info.php</code>.
The <code>info.php</code> file allows us to verify that PHP is correctly installed and configured with Apache2.
It displays detailed information about the PHP environment on the server.</p>
<pre><code>cd /var/www/html/
sudo nano info.php
</code></pre>
<p>In that file, add the following text, then save and close the file:</p>
<pre><code>&lt;?php
phpinfo();
?&gt;
</code></pre>
<p>Now visit that file using the external IP address for your server.
For example, in Firefox, Chrome, etc, go to (<strong>be sure to replace the IP below with your IP address</strong>):</p>
<pre><code>http://55.333.55.333/info.php
</code></pre>
<p>You should see a page that provides system information about PHP, Apache2, and the server.
The top of the page should look like Figure 1 below:</p>
<figure>
<img src="images/24-phpinstall.png"
alt="PHP install page"
title="PHP install page">
<figcaption>
Fig. 1. A screenshot of the title of the PHP install page.
</figcaption>
</figure>
<h2 id="basic-configurations"><a class="header" href="#basic-configurations">Basic Configurations</a></h2>
<p>By default, Apache2 is set up to serve <a href="https://httpd.apache.org/docs/current/mod/mod_dir.html"><code>index.html</code> files first</a>, but since we are adding PHP to our setup,
we want Apache2 to prioritize PHP files to allow for dynamic content creation.</p>
<p>To prioritize PHP files, we need to edit the <code>dir.conf</code> file in the <code>/etc/apache2/mods-enabled/</code> directory.
In that file there is a line that starts with <code>DirectoryIndex</code>.
The first file in that line is <code>index.html</code>, and then there are a series of other files that Apache2 will look for in the order listed.
If any of those files exist in the document root, then Apache2 will serve those before proceeding to the next.
We simply want to put <code>index.php</code> first and let <code>index.html</code> be second on that line.</p>
<pre><code>cd /etc/apache2/mods-enabled/
sudo nano dir.conf
</code></pre>
<p>And change the line to this:</p>
<pre><code>DirectoryIndex index.php index.html index.cgi index.pl index.xhtml index.htm
</code></pre>
<p>Whenever we make a configuration change, we can use the <code>apachectl</code> command to check our configuration:</p>
<pre><code>apachectl configtest
</code></pre>
<p>If we get an <strong>Syntax Ok</strong> message, you can reload the Apache2 configuration and restart the service:</p>
<pre><code>sudo systemctl reload apache2
sudo systemctl restart apache2
</code></pre>
<p>If the configuration test does not return <strong>Synax Ok</strong>, check the error message for guidance, and
ensure all modifications to <code>dir.conf</code> were made correctly.</p>
<p>Now create a basic PHP page.
<code>cd</code> back to the document root directory and use <code>nano</code> to create and open and <code>index.php</code> file:</p>
<pre><code>cd /var/www/html/
sudo nano index.php
</code></pre>
<h2 id="creating-an-indexphp-file"><a class="header" href="#creating-an-indexphp-file">Creating an index.php File</a></h2>
<p>Let's now create an <strong>index.php</strong> page, and add some HTML and PHP to it.
The PHP can be a simple <a href="https://stackoverflow.com/questions/8754080/how-to-get-exact-browser-name-and-version">browser detector</a>.
This script will detect and display the browser information of whoever is visiting your site.
It uses the PHP global variable <code>$_SERVER['HTTP_USER_AGENT']</code> to print the user's browser type and version.</p>
<p>First, make sure you are in the <code>/var/www/html/</code> directory.
Use <code>sudo nano</code> to create and edit <code>index.php</code>.
Then add the following code:</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Browser Detector&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p&gt;You are using the following browser to view this site:&lt;/p&gt;

&lt;?php
echo $_SERVER['HTTP_USER_AGENT'] . "\n\n";

$browser = get_browser(null, true);
print_r($browser);
?&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Next, save the file and exit <code>nano</code>.
In your browser, visit your external IP address site:</p>
<pre><code>http://55.333.55.333/
</code></pre>
<p>Although your <code>index.html</code> file still exists in your document root, Apache2 now returns the <strong>index.php</strong> file instead.
However, if for some reason the <code>index.php</code> was deleted, then Apache2 would revert to the <code>index.html</code> file
since that's listed next in the <code>dir.conf</code> <code>DirectoryIndex</code> line.</p>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>In this section, we installed PHP and configured it work with Apache2.
We also created a simple PHP test page that reported our browser user agent information on our website.</p>
<p>In the next section, we'll learn how to complete the LAMP stack by adding the MariaDB relational database to our setup.
By adding a relational database, we will be able to pull data from the database and present it in the browser based on user actions.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="7a-installing-the-apache-web-server.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="7c-installing-configuring-mariadb.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="7a-installing-the-apache-web-server.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="7c-installing-configuring-mariadb.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
