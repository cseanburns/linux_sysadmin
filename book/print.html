<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Linux Systems Administration</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Entry level book on Linux systems administration.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="p1-linux-sysadmin.html"><strong aria-hidden="true">1.</strong> Linux Systems Administration</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="01-history-linux-unix.html"><strong aria-hidden="true">1.1.</strong> History of Unix and Linux</a></li><li class="chapter-item expanded "><a href="02-what-is-linux.html"><strong aria-hidden="true">1.2.</strong> What is Linux?</a></li><li class="chapter-item expanded "><a href="03-what-is-sysadmin.html"><strong aria-hidden="true">1.3.</strong> What is Systems Administration?</a></li></ol></li><li class="chapter-item expanded "><a href="p2-using-gcloud.html"><strong aria-hidden="true">2.</strong> Using Google Cloud (gcloud)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="05-using-gcloud-virtual-machines.html"><strong aria-hidden="true">2.1.</strong> Using gcloud for Virtual Machines</a></li></ol></li><li class="chapter-item expanded "><a href="p3-the-command-line.html"><strong aria-hidden="true">3.</strong> Learning the Command Line</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="06-the-linux-filesystem.html"><strong aria-hidden="true">3.1.</strong> The Linux Filesystem</a></li><li class="chapter-item expanded "><a href="07-files-and-directories.html"><strong aria-hidden="true">3.2.</strong> Files and Directories</a></li><li class="chapter-item expanded "><a href="08-file-attributes.html"><strong aria-hidden="true">3.3.</strong> File Attributes</a></li><li class="chapter-item expanded "><a href="09-text-processing-part-1.html"><strong aria-hidden="true">3.4.</strong> Text Processing: Part 1</a></li><li class="chapter-item expanded "><a href="10-text-processing-part-2.html"><strong aria-hidden="true">3.5.</strong> Text Processing: Part 2</a></li><li class="chapter-item expanded "><a href="11-review.html"><strong aria-hidden="true">3.6.</strong> Review</a></li></ol></li><li class="chapter-item expanded "><a href="p4-scripting-the-command-line.html"><strong aria-hidden="true">4.</strong> Scripting the Command Line</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="12-text-editors.html"><strong aria-hidden="true">4.1.</strong> Text Editors</a></li><li class="chapter-item expanded "><a href="13-regular-expressions.html"><strong aria-hidden="true">4.2.</strong> Regular Expressions</a></li><li class="chapter-item expanded "><a href="14-bash-scripting.html"><strong aria-hidden="true">4.3.</strong> Bash Scripting</a></li></ol></li><li class="chapter-item expanded "><a href="p5-managing-the-system.html"><strong aria-hidden="true">5.</strong> Managing the System</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="15-expanding-storage.html"><strong aria-hidden="true">5.1.</strong> Expanding Storage</a></li><li class="chapter-item expanded "><a href="16-managing-users-groups.html"><strong aria-hidden="true">5.2.</strong> Managing Users and Groups</a></li><li class="chapter-item expanded "><a href="17-managing-software.html"><strong aria-hidden="true">5.3.</strong> Managing Software</a></li><li class="chapter-item expanded "><a href="18-using-systemd.html"><strong aria-hidden="true">5.4.</strong> Using systemd</a></li></ol></li><li class="chapter-item expanded "><a href="p6-networking-security.html"><strong aria-hidden="true">6.</strong> Networking and Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="19-networking-tcpip.html"><strong aria-hidden="true">6.1.</strong> Networking and TCP/IP</a></li><li class="chapter-item expanded "><a href="20-dns-domain-names.html"><strong aria-hidden="true">6.2.</strong> DNS and Domain Names</a></li><li class="chapter-item expanded "><a href="21-local-security.html"><strong aria-hidden="true">6.3.</strong> Local Security</a></li><li class="chapter-item expanded "><a href="22-firewall-backups.html"><strong aria-hidden="true">6.4.</strong> Firewalls and Backups</a></li></ol></li><li class="chapter-item expanded "><a href="p7-creating-a-lamp-server.html"><strong aria-hidden="true">7.</strong> Creating a LAMP Server</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="23-installing-the-apache-web-server.html"><strong aria-hidden="true">7.1.</strong> Installing the Apache Web Server</a></li><li class="chapter-item expanded "><a href="24-installing-configuring-php.html"><strong aria-hidden="true">7.2.</strong> Installing and Configuring PHP</a></li><li class="chapter-item expanded "><a href="25-installing-configuring-mariadb.html"><strong aria-hidden="true">7.3.</strong> Installing and Configuring MariaDB</a></li></ol></li><li class="chapter-item expanded "><a href="p8-conclusion.html"><strong aria-hidden="true">8.</strong> Conclusion</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Linux Systems Administration</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/cseanburns/linux_sysadmin" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="linux-systems-administration"><a class="header" href="#linux-systems-administration">Linux Systems Administration</a></h1>
<p>Author: C. Sean Burns<br />
Date: 2022-08-12<br />
Email: <a href="sean.burns@uky.edu">sean.burns@uky.edu</a><br />
Website: <a href="https://cseanburns.net">cseanburns.net</a><br />
GitHub: <a href="https://github.com/cseanburns">@cseanburns</a></p>
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>This short book was written for my
Linux Systems Administration course.
The book and course's goals are to
provide the very basics about systems
administration using Linux, and
to teach students:</p>
<ol>
<li>how to use the command line in order to become more efficient computer users
and more comfortable with using computers in general;</li>
<li>how to use command line utilities and programs and to learn what can be
accomplished using those programs;</li>
<li>how to administer users and manage software on a Linux server;</li>
<li>how to secure a Linux server; and</li>
<li>the basics of cloud computing;</li>
</ol>
<p>And finally, this book/course ends on walking students
through the process of building a <a href="https://en.wikipedia.org/wiki/LAMP_(software_bundle)">LAMP stack</a>.</p>
<h2 id="about-this-book"><a class="header" href="#about-this-book">About This Book</a></h2>
<p>Since I use this book for my Linux Systems Administration course,
which I teach each fall semester,
this book will be a live document.
I will update the content as I teach it in order
to address changes in the technology and to
edit for clarity when I discover some aspect
of the book causes confusion or
does not provide enough information.</p>
<p>This book is not a
comprehensive introduction to Linux nor
to systems administration.
It is designed for an entry level course on these topics and
is focused on a select and small range of those topics that
have specific pedagogical aims (see above).</p>
<p>The book started off as a series of transcripts and
demonstrations.
It still has that focus, but
I've had a long-term goal to make these transcripts
more cohesive.
Achieving this became easier when I learned about
<a href="https://github.com/rust-lang/mdBook">mdBook</a>.</p>
<p>The content in this book is open access and
licensed under the <a href="https://github.com/cseanburns/linux_sysadmin/blob/master/LICENSE">GNU GPL v3.0</a>.
Feel free to fork it on <a href="https://github.com/cseanburns/linux_sysadmin">GitHub</a> and
modify it for your own needs.</p>
<h2 id="history-of-this-course"><a class="header" href="#history-of-this-course">History of This Course</a></h2>
<p>I created and started teaching this course in the Fall 2016 semester.
I originally used Soyinka's (2016) excellent
introduction to Linux administration, and
we used VirtualBox and the Fedora Server distribution
to practice and learn the material.</p>
<p>However, around 2018 or '19,
I moved away from Soyinka's comprehensive book to
focus the material on a more limited range of topics.
I did this for two reasons.
First, most of my students do not
become systems administrators,
although some have (to my delight).
Second, my students have grown up using only
graphical user interfaces on one of the two common,
commercial operating systems, and
consequently have very constrained and limited understandings
of how computers work and what can be done with them.
In redesigning this course,
I wanted to strike a balance between these two problems.
I wanted students to acquire enough skills and
gain enough confidence to feel comfortable applying for 
(at least) entry level systems administrator jobs, and
more basically,
I wanted students to be exposed to a different
type of computing environment than what they were used to
and that fostered a hacking mentality,
<a href="http://www.catb.org/jargon/html/H/hacker.html">in the more benign and playful sense of the word</a>.</p>
<p>I moved us away from using
Fedora Server for the Fall 2022 course.
Fedora Server is a great and fun operating system, and
there's a lot to learn about Linux using it.
However, since it is rather bleeding edge, it 
meant something would break in my demonstrations each semester, and
identifying what had changed in Fedora
each year made it somewhat of a chore to keep up.
I have therefore switched to a less bleeding edge
distribution of Linux: a still supported
<a href="https://ubuntu.com/blog/what-is-an-ubuntu-lts-release">Ubuntu Server LTS release</a>.
Based on my personal experience managing servers
that run on some version of Ubuntu LTS,
I believe this should provide more stability.
It helps that Ubuntu Server has a good share of the
Linux server market.</p>
<p>The primary reason I moved us away from VirtualBox is because 
a good number of my students each year use Apple computers, which
became a major obstacle when
<a href="https://apple.stackexchange.com/questions/422565/does-virtualbox-run-on-apple-silicon">Apple switched to the M1 chip</a>.
I originally considered asking those students
to use different virtualization software, but
it was nice to have all students,
regardless of operating system, and myself using the
same software.
I also considered using something like <a href="https://www.docker.com/">Docker</a>
as a replacement, but
decided instead to use Google Cloud.
I figured that learning how to use a
service like Google Cloud might be more broadly useful
to students, and
that if we used Docker,
we'd have to spend a lot of time installing and
configuring that on their laptops.
Time is already a constraint in this course, but
we'll see how it goes this semester (Fall 2022).</p>
<h2 id="references"><a class="header" href="#references">References</a></h2>
<p>Soyinka, W. (2016). <em>Linux administration: A beginner's guide</em> (7th ed.). New
York: MacGraw Hill Education. ISBN: 978-0-07-184536-6</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="history-of-unix-and-linux"><a class="header" href="#history-of-unix-and-linux">History of Unix and Linux</a></h1>
<p>An outline of the history of Unix and Linux.</p>
<h2 id="location-bell-labs-part-of-att-new-jersey-late-1960s-through-early-1970s"><a class="header" href="#location-bell-labs-part-of-att-new-jersey-late-1960s-through-early-1970s">Location: Bell Labs, part of AT&amp;T (New Jersey), late 1960s through early 1970s</a></h2>
<ul>
<li>Starts with an operating system called Multics.</li>
<li>Multics was a time sharing system
<ul>
<li>That is, more than one person could use it at once.</li>
</ul>
</li>
<li>But Multics had issues and was slowly abandoned</li>
<li><a href="http://cs.bell-labs.co/who/ken/">Ken Thompson</a> found an old PDP-7. Started to write UNIX.
<ul>
<li>The <a href="https://en.wikipedia.org/wiki/Ed_(text_editor)">ed</a> line editor was written.</li>
<li>Pronounced e.d. but generally sounded out.</li>
</ul>
</li>
<li>This version of UNIX would later be referred to as <em>Research Unix</em></li>
<li><a href="https://www.bell-labs.com/usr/dmr/www/">Dennis Ritchie</a>, the creator of the C programming language,
joined Thompson's efforts.</li>
</ul>
<h2 id="location-berkeley-ca-university-of-california-berkeley-early-to-mid-1970s"><a class="header" href="#location-berkeley-ca-university-of-california-berkeley-early-to-mid-1970s">Location: Berkeley, CA (University of California, Berkeley), early to mid 1970s</a></h2>
<ul>
<li>The code for UNIX was not 'free software'
but low cost and easily shared.</li>
<li>Ken Thompson visited Berkeley and helped install <a href="https://en.wikipedia.org/wiki/Berkeley_Software_Distribution">Version 6 of UNIX</a></li>
<li><a href="https://en.wikipedia.org/wiki/Bill_Joy">Bill Joy</a> and others contributed heavily
<ul>
<li>Joy created the <a href="https://sites.google.com/a/bostic.com/keithbostic/vi/">vi</a> text editor,
a descendant of the popular <a href="https://www.vim.org/">Vim</a> editor,
many other important programs, and was a co-founder of Sun Microsystems</li>
</ul>
</li>
<li>This installation of UNIX would eventually become known
as the Berkeley Software Distribution, or BSD.</li>
</ul>
<h2 id="att"><a class="header" href="#att">AT&amp;T</a></h2>
<ul>
<li>Until its breakup in 1984,
AT&amp;T was not allowed to profit off patents
that were not directly related to its telecommunications businesses.</li>
<li>This agreement with the US government helped
protect the company from monopolistic charges,
and as a result, they could not commercialize UNIX.</li>
<li>This changed after the breakup.
System V UNIX became the standard bearer of commercial UNIX.</li>
</ul>
<h2 id="location-boston-ma-mit-early-1980s-through-early-1990s"><a class="header" href="#location-boston-ma-mit-early-1980s-through-early-1990s">Location: Boston, MA (MIT), early 1980s through early 1990s</a></h2>
<ul>
<li>In the late 1970s, <a href="https://en.wikipedia.org/wiki/Richard_Stallman">Richard Stallman</a> noticed
that software began to become commercialized.
<ul>
<li>As a result, hardware vendors stopped sharing
the code they developed to make their hardware work.</li>
</ul>
</li>
<li>Software code became eligible for copyright protection with
the Copyright Act of 1976</li>
<li>Stallman, who thrived in a <em>hacker culture</em>,
began to battle against this turn of events.</li>
<li>Stallman created the <a href="https://www.gnu.org/gnu/gnu.html">GNU project</a>,
the free software philosophy, GNU Emacs,
a popular and important text editor,
and he wrote many other programs.</li>
<li>The GNU project is an attempt to create a completely
<strong>free software</strong> operating system,
that was Unix-like, called GNU.</li>
<li>By the early 1990s, Stallman and others had developed
all the utilities needed to have a full operating system,
except for a kernel, which they called <a href="https://www.gnu.org/software/hurd/">GNU Hurd</a>.</li>
<li>This included the Bash shell, written by <a href="https://opuslogica.com/">Brian Fox</a>.</li>
<li>The GNU philosophy includes several propositions
that define free software:</li>
</ul>
<blockquote>
<p>The four freedoms, per GNU Project:
0. The freedom to run the program as you wish,
for any purpose (freedom 0).</p>
<ol>
<li>The freedom to study how the program works,
and change it so it does your computing as you wish (freedom 1).
Access to the source code is a precondition for this.</li>
<li>The freedom to redistribute copies so you can help others (freedom 2).</li>
<li>The freedom to distribute copies of your modified
versions to others (freedom 3).
By doing this you can give the whole community a chance
to benefit from your changes.
Access to the source code is a precondition for this.</li>
</ol>
</blockquote>
<p><a href="https://www.gnu.org/philosophy/free-sw.html">The Four Freedoms</a></p>
<h2 id="the-unix-wars-and-the-lawsuit-late-1980s-through-the-early-1990s"><a class="header" href="#the-unix-wars-and-the-lawsuit-late-1980s-through-the-early-1990s">The Unix wars and the lawsuit, late 1980s through the early 1990s</a></h2>
<ul>
<li>AT&amp;T, after its breakup, began to commercialize Unix,
and differences in AT&amp;T Unix and BSD Unix arose.</li>
<li>The former was aimed at commercialization,
and the latter aimed at researchers and academics.</li>
<li>UNIX Systems Laboratories, Inc. (USL, part of AT&amp;T)
sued Berkeley Software Design, Inc.
(BSDi, part of the University of California, Berkeley)
for copyright and trademark violations.</li>
<li>USL ultimately lost the case,
but the lawsuit delayed adoption of BSD Unix.</li>
</ul>
<h2 id="linux-linus-torvalds-university-of-helsinki-finland-early-1990s"><a class="header" href="#linux-linus-torvalds-university-of-helsinki-finland-early-1990s">Linux, Linus Torvalds, University of Helsinki, Finland, early 1990s</a></h2>
<ul>
<li>On August 25, 1991, <a href="https://www.cs.helsinki.fi/u/torvalds/">Linus Torvalds</a>
announced that he had started working on a <strong>free</strong>
operating system kernel for the 386 CPU architecture
and for his specific hardware.</li>
<li>This <a href="https://www.kernel.org/">kernel</a> would later be named <strong>Linux</strong>.</li>
<li>Linux technically refers only to the kernel.
<ul>
<li>An operating system kernel handles startup,
devices, memory, resources, etc.</li>
<li>A kernel does not provide user land utilities---the
kinds of software they people use when using computers.</li>
</ul>
</li>
<li>Torvalds' motivation was to learn about OS development
but also to have access to a Unix-like system.
<ul>
<li>He already had access to an Unix-like system
called <a href="https://www.minix3.org/">MINIX</a>,
but MINIX had technical and copyright restrictions.</li>
</ul>
</li>
<li>Torvalds has stated that if a BSD or
if GNU Hurd operating system were available,
then he may not have created the Linux kernel.</li>
<li>But Torvalds and others took the GNU utilities
and created what is now called Linux or GNU/Linux.</li>
</ul>
<h2 id="distributions-early-1990s-through-today"><a class="header" href="#distributions-early-1990s-through-today">Distributions, early 1990s through today</a></h2>
<ul>
<li>Soon after the Linux development,
people would create their own Linux and
GNU based operating systems and would distribute them.</li>
<li>As such, these Linux operating systems became 
referred to as <em>distributions</em>.</li>
<li>The two oldest distributions that are still in 
active development include:
<ul>
<li><a href="http://www.slackware.com/">Slackware</a></li>
<li><a href="https://www.debian.org/">Debian</a></li>
</ul>
</li>
</ul>
<h2 id="short-history-of-bsd-1970s-through-today"><a class="header" href="#short-history-of-bsd-1970s-through-today">Short History of BSD, 1970s through today</a></h2>
<ul>
<li>Unix version numbers 1-6 eventually led to BSD 1-4.</li>
<li>At BSD 4.3, all versions had some AT&amp;T code.
<ul>
<li>Desire to remove this code led to BSD Net/1.</li>
</ul>
</li>
<li>All AT&amp;T code was removed by BSD Net/2.</li>
<li>BSD Net/2 was ported to the Intel 386 processor.
<ul>
<li>This became 386BSD and was made available in 1992,
a year after the Linux kernel was released.</li>
</ul>
</li>
<li>386BSD split into two projects:
<ul>
<li><a href="https://www.netbsd.org/">NetBSD</a></li>
<li><a href="https://www.freebsd.org/">FreeBSD</a></li>
</ul>
</li>
<li>NetBSD split into another project: <a href="https://www.openbsd.org/">OpenBSD</a>.</li>
<li>All three of these BSDs are still in active development.</li>
<li>From a bird's eye point of view, they each have different focuses:
<ul>
<li>NetBSD focuses on portability (MacOS, NASA)</li>
<li>FreeBSD focuses on wide applicability 
(WhatsApp, Netflix, PlayStation 4, MacOS)</li>
<li>OpenBSD focuses on security 
(has contributed a number of very important applications)</li>
</ul>
</li>
</ul>
<blockquote>
<p>MacOS is based on <a href="http://www.puredarwin.org/">Darwin</a>,
is <a href="https://www.opengroup.org/membership/forums/platform/unix">technically UNIX</a>, and is
partly based on FreeBSD with some code
coming from the other BSDs.
See <a href="https://apple.stackexchange.com/questions/401832/why-is-macos-often-referred-to-as-darwin">Why is macOS often referred to as 'Darwin'?</a>
for a short history.</p>
</blockquote>
<h2 id="short-history-of-gnu-1980s-through-today"><a class="header" href="#short-history-of-gnu-1980s-through-today">Short History of GNU, 1980s through today</a></h2>
<ul>
<li>The GNU Hurd is still under active development,
but it's the pre-production state.</li>
<li>The last release was 0.9 on December 2016.</li>
<li>A complete OS based on the GNU Hurd can be downloaded and ran.
For example: <a href="https://www.debian.org/ports/hurd/">Debian GNU/Hurd</a></li>
</ul>
<h2 id="free-and-open-source-licenses"><a class="header" href="#free-and-open-source-licenses">Free and Open Source Licenses</a></h2>
<p>In the free software and open source landscape,
there are several important free and/or open source
licenses that are used.
The two biggest software licenses are
based on the software used by GNU/Linux
and the software based on the BSDs.
They each take very different approaches to free
and/or open source software.
The biggest difference is this:</p>
<ul>
<li>Software based on software licensed under the GPL
must also be licensed under the GPL.
This is referred to as <a href="https://www.gnu.org/licenses/copyleft.en.html">copyleft</a> software,
and the idea is to propagate free software.
<ul>
<li><a href="https://www.gnu.org/licenses/gpl-3.0.en.html">GNU General Public License (GPL)</a></li>
</ul>
</li>
<li>Software based on software licensed under the BSD
license may be closed source and
primarily must only attribute the original source code and author.
<ul>
<li><a href="https://opensource.org/licenses/BSD-3-Clause">BSD License</a></li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="what-is-linux"><a class="header" href="#what-is-linux">What is Linux?</a></h1>
<h2 id="the-linux-kernel"><a class="header" href="#the-linux-kernel">The Linux Kernel</a></h2>
<p>Technically, <a href="https://kernel.org/">Linux is a kernel</a>, and
a kernel is a part of an operating system that
oversees CPU activity like multitasking, as well as networking,
memory management, device management, file systems, and more.
The kernel alone does not make an operating system.
It needs user land applications and programs,
the kind we use on a daily basis, to form a whole,
as well as ways for these user land utilities to
interact with the kernel.</p>
<h2 id="linux-and-gnu"><a class="header" href="#linux-and-gnu">Linux and GNU</a></h2>
<p>The earliest versions of the Linux kernel were combined
with tools, utilities, and programs from the <a href="https://www.gnu.org/software/software.html">GNU project</a>
to form a complete operating system,
without necessarily a graphical user interface.
This association continues to this day.
Additional non-GNU, but
free and open source programs under different licenses,
have been added to form a more functional and user friendly system.
However, since the Linux kernel needs user land applications
to form an operating system, and
since user land applications from GNU cannot work without a kernel,
some argue that the operating system
should be called <a href="https://en.wikipedia.org/wiki/GNU/Linux_naming_controversy">GNU/Linux</a>
and not just Linux.
This has not gained wide acceptance, though.
Regardless, credit is due to both camps for their contribution,
as well as many others who have made substantial contributions
to the operating system.</p>
<h2 id="linux-uses"><a class="header" href="#linux-uses">Linux Uses</a></h2>
<p>We are using Linux as a server in this course, which
means we will use Linux to provide various services.
Our first focus is to learn to use Linux itself, but
by the end of the course,
we will also learn how to provide web and database services.
Linux can be used to provide <a href="https://en.wikipedia.org/wiki/Server_(computing)">other services</a> that
we won't cover in this course, such as:</p>
<ul>
<li>file servers</li>
<li>mail servers</li>
<li>print servers</li>
<li>game servers</li>
<li>computing servers</li>
</ul>
<p>Although it's a small overall percentage,
many people use Linux as their main
desktop/laptop operating system.
I belong in this camp.
Linux has been my main OS since the early 2000s.
While our work on the Linux server means that we will
almost entirely work on the command line,
this does not mean that my Linux
desktop environment is all command line.
In fact, there are many graphical user environments,
often called <a href="https://en.wikipedia.org/wiki/Desktop_environment">desktop environments</a>,
available to Linux users.
Since I'm currently using the Ubuntu Desktop distribution,
my default desktop environment is called <a href="https://www.gnome.org/">Gnome</a>.
<a href="https://kde.org/">KDE</a> is another popular desktop environment, but
there are many other attractive and useful ones.
And it's easy to install and switch between
multiple ones on the same OS.</p>
<p>Linux has become quite a pervasive operating system.
Linux powers the hundreds of the
fastest supercomputers in the world.
It, or other Unix-like operating systems,
are the foundation of most web servers.
The Linux kernel also forms the basis of the Android
operating system and of Chrome OS.
The only place where Linux does not dominate is
in the desktop/laptop space.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="what-is-systems-administration"><a class="header" href="#what-is-systems-administration">What is Systems Administration?</a></h1>
<h2 id="introduction-1"><a class="header" href="#introduction-1">Introduction</a></h2>
<p>What is systems administration or
who is a systems administrator (or <strong>sysadmin</strong>)?
Let's start off with some definitions provided by
the <a href="https://www.nist.gov/">National Institute of Standards and Technology</a>:</p>
<blockquote>
<p>An individual, group, or organization responsible for setting up and
maintaining a system or specific system elements, implements approved secure
baseline configurations, incorporates secure configuration settings for IT
products, and conducts/assists with configuration monitoring activities as
needed.</p>
</blockquote>
<p>Or:</p>
<blockquote>
<p>Individual or group responsible for overseeing the day-to-day operability of a
computer system or network. This position normally carries special privileges
including access to the protection state and software of a system.</p>
</blockquote>
<p>See: <a href="https://csrc.nist.gov/glossary/term/system_administrator">Systems Administrator @NIST</a></p>
<h2 id="specialized-positions"><a class="header" href="#specialized-positions">Specialized Positions</a></h2>
<p>In addition to the above definitions,
which broadly define the role,
there are a number of related or specialized positions.
We'll touch on the first three in this course:</p>
<ul>
<li>Web server administrator:
<ul>
<li>&quot;web server administrators are system architects responsible for the
overall design, implementation, and maintenance of Web servers. They may or
may not be responsible for Web content, which is traditionally the
responsibility of the Webmaster (<a href="https://csrc.nist.gov/glossary/term/web_server_administrator">Web Server Administrator&quot;
@NIST</a>).</li>
</ul>
</li>
<li>Database administrator:
<ul>
<li>like web admins, and to paraphrase above, database administrators are system
architects responsible for the overall design, implementation, and
maintenance of database management systems. </li>
</ul>
</li>
<li>Network administrator:
<ul>
<li>&quot;a person who manages a network within an organization. Responsibilities
include network security, installing new applications, distributing software
upgrades, monitoring daily activity, enforcing licensing agreements,
developing a storage management program, and providing for routine backups&quot;
(<a href="https://csrc.nist.gov/glossary/term/network_administrator">Network Administrator @NIST</a>).</li>
</ul>
</li>
<li>Mail server administrator:
<ul>
<li>&quot;mail server administrators are system architects responsible for the
overall design and implementation of mail servers&quot; (<a href="https://csrc.nist.gov/glossary/term/mail_server_administrator">Mail Server
Administrators @NIST</a>).</li>
</ul>
</li>
</ul>
<p>Depending on where a system administrator works,
they may specialize in any of the above administrative areas, or
if they work for a small organization,
all of the above duties may be rolled into one position.
Some of the positions have evolved quite a bit over the last
couple of decades.
For example, it wasn't too long ago when organizations would
operate their own mail servers, but
this has largely been outsourced to third-party providers,
such as Google (via Gmail) and Microsoft (via Outlook).
People are still needed to work with these
third-party email providers, but
the nature of the work is different than operating
independent mail servers.</p>
<h2 id="certifications"><a class="header" href="#certifications">Certifications</a></h2>
<p>It's not always necessary to get certified
as a systems administrator to get work as one, but
there might be cases where it is necessary; for example,
in government positions or in large corporations.
It also might be the case that you can get work
as an entry level systems administrator and
then pursue certification with
the support of your organization.</p>
<p>Some common starting certifications are:</p>
<ul>
<li><a href="https://www.redhat.com/en/services/certification/rhcsa">Red Hat Certified System Administrator (RHCSA)</a></li>
<li><a href="https://www.comptia.org/certifications/server">CompTIA Server+</a></li>
<li><a href="https://www.comptia.org/certifications/a">CompTIA A+</a></li>
</ul>
<p>Plus, Google offers, via <a href="https://www.coursera.org/">Coursera</a>, a
beginners <a href="https://www.coursera.org/professional-certificates/google-it-support">Google IT Support Professional Certificate</a>
that may be helpful.</p>
<h2 id="associations"><a class="header" href="#associations">Associations</a></h2>
<p>Getting involved in associations and related
organizations is a great way to learn and
to connect with others in the field.
Here are few ways to connect.</p>
<p><a href="https://lopsa.org/AboutLOPSA">LOPSA</a>, or
The League of Professional System Administrators,
is a non-profit association that seeks to advance
the field and membership is free for students.</p>
<p><a href="https://www.acm.org/">ACM</a>, or the Association for Computing Machinery,
has a number of relevant
<a href="https://www.acm.org/special-interest-groups/alphabetical-listing">special interest groups (SIGs)</a>
that might be beneficial to systems administrators. </p>
<p><a href="http://www.npa.org/">NPA</a>, or the Network Professional Association,
is an organization that &quot;supports IT/Network 
professionals.&quot;</p>
<h2 id="codes-of-ethics"><a class="header" href="#codes-of-ethics">Codes of Ethics</a></h2>
<p>Systems administrators manage computer systems
that contain a lot of data about us and
this raises privacy and competency issues,
which is why some have created code of ethics statements.
Both LOPSA and NPA have created such statements
that are well worth reviewing and discussing.</p>
<ul>
<li>LOPSA: <a href="https://lopsa.org/CodeOfEthics">Code of Ethics</a></li>
<li>NPA: <a href="https://www.npa.org/public/about_codeofethics.cfm">Code of Ethics</a></li>
</ul>
<h2 id="keeping-up"><a class="header" href="#keeping-up">Keeping Up</a></h2>
<p>Technology changes fast.
In fact, even though I teach this course
about every year,
I need to revise the
course each time, sometimes substantially,
to reflect changes that have developed
over short periods of time.
It's also your responsibility,
as sysadmins,
to keep up, too.</p>
<p>I therefore suggest that you continue your
education by reading and practicing.
For example, there are lots of books on 
systems administration.
<a href="https://www.npa.org/public/about_codeofethics.cfm">O'Reilly</a> continually
publishes on the topic.
RedHat,
the makers of the Red Hat Linux distribution,
and sponsors of <a href="https://www.linuxjournal.com/">Fedora Linux</a> and
<a href="https://centos.org/">CentOS Linux</a>,
provides the <a href="https://www.redhat.com/sysadmin/">Enable Sysadmin</a> site,
with new articles each day,
authored by systems administrators,
on the field.
Opensource.com, also supported by Red Hat,
<a href="https://opensource.com/tags/sysadmin">publishes articles on systems administration</a>.
<a href="https://www.redhat.com/en/command-line-heroes">Command Line Heroes</a> is a fun and
informative podcast on technology and
sysadmin related topics.
<a href="https://www.linuxjournal.com/">Linux Journal</a> publishes great articles
on Linux related topics.</p>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>In this section I provided definitions of systems administrators
and also the related or more specialized positions,
such as database administrator, network administrator,
and others.</p>
<p>I provided links to various certifications you might
pursue as a systems administrator, and
links to associations that might benefit you and your career.</p>
<p>Technology manages so much of our daily lives, and
computer systems store lots of data about us.
Since systems administrators manage these systems,
they hold a great amount of responsibility
to protect them and our data.
Therefore, I provided links to two code of ethics
statements that we will discuss.</p>
<p>It's also important to keep up with the technology,
which changes fast.
The work of a systems administrator is much different
today than it was ten or twenty years ago, and
that surely indicates that it could be much different in
another ten to twenty years.
If we don't keep up,
we won't be of much use to the people we serve.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-google-cloud-gcloud"><a class="header" href="#using-google-cloud-gcloud">Using Google Cloud (gcloud)</a></h1>
<p>This section introduces us to <a href="https://cloud.google.com">Google Cloud</a> (gcloud).
We will use this platform to create virtual
instances of the Ubuntu Server Linux operating system.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-gcloud-for-virtual-machines"><a class="header" href="#using-gcloud-for-virtual-machines">Using gcloud for Virtual Machines</a></h1>
<h2 id="virtual-machines"><a class="header" href="#virtual-machines">Virtual Machines</a></h2>
<p>Our goal in this section 
is to create a <strong>virtual machine (VM)</strong> <em>instance</em>.
A VM is basically a virtualized operating system
that runs on a host operating system.
That host operating system may also be Linux,
but it could be Windows or macOS.
In short,
when we use virtual machines,
it means instead of installing an operating system
(like Linux, macOS, Windows, etc) on a physical machine,
we use virtual machine software to mimic the process.
The virtual machine, thus, runs on top of our main OS.
It's like an app, where the app is a fully functioning
operating system.</p>
<p>In past semesters of this course,
we used <a href="https://www.virtualbox.org/">VirtualBox</a> to create
virtual machines with Linux as the virtual operating system.
This worked despite whether you or I were running
Windows, macOS, or Linux as our main operating systems.
VirtualBox is freely available virtualization software,
and using it let students and myself
run Linux as a server
on our own desktops and laptops without changing
the underlying OS on those machines
(e.g., Windows, macOS).</p>
<p>However, even though we virtualize an operating
system when we run a VM,
the underlying operating system and CPU architecture
is still important.
When Apple, Inc launched their new M1 
(ARM-based) chip in 2020,
it created problems for running non ARM-based operating
systems as virtual machines (i.e., x86_64 chips).</p>
<p>Fortunately, we are able to solve that issue
using a third-party virtualization platform.
In this course, that means we're going to use gcloud (via Google),
but there are other options available that you 
can explore on your own.</p>
<h2 id="google-cloud--gcloud"><a class="header" href="#google-cloud--gcloud">Google Cloud / gcloud</a></h2>
<h3 id="google-account"><a class="header" href="#google-account">Google Account</a></h3>
<p>We need to have a Google account to get started with gcloud.
I imagine most of you already have a Google account,
but if not, go ahead and create one at <a href="https://www.google.com">https://www.google.com</a>.</p>
<h3 id="google-cloud-gcloud-project"><a class="header" href="#google-cloud-gcloud-project">Google Cloud (gcloud) Project</a></h3>
<p>Next, you need to use gcloud
to create a Google Cloud project.
Once you've created that project,
you can enable billing for that project,
and then install the gcloud software 
on your local machine.</p>
<p>Follow <strong>Step 1</strong> at the top of the 
<strong><a href="https://cloud.google.com/sdk/docs/install-sdk">Install the gcloud CLI</a></strong> page
to in create a new project.
Also, review the page on
<a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects#gcloud">creating and managing projects</a>.</p>
<p>When you create your project, you can name it anything,
but try to name it something to do with this course.
E.g., I am using the name <strong>sysadmin-418</strong>.
<strong>Avoid using spaces when naming your project.</strong></p>
<p>Then click on the <strong>Create</strong> button,
and leave the organization field set to <strong>No Organization</strong>.</p>
<h3 id="google-billing"><a class="header" href="#google-billing">Google Billing</a></h3>
<p>The second thing to do is to set up
a billing account for your gcloud project.
This does mean there is a cost associated
with this product, but
the good news is that our bills by the end of the semester should
only amount to a couple of dollars, at most.
<strong><a href="https://cloud.google.com/sdk/docs/install-sdk">Follow Step 2</a></strong> to enable
billing for your new project.
See also the page on how to
<strong><a href="https://cloud.google.com/billing/docs/how-to/manage-billing-account">create, modify, or close your self-serve Cloud Billing account</a></strong></p>
<h3 id="install-the-latest-gcloud-cli-version"><a class="header" href="#install-the-latest-gcloud-cli-version">Install the latest gcloud CLI version</a></h3>
<p>After you have set up billing,
the next step is to install gcloud on your local machines. 
The <strong><a href="https://cloud.google.com/sdk/docs/install-sdk">Install the gcloud CLI</a></strong> page
provides instructions for different operating systems.</p>
<p>There are installation instructions
for macOS, Windows, Chromebooks, and various Linux distributions.
Follow these instructions closely for the operating system
that you're using.
Note that for macOS,
you have to choose among three different CPU/chip
architectures.
If you have an older macOS machine (before November 2020 or so),
it's likely that you'll select <strong>macOS 64-bit (x86_64)</strong>.
If you have a newer macOS machine,
then it's likely you'll have to select <strong>macOS 64-bit (arm64, Apple M1
silicon).</strong>
It's unlikely that any of you are using a 32-bit macOS operating system.
If you're not sure which macOS system you have,
then let me know and I can help you determine the appropriate platform.
Alternatively, follow these instructions to find your processor information:</p>
<ul>
<li>click on the Apple menu</li>
<li>choose <strong>About This Mac</strong></li>
<li>locate the <strong>Processor</strong> or <strong>Chip</strong> information</li>
</ul>
<p>After you have downloaded the gcloud CLI
for your particular OS and CPU architecture,
you will need to open a command prompt/terminal
on your machines to complete the instructions
the describe how to install the gcloud CLI.
macOS uses the Terminal app,
which can located using Spotlight.
Windows user can use Command.exe,
which can be located by search also.</p>
<p>Windows users will download a regular <strong>.exe</strong> file,
but macOS users will download a <strong>.tar.gz</strong> file.
Since macOS is Unix, you can use the <code>mv</code> command to 
move that file to your <code>$HOME</code> directory.
Then you extract it there using the <code>tar</code> command,
and once extracted
you can change to the directory that it
creates with the <code>cd</code> command.
For example, if you are downloading the X86_64 version
of the gcloud CLI, then you would run the following commands:</p>
<pre><code>mv google-cloud-cli-392.0.0-darwin-x86_64.tar.gz $HOME
tar -xzf google-cloud-cli-392.0.0-darwin-x86_64.tar.gz
cd google-cloud-sdk
</code></pre>
<p>Modify the above commands, as appropriate,
if you're using the M1 version
of the gcloud CLI.</p>
<h3 id="initializing-the-gcloud-cli"><a class="header" href="#initializing-the-gcloud-cli">Initializing the gcloud CLI</a></h3>
<p>Once you have downloaded and installed
the gcloud CLI program,
you need to initialize it on your local machine.
Scroll down on the <a href="https://cloud.google.com/sdk/docs/install-sdk">install page</a>
to the section titled
<strong>Initializing the gcloud CLI</strong>.
In your terminal/command prompt,
run the initialization command,
per the instructions at the above page:</p>
<pre><code>gcloud init
</code></pre>
<p>And continue to follow the above instructions.</p>
<h2 id="gcloud-vm-instance"><a class="header" href="#gcloud-vm-instance">gcloud VM Instance</a></h2>
<p>Once you've initialized gcloud,
log into <a href="https://console.cloud.google.com/">Google Cloud Console</a>,
which should take you to the Dashboard page.</p>
<p>Our first goal is to create a <strong>virtual machine (VM)</strong> <em>instance</em>.
As a reminder,
a VM is basically a virtualized operating system.
That means instead of installing an operating system
(like Linux, macOS, Windows, etc) on a physical machine,
software is used to mimic the process. </p>
<p>gcloud offers a number of Linux-based operating systems
to create VMs.
We're going to use the Ubuntu operating system
and specifically the Ubuntu 20.04 LTS version.</p>
<blockquote>
<p>Ubuntu is a Linux distribution.
A new version of Ubuntu is released every six months.
The 20.04 signifies that this is the April 2020 version.
LTS signifies <strong>Long Term Support</strong>.
LTS versions are released every two years,
and Canonical LTD,
the owners of Ubuntu,
provide standard support for LTS versions for five years.</p>
<p>LTS versions of Ubuntu are also more stable.
Non-LTS versions of Ubuntu only receive nine months of standard support,
and generally apply cutting edge technology,
which is not always desirable for server operating systems.
Each version of Ubuntu has a code name.
20.04 has the code name <strong>Focal Fossa</strong>.
You can see a list of versions, code names, release dates,
and more on Ubuntu's <a href="https://wiki.ubuntu.com/Releases">Releases</a> page.</p>
</blockquote>
<p>We will create our VM using the gcloud console.
To do so, follow these steps:</p>
<ul>
<li>Click the <strong>Select from</strong> drop-down list.</li>
<li>In the window, select the project that you created earlier.</li>
<li>Next, click on <strong>Create a VM</strong>.</li>
<li>Provide a name for your <strong>instance</strong>.
<ul>
<li>E.g., I chose <strong>fall-2022</strong> (no spaces) </li>
</ul>
</li>
<li>Under the <strong>Series</strong> dropdown box, make sure <strong>E2</strong> is selected.</li>
<li>Under the <strong>Machine type</strong> dropdown box, select <strong>e2-micro (2 vCPU, 1 GB memory)</strong>
<ul>
<li>This is the lowest cost virtual machine and perfect for our needs.</li>
</ul>
</li>
<li>Under <strong>Boot disk</strong>, click on the <strong>Change</strong> button.</li>
<li>In the window, select <strong>Ubuntu</strong> from the <strong>Operating system</strong> dropdown box.</li>
<li>Select <strong>Ubuntu 20.04 LTS x86/64</strong></li>
<li>Leave <strong>Boot disk type</strong> be set to <strong>Balanced persistant disk</strong></li>
<li>Disk size should be set to <strong>10 GB</strong>.</li>
<li>Click on the <strong>Select</strong> button.</li>
<li>Check the <strong>Allow HTTP Traffic</strong> button</li>
<li>Finally, click on the <strong>Create</strong> button to create your VM instance.</li>
</ul>
<h2 id="connect-to-our-vm"><a class="header" href="#connect-to-our-vm">Connect to our VM</a></h2>
<p>After the new VM machine has been created,
we need to connect to it via the command line.
macOS users will connect to it via their Terminal.app.
Windows users can connect to it via their command prompt.</p>
<p>Unlike our past <code>ssh</code> sessions,
we use a slightly different <code>ssh</code> command
to connect to our VMs.
The syntax follows this pattern:</p>
<pre><code>gcloud compute ssh --zone &quot;zone-info&quot; &quot;name-info&quot; --project &quot;project-id&quot;
</code></pre>
<p>The values in the double quotes in the above command
can be located in your Google Cloud console and
in your VM instances section.</p>
<h2 id="update-our-ubuntu-vm"><a class="header" href="#update-our-ubuntu-vm">Update our Ubuntu VM</a></h2>
<p>The VM will include a recently updated version of Ubuntu 20.04,
but it may not be completely updated.
Thus the first thing we need to do is update our machines.
On Ubuntu, we'll use the following two commands,
which you should run also:</p>
<pre><code>sudo apt update
sudo apt -y upgrade
</code></pre>
<p>Then type <code>exit</code> to logout and quit the connection to the remote server.</p>
<pre><code>exit
</code></pre>
<h2 id="snapshots"><a class="header" href="#snapshots">Snapshots</a></h2>
<p>Lastly, we have installed a pristine version of Ubuntu,
but it's likely that we will mess something up 
as we work on our systems.
Or it could be that our systems may become compromised
at some point.
Therefore, we want to create a snapshot of our newly
installed Ubuntu server.
This will allow us to restore our server if something
goes wrong later.</p>
<p>To get started:</p>
<ol>
<li>
<p>In the left hand navigation panel, click on <strong>Snapshots</strong>.</p>
</li>
<li>
<p>At the top of the page, click on <strong>Create Snapshot</strong>.</p>
</li>
<li>
<p>Provide a name for your snapshot: e.g., <strong>ubuntu-1</strong>.</p>
</li>
<li>
<p>Provide a description of your snapshot: e.g.,</p>
<p>This is a new install of Ubuntu 20.04.</p>
</li>
<li>
<p>Choose your <strong>Source disk</strong>.</p>
</li>
<li>
<p>Choose a <strong>Location</strong> to store your snapshot.</p>
<ul>
<li>To avoid extra charges, choose <strong>Regional</strong>.</li>
<li>From the dropdown box, select the same location (zone-info) your VM has</li>
</ul>
</li>
<li>
<p>Click on <strong>Create</strong></p>
</li>
</ol>
<p><strong><p style="color:red">Please monitor your billing for this to avoid costs
that you do not want to incur.</p></strong></p>
<h2 id="conclusion-1"><a class="header" href="#conclusion-1">Conclusion</a></h2>
<p>Congratulations!
You have just completed your first installation of a Linux server.</p>
<p>To summarize,
in this section,
you learned about and created a VM with gcloud.
This is a lot! 
After this course is completed,
you will be able to fire up a virtual machine
on short notice and deploy websites and more.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="learning-the-command-line"><a class="header" href="#learning-the-command-line">Learning the Command Line</a></h1>
<p>It's obviously more common for people today
to learn how to use a computer via a 
graphical user interface, but
graphical user interfaces entail extra software, and
the more software we have on a server,
the more resources that software consumes, and
the more we expose our systems to security risks.</p>
<p>Graphical user interfaces also do not provide
a good platform for automation,
at least not remotely as well 
as command line interfaces do.
Working on the command line,
in what is know as a <a href="https://en.wikipedia.org/wiki/Unix_shell">shell</a>,
is in fact programming the computer.</p>
<p>Fortunately, Linux, and
many other Unix-like operating systems,
have the ability to operate without graphical user interfaces.
This is partly the reason why these operating systems
have done so well in the server market.</p>
<p>In this section,
our focus is learning the command line environment,
how to use it, and
what it offers.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-linux-filesystem"><a class="header" href="#the-linux-filesystem">The Linux Filesystem</a></h1>
<p>In this demo, we will cover the:</p>
<ul>
<li>the Linux filesystem and how it is structured and organized, and</li>
<li>the basic commands to navigate around and to work with directories and files</li>
</ul>
<blockquote>
<p>The terms <strong>directories</strong> and <strong>folders</strong> are synonymous,
but as users of primarily graphical user interfaces, you
are more likely familiar with the term <strong>folders</strong>. I will
more often use the term <strong>directories</strong> since that is the
command line (text user interface) convention. I will use
the term <strong>folders</strong> when referring to a graphical
environment.</p>
</blockquote>
<p>Throughout this demonstration,
I encourage you to <code>gcloud compute ssh</code> into
our remote server and
follow along with the commands that I use.
See
<a href="05-using-gcloud-virtual-machines.html#connect-to-our-vm">Section 2.1</a>
for details on connecting to the remote server.</p>
<h2 id="visualizing-the-filesystem-as-a-tree"><a class="header" href="#visualizing-the-filesystem-as-a-tree">Visualizing the Filesystem as a Tree</a></h2>
<p>We will need to work within the filesystem
quite a lot in this course,
but the term <strong>filesystem</strong> may refer to different concepts,
and it's important to clear that up before we start.</p>
<p>In come cases, a <strong>filesystem</strong> refers to how data (files)
are <a href="https://en.wikipedia.org/wiki/File_system">stored and retrieved</a>
on a device like a hard drive, USB drive, etc.
For example, macOS uses the <a href="https://support.apple.com/guide/disk-utility/file-system-formats-available-in-disk-utility-dsku19ed921c/mac">Apple File System (APFS)</a> by default,
and Windows uses the <a href="https://docs.microsoft.com/en-us/troubleshoot/windows-client/backup-and-storage/fat-hpfs-and-ntfs-file-systems">New Technology File System (NTFS)</a>.
Linux and other unix-like operating systems use a variety of filesystems, but
presently, the two major ones are <strong>ext4</strong> and <strong>btrfs</strong>.
The former is the default filesystem on distributions
like <a href="https://www.debian.org/">Debian</a> and <a href="https://ubuntu.com">Ubuntu</a>;
the latter is the default on the 
<a href="https://getfedora.org/">Fedora</a> and <a href="https://www.opensuse.org/">openSUSE</a> distributions. 
<a href="https://opensource.com/article/18/4/ext4-filesystem">Opensource.com</a> has a nice overview of
filesystems under this concept.</p>
<p>A <strong>filesystem</strong> might also be used to refer
to the <strong>directory structure</strong> or
<a href="https://refspecs.linuxfoundation.org/FHS_3.0/fhs/ch01.html">directory tree</a> of a system.
This concept is related to the prior concept
of a filesystem, but
it's used here to refer to the location of
files and directories on a system.
For example, on Windows,
the filesystem is identified by a letter,
like the <strong>C:</strong> drive,
regardless if the disk has a
NTFS filesystem or a FAT filesystem.
Additional drives
(e.g., extra hard drives, USB drives, DVD drives, etc.),
will be assigned their own letters
(<strong>A:</strong>, <strong>B:</strong>, <strong>D:</strong>, etc.).
<a href="https://developer.apple.com/library/archive/documentation/FileManagement/Conceptual/FileSystemProgrammingGuide/FileSystemOverview/FileSystemOverview.html">macOS adheres to a tree like filesystem</a>
like Linux and other unix-like operating systems.
(This is because macOS is UNIX.)
In these operating systems, we have a
top-level <strong>root</strong> directory
identified by a single forward slash  <strong>/</strong>,
and then subdirectories under that root directory.
Additional drives
(e.g., extra hard drives, USB drives, DVD drives, etc.)
are <strong>mounted</strong> under that root hierarchy and
not separately like on Windows.
<a href="https://www.linux.com/tutorials/linux-filesystem-explained/">Linux.com</a> provides a nice overview
of the most common directory structure
that Linux distributions use along with an
explanation for the major bottom level directories.
In this section, we will learn
about this type of filesystem.</p>
<p>On Linux, we can visualize the
filesystem with the <code>tree</code> command.
The <code>tree</code> command, like many Linux commands,
can be run on its own or with options,
like in the second example below:</p>
<ul>
<li><code>tree</code> : list contents of directories in a tree-like format
<ul>
<li><code>tree -dfL 1</code> : directories only, full path, one level</li>
<li><code>tree -dfL 1 /</code> : list directories only at root <strong>/</strong> level</li>
</ul>
</li>
</ul>
<h3 id="the-root-directory-and-its-base-level-directories"><a class="header" href="#the-root-directory-and-its-base-level-directories">The root Directory and its Base Level Directories</a></h3>
<p>As explained on the Linux.com page,
here are the major sub directories under <strong>/</strong> (root)
and a short description of their main purpose:</p>
<ul>
<li><code>/bin</code> : binary files needed to use the system</li>
<li><code>/boot</code>  : files needed to boot the system</li>
<li><code>/dev</code> : device files -- all hardware has a file</li>
<li><code>/etc</code> : system configuration files</li>
<li><code>/home</code> : user directories</li>
<li><code>/lib</code> : libraries/programs needed for other programs</li>
<li><code>/media</code> : external storage is mounted</li>
<li><code>/mnt</code> : other filesystems may be mounted</li>
<li><code>/opt</code> : store software code to compile software</li>
<li><code>/proc</code> : files containing info about your computer</li>
<li><code>/root</code> : home directory of superuser</li>
<li><code>/run</code> : used by system processes</li>
<li><code>/sbin</code> : like <code>/bin</code>, binary files that require superuser privileges</li>
<li><code>/srv</code> : contains data for servers</li>
<li><code>/sys</code> : contains info about devices</li>
<li><code>/tmp</code> : temp files used by applications</li>
<li><code>/usr</code> : user binaries, etc that might be installed by users</li>
<li><code>/var</code> : variable files, used often for system logs</li>
</ul>
<p>Although there are 18 directories listed above
that <strong>branch</strong> off from the root directory,
we will use some more often than others.
For example, the <strong>/etc</strong> directory
contains system configuration files,
and we will use the contents of this directory,
along with the <strong>/var</strong> directory,
quite a bit when we set up our web servers,
relational database servers,
and more later in the semester.
The <strong>/home</strong> directory is where our default
home directories are stored,
and if you manage a multi-user system,
then this will be an important directory to manage. </p>
<p>Source: <a href="https://www.linux.com/tutorials/linux-filesystem-explained/">Linux Filesystem Explained</a></p>
<h2 id="relative-and-absolute-paths"><a class="header" href="#relative-and-absolute-paths">Relative and Absolute Paths</a></h2>
<p>macOS users have the Finder app
to navigate their filesystem,
to move files to different folders,
to copy files, to trash them, etc.
Window users have File Explorer for these functions.
Linux users have similar graphical software options,
but all of these functions can be
completed on the Linux command line,
and generally more efficiently.
To get started, we need to learn two things first:</p>
<ol>
<li>how to specify the locations of files and directories in
the filesystem </li>
<li>the commands needed to work with the filesystem</li>
</ol>
<p>To help specify the locations of files and directories,
there are two key concepts to know:</p>
<ul>
<li>absolute paths</li>
<li>relative paths</li>
</ul>
<p>Above we learned about the <strong>/</strong> root directory
and its subdirectories.
All sorts of commands,
especially those that deal with files and directories 
(like copying, moving, deleting),
require us to specify on the command line
the locations of the files and directories.
It's common to specify the location in two different ways,
by specifying their <strong>absolute</strong> path (or location)
on the filesystem,
or the <strong>relative</strong> path (or location).</p>
<p>To demonstrate, we might want to move around the filesystem.
When we first log in to our remote system,
our default location will be our home directory,
sometimes referred to as <strong>$HOME</strong>.
The path (location) to that directory will be.</p>
<pre><code>/home/USER
</code></pre>
<p>Where <strong>USER</strong> is your username.
Therefore, since my username is <strong>sean</strong>,
my home directory is located at:</p>
<pre><code>/home/sean
</code></pre>
<p>which we can see specified with the <code>pwd</code>
(print working directory) command:</p>
<pre><code>pwd
/home/sean
</code></pre>
<blockquote>
<p>When I write <strong>$HOME</strong>,
I am referring to a default, <strong>environmental</strong> variable
that points to our home directory.
It's <strong>variable</strong> because,
depending on which account we're logged in as,
<strong>$HOME</strong> will point to a different location.
For me, then, that will be <code>/home/sean</code>,
if I'm logged in as <strong>sean</strong>.
For you it'll point to your home directory.</p>
</blockquote>
<p>In my home directory,
I have a subdirectory called <strong>public_html</strong>.
The path to that is:</p>
<pre><code>/home/sean/public_html
</code></pre>
<p>In a program like Finder (macOS) or
File Explorer (Windows),
if I want to change my location to that
subdirectory (or folder),
then I'd double click on its folder icon.
On the command line, however, I have to
write out the command
and the path to the subdirectory.
Therefore, <strong>starting in my home directory</strong>,
I use the following command to switch to the
public_html subdirectory:</p>
<pre><code>cd public_html
</code></pre>
<blockquote>
<p>Note that files and directories in Linux are case
sensitive. This means that a directory named
<strong>public_html</strong> can co-exist alongside a directory named
<strong>Public_html</strong>. Or a file named <strong>paper.txt</strong> can
co-exist alongside a file named <strong>Paper.txt</strong>. So be sure
to use the proper case when spelling out files,
directories, and even commands.</p>
</blockquote>
<p>The above is an example of using a relative path, and
that command would only be successful if I were
first in my <strong>$HOME</strong> directory.
That's because I specified the location of <strong>public_html</strong>
relative to my default (<strong>$HOME</strong>) location.</p>
<p>I could have also specified the absolute location,
but this would be the wordier way.
Since the <strong>public_html</strong> directory
is in my $HOME directory,
and my $HOME directory is a subdirectory
in the <strong>/home</strong> directory,
then to specify the absolute path in the above command,
I'd write:</p>
<pre><code>cd /home/sean/public_html
</code></pre>
<p>Again, the relative path specified above
would only work if
I was in my home directory, because 
<code>cd public_html</code> is relative to the
location of <code>/home/sean</code>.
That is, the subdirectory <strong>public_html</strong>
is in <strong>/home/sean</strong>.
But specifying the absolute path would work no matter where
I was located in the filesystem.
For example, if I was working on a file
in the <code>/etc/apache2</code> directory,
then using the absolute path
(<code>cd /home/sean/public_html</code>) would work.
But the relative path (<code>cd public_html</code>)
command would not since
there is no subdirectory called <strong>public_html</strong>
in the <code>/etc/apache2</code> directory.</p>
<p>Finally, you can use the <code>ls</code> command to
list the contents of a directory, i.e.,
the files and subdirectories in a directory:</p>
<pre><code>ls
</code></pre>
<p>We will cover this more next. </p>
<h2 id="conclusion-2"><a class="header" href="#conclusion-2">Conclusion</a></h2>
<p>Understanding relative and absolute paths is
one of the more difficult concepts for
new commandline users to learn,
but after time, it'll feel natural.
So just keep practicing, and
I'll go over this throughout the semester.</p>
<p>In this section, you learned the following commands:</p>
<ul>
<li><code>tree</code> to list directory contents in a tree-like format</li>
<li><code>cd</code> to <strong>change directory</strong></li>
<li><code>pwd</code> to <strong>print working directory</strong></li>
</ul>
<p>You learned different ways to refer to the home
directory:</p>
<ul>
<li><strong>/home/USER</strong></li>
<li><strong>$HOME</strong></li>
<li><strong>~</strong></li>
</ul>
<p>You learned about relative and absolute paths.
An absolute path starts with the root directory <strong>/</strong>.
Here's an absolute path to a file named
<strong>paper.txt</strong> in my home directory:</p>
<ul>
<li>absolute path: <strong>/home/sean/paper.txt</strong></li>
</ul>
<p>If I were already in my home directory,
then the relative path would simply be:</p>
<ul>
<li>relative path: <strong>paper.txt</strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="files-and-directories"><a class="header" href="#files-and-directories">Files and Directories</a></h1>
<h2 id="basic-directory-and-file-commands"><a class="header" href="#basic-directory-and-file-commands">Basic Directory and File commands</a></h2>
<p>In order to explore the above directories
but also to create new ones and work with files,
we need to know some basic terminal commands.
A lot of these commands are part of the base system
called <a href="https://en.wikipedia.org/wiki/List_of_GNU_Core_Utilities_commands">GNU Coreutils</a>,
and in this demo,
we will specifically cover some of the following
GNU Coreutils:</p>
<ul>
<li><a href="https://www.gnu.org/software/coreutils/manual/coreutils.html#toc-Directory-listing-1">Directory Listing</a></li>
<li><a href="https://www.gnu.org/software/coreutils/manual/coreutils.html#Basic-operations">Basic Operations</a></li>
<li><a href="https://www.gnu.org/software/coreutils/manual/coreutils.html#Basic-operations">Special File Types</a></li>
<li><a href="https://www.gnu.org/software/coreutils/manual/coreutils.html#Printing-text">Printing Text</a></li>
</ul>
<h3 id="directory-listing"><a class="header" href="#directory-listing">Directory Listing</a></h3>
<blockquote>
<p>I have already demonstrated one command:
the <code>cd</code> (change directory) command.
This will be one of the most frequently used commands in your toolbox.</p>
</blockquote>
<p>In our current directory, or
once we have changed to a new directory,
we will want to learn its contents
(what files and directories it contains).
We have a few commands to choose from to list contents
(e.g.,  you have already seen the <code>tree</code> command),
but the most common command is the <code>ls</code> (list) command.
We use it by typing the following two letters in the terminal:</p>
<pre><code>ls
</code></pre>
<p>Again, to confirm that we're in some specific directory,
use the <code>pwd</code> command to <strong>print</strong> the <strong>working directory</strong>.</p>
<p>Most commands can be combined with <strong>options</strong>.
Options provide additional functionality to the base command, and
in order to see what options are available for the <code>ls</code> command,
we can look at its <strong>man(ual) page</strong>:</p>
<pre><code>man ls
</code></pre>
<p>From the <code>ls</code> <strong>man page</strong>,
we learn that we can use the <code>-l</code> option to format
the output of the <code>ls</code> command as a long-list,
or a list that provides more information about
the files and directories in the working directory.
Later in the semester,
I will talk more about what the other parts of output of this option mean.</p>
<pre><code>ls -l
</code></pre>
<p>We can use the <code>-a</code> option to list hidden files.
In Linux, hidden files are hidden from the base <code>ls</code> command
if the files begin with a period.
We have a some of those files in our <strong>$HOME</strong> directories,
and we can see them like so:</p>
<pre><code>ls -a
</code></pre>
<p>We can also combine options.
For example, to view all files,
including hidden ones,
in the long-list format,
we can use:</p>
<pre><code>ls -al
</code></pre>
<h2 id="basic-file-operations"><a class="header" href="#basic-file-operations">Basic File Operations</a></h2>
<p>Some basic file operation commands include:</p>
<ul>
<li><code>cp</code>    : copying files and directories</li>
<li><code>mv</code>    : moving (or renaming) files and directories</li>
<li><code>rm</code>    : removing (or deleting) files and directories</li>
<li><code>touch</code> : change file timestamps (or, create a new, empty file)</li>
</ul>
<p>These commands also have various options
that can be viewed in their respective <strong>man pages</strong>.
Again, command options provide additional functionality to the base command,
and are mostly (but not always) prepended with a dash and a letter or number.
To see examples, type the following commands,
which will launch the manual pages for them.
Press <code>q</code> to exit the manual pages,
and use your up and down arrow keys to scroll through the manuals:</p>
<pre><code>man cp
man mv
man rm
man touch
</code></pre>
<p>The <code>touch</code> command's primary use is to change a file's timestamp;
that is, the command updates a file's &quot;access and modification times&quot;
(see <code>man touch</code>).
For example, let's say we have a file called <strong>paper.txt</strong>
in our home directory.
We can see the output here:</p>
<pre><code>ls -l paper.txt
-rw-rw-r-- 1 sean sean 0 Jun 27 00:13 /home/sean/paper.txt
</code></pre>
<p>This shows that the last modification time was 12:03AM on June 27.</p>
<p>If I run the touch command on <strong>paper.txt</strong>,
the timestamp will change:</p>
<pre><code>touch paper.txt
-rw-rw-r-- 1 sean sean 0 Jun 27 00:15 /home/sean/paper.txt
</code></pre>
<p>This shows an updated modification timestamp of 12:15AM.</p>
<p>The side effect occurs when we name a file with the <code>touch</code> command,
but the file does not exist,
in which case the <code>touch</code> command will create an empty file
with the name we use.
Let's say that I do <strong>not</strong> have a file named <strong>file.txt</strong>
in my home directory.
If I run the <code>ls -l file.txt</code> command, I'll receive an error
since the file does not exist.
But if I then use the <code>touch file.txt</code> command,
and then run <code>ls -l file.txt</code>.
we'll see that the file now exists,
that it has a byte size of zero:</p>
<pre><code>ls -l file.txt
ls: cannot access 'file.txt': No such file or directory
touch file.txt
ls -l file.txt
-rw-rw-r-- 1 sean sean 0 Jun 27 00:18 file.txt
</code></pre>
<p>Here are some ways to use the other three commands and their options:</p>
<h3 id="copying-files-and-directories"><a class="header" href="#copying-files-and-directories">Copying Files and Directories</a></h3>
<p>To copy an existing file (<strong>file1.txt</strong>)
to a new file (<strong>file2.txt</strong>):</p>
<pre><code>cp file1.txt file2.txt
</code></pre>
<p>Use the <code>-i</code> option to copy that file in interactive mode;
that is, to prompt you before overwriting an existing file.</p>
<p>We also use the <code>cp</code> command to copy directories.</p>
<h3 id="moving-files-and-directories"><a class="header" href="#moving-files-and-directories">Moving Files and Directories</a></h3>
<p>The <code>mv</code> command will move an existing file to a different directory,
and/or rename the file.
For example, from within our home directory
(therefore, using relative path names),
to move a file named &quot;file.docx&quot; 
to a subdirectory named &quot;Documents&quot;:</p>
<pre><code>mv file.docx Documents/
</code></pre>
<p>To rename a file only (keeping it in the same directory),
the command looks like this:</p>
<pre><code>mv file.docx newName.docx
</code></pre>
<p>To move the file to our Documents/ subdirectory and also rename it,
then we'd do this:</p>
<pre><code>mv file.docx Documents/newName.docx
</code></pre>
<p>The <code>man</code> page for the <code>mv</code> command also describes an <code>-i</code> option
for interactive mode that helps prevent us from overwriting existing files.
For example, if we have a file called <strong>paper.docx</strong> in our <strong>$HOME</strong> directory,
and we have a file named <strong>paper.docx</strong> in our <strong>$HOME/Documents</strong> directory,
and if these are actually two different papers (or files),
then moving the file to that directory will overwrite it without asking.
The <code>-i</code> option will prompt us first:</p>
<pre><code>mv -i paper.docx Documents/paper.docx
</code></pre>
<h3 id="remove-or-delete"><a class="header" href="#remove-or-delete">Remove or Delete</a></h3>
<p>Finally, to delete a file, we use the <code>rm</code> command:</p>
<pre><code>rm file.html
</code></pre>
<blockquote>
<p>Unlike the trash bin in your graphical user environment,
it's very hard to recover a deleted file using the <code>rm</code> command.
That is, using <code>rm</code> does not mean the file or directory is <strong>trashed</strong>;
rather, it means it was <strong>deleted</strong>.</p>
</blockquote>
<h2 id="special-file-types"><a class="header" href="#special-file-types">Special File Types</a></h2>
<p>For now, let's only cover two commands here:</p>
<ul>
<li><code>mkdir</code> for creating a new directory </li>
<li><code>rmdir</code> for deleting an empty directory</li>
</ul>
<p>Like the above commands,
these commands also have their own set of options
that can be viewed in their respective <strong>man pages</strong>:</p>
<pre><code>man mkdir
man rmdir
</code></pre>
<h3 id="make-or-create-a-new-directory"><a class="header" href="#make-or-create-a-new-directory">Make or Create a New Directory</a></h3>
<p>We use these commands like we do the ones above.
If we are in our <strong>$HOME</strong> directory, and
we want to create a new directory called <strong>bin</strong>, we do:</p>
<pre><code>mkdir bin 
</code></pre>
<blockquote>
<p>The <strong>bin</strong> directory in our <strong>$HOME</strong> directory is a default location
to store our personal applications, or applications (programs) that
are only available to us.</p>
</blockquote>
<p>And if we run <code>ls</code>, we should see that it was successful.</p>
<h3 id="delete-a-directory"><a class="header" href="#delete-a-directory">Delete a Directory</a></h3>
<p>The <code>rmdir</code> command is a bit weird
because it only removes <strong>empty</strong> directories.
To remove the directory we just created, we use it like so:</p>
<pre><code>rmdir bin 
</code></pre>
<p>However, if you want to remove a directory
that contains files or other subdirectories,
then you will have to use the <code>rm</code> command
along with the <code>-r</code> (recursive) option:</p>
<pre><code>rm -r directory-with-content/
</code></pre>
<h2 id="printing-text"><a class="header" href="#printing-text">Printing Text</a></h2>
<p>There a number of ways to print text to <strong>standard output</strong>,
which is our screen by default in the terminal.
We could also redirect standard output
to a file, to a printer, or to a remote shell.
We'll see examples like that later in the semester.
Here let's cover two commands:</p>
<ul>
<li><code>echo</code> : to print a line of text to standard output</li>
<li><code>cat</code>  : to concatenate and write files</li>
<li><code>less</code> : to view files one page at a time</li>
</ul>
<blockquote>
<p><strong>Standard output</strong> is by default the screen.
When we <strong>print</strong> to standard output,
then by default we print to the screen.
However, standard output can be <strong>redirected</strong>
to files, programs, or devices, like actual printers.</p>
</blockquote>
<h3 id="print-to-screen"><a class="header" href="#print-to-screen">Print to Screen</a></h3>
<p>To use <code>echo</code>:</p>
<pre><code>echo &quot;hello world&quot;
echo &quot;Today is a good day.&quot;
</code></pre>
<p>We can also <code>echo</code> variables:</p>
<pre><code>a=4
echo &quot;$a&quot;
</code></pre>
<h3 id="print-file-to-screen"><a class="header" href="#print-file-to-screen">Print File to Screen</a></h3>
<p><code>cat</code> is listed elsewhere in the GNU Coreutils page.
The primary use of the <code>cat</code> command is to join, combine, or concatenate files,
but if used on a single file,
it has this nice side effect of printing the content of the file to the screen:</p>
<pre><code>cat file.html
</code></pre>
<p>If the file is very long, we might want to use what's called a <strong>pager</strong>.
There are a few pagers to use, but the <code>less</code> command is a common one:</p>
<pre><code>less file.html
</code></pre>
<p>Like with the <strong>man pages</strong>,
use the up and down arrow keys to scroll through the output,
and press <strong>q</strong> to quit the pager.</p>
<h2 id="conclusion-3"><a class="header" href="#conclusion-3">Conclusion</a></h2>
<p>In this demo, we learned about the filesystem or directory structure of Linux,
and we also learned some basic command to work with directories and files.
You should practice using these commands as much as possible.
The more you use them, the easier it'll get.
Also, be sure to review the <strong>man pages</strong> for each of the commands,
especially to see what options are available for each of them.</p>
<p>Basic commands covered in this demo include:</p>
<ul>
<li><code>cat</code>   : display contents of a file</li>
<li><code>cp</code>    : copy</li>
<li><code>echo</code>  : print a line of text</li>
<li><code>less</code>  : display contents of a file by page</li>
<li><code>ls</code>    : list</li>
<li><code>man</code>   : manual pages</li>
<li><code>mkdir</code> : create a directory</li>
<li><code>mv</code>    : move or rename</li>
<li><code>pwd</code>   : print name of current/working directory</li>
<li><code>rmdir</code> : delete an empty directory</li>
<li><code>rm</code>    : remove or delete a file or directory</li>
<li><code>tree</code>  : list contents of directories in a tree-like format</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="file-attributes"><a class="header" href="#file-attributes">File Attributes</a></h1>
<h2 id="identifying-ownership-and-permissions"><a class="header" href="#identifying-ownership-and-permissions">Identifying Ownership and Permissions</a></h2>
<p>In the last section, we saw that the output of the <code>ls -l</code> command
included a lot extra information besides a listing of file names.
The output also listed the owners and permissions for each file and directory.</p>
<p>Each user account on a Linux system
(like many operating systems)
has a user name and has at least one group membership, and
that name and that group membership
determine the user and group ownership
for all files created under that account.</p>
<p>In order to allow or restrict access to files and directories
(for example,
to allow other users to read, write to, or run your or others' files),
ownership and permissions are set in order to manage that kind 
of access to those files and directories.
There are thus two owners for every file (and directory):</p>
<ul>
<li>user owner</li>
<li>group owner</li>
</ul>
<p>And there are three permission <em>modes</em> that restrict or expand
access to each file (or directory) based on user or group membership:</p>
<ul>
<li>(r)ead</li>
<li>(w)rite</li>
<li>e(x)ecute (as in a program)</li>
</ul>
<blockquote>
<p>I am emphasizing the <strong>rwx</strong> in the above list of modes because
we will need to remember what these letters stand for when
we work with file and directory permissions.</p>
</blockquote>
<p>Consider the output of <code>ls -l</code> in some <strong>public_html</strong> directory
that contains a single file called <strong>index.html</strong>:</p>
<pre><code>-rw-rw-r-- 1 sean sean 11251 Jun 20 14:41 index.html
</code></pre>
<p>According to the above output,
we can parse the following information about the file:</p>
<div class="table-wrapper"><table><thead><tr><th>Attributes</th><th><code>ls -l</code> output</th></tr></thead><tbody>
<tr><td>File permissions</td><td><code>-rw-rw-r--</code></td></tr>
<tr><td>Number of links</td><td>1</td></tr>
<tr><td>Owner name</td><td>sean</td></tr>
<tr><td>Group name</td><td>sean</td></tr>
<tr><td>Byte size</td><td>11251</td></tr>
<tr><td>Last modification date</td><td>Jun 20 14:41</td></tr>
<tr><td>File name</td><td>index.html</td></tr>
</tbody></table>
</div>
<p>What's important for us right now are the <strong>File permissions</strong> row,
the <strong>Owner name</strong> row,
and the <strong>Group name</strong> row.</p>
<p>The Owner and Group names of the <strong>index.html</strong> file are <strong>sean</strong> because
there is a user account named <strong>sean</strong> on the system and
a group account named <strong>sean</strong> on the system, and
that file exists in the user <strong>sean</strong>'s home directory.</p>
<p>The <strong>File permissions</strong> row shows:</p>
<pre><code>-rw-rw-r--
</code></pre>
<p>Let's ignore the first dash for now.
The remaining permissions can be broken down as:</p>
<ul>
<li>rw- (read and write only permissions for the Owner)</li>
<li>rw- (read and write only permissions for the Group)</li>
<li>r-- (read-only permissions for the World)</li>
</ul>
<p>We read the output as such
(dashes, other than the initial one, signify no permissions):</p>
<ul>
<li>User <strong>sean</strong> is the Owner and has (r)ead and (w)rite permissions on the file
but not e(x)ecute permissions (<code>rw-</code>).</li>
<li>Group <strong>sean</strong> is the Group owner and has (r)ead and (w)rite permissions on
the file but not e(x)ecute permissions (<code>rw-</code>).</li>
<li>The <strong>World</strong> can (r)ead the file but cannot (w)rite to the file nor
e(x)ecute the file (<code>r--</code>).</li>
</ul>
<blockquote>
<p>The word <strong>write</strong> is a classical computing term
that means, essentially, to edit and save edits of a file.
Today we use the term <strong>save</strong> instead of <strong>write</strong>,
but remember that they are basically equivalent terms.</p>
</blockquote>
<p>Since this is an HTML page for a website,
the <strong>World</strong> ownership allows people to view (read) the file but not write
(save) to it nor execute (run) it.
Any webpage you view on the internet at least has World mode set to read.</p>
<p>Let's take a look at another file.
In our <code>/bin</code> directory, we can see a listing for this program
(note that I specify the absolute path of the file named <strong>bin</strong>):</p>
<pre><code>ls -l /bin/zip
-rwxr-xr-x 1 root   root    212K Feb  2  2021  zip*
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Attributes</th><th><code>ls -l</code> output</th></tr></thead><tbody>
<tr><td>File permissions</td><td><code>-rwxr-xr-x</code></td></tr>
<tr><td>Number of links</td><td>1</td></tr>
<tr><td>Owner name</td><td>root</td></tr>
<tr><td>Group name</td><td>root</td></tr>
<tr><td>Byte size</td><td>212K</td></tr>
<tr><td>Last modification date</td><td>Feb  2 2021</td></tr>
<tr><td>File name</td><td>zip*</td></tr>
</tbody></table>
</div>
<p>Since <code>zip</code> is a computer program used to package and compress files,
it needs to be e(x)ecutable.
That is, users on the system need to be able to run it.
But notice that the owner and group names of the file point to the user <strong>root</strong>.
We have already learned that there is a <strong>root</strong> level in our filesystem.
This is the top level directory in our filesystem and is referenced
by the forward slash: <code>/</code>.
But there is also a <strong>root</strong> user account.
This is the system's <strong>superuser</strong>.
The <strong>superuser</strong> can run or access anything on the system, and
this user also owns most of the system files.</p>
<p>We read the output as such:</p>
<ul>
<li>User <strong>root</strong> is the Owner and has (r)ead, (w)rite, and e(x)ecute (<code>rwx</code>) permissions on the file.</li>
<li>Group <strong>root</strong> is the Group owner and has (r)ead and e(x)ecute permissions
but not (w)rite permissions (<code>r-x</code>)</li>
<li>The <strong>World</strong> has (r)ead and e(x)ecute permissions but not (w)rite (<code>r-x</code>). This
permissions allows other users (like you and me) to use the <code>zip</code>
program.</li>
</ul>
<blockquote>
<p>The asterisk at the end of the file name (<code>zip*</code>) simply indicates that
this file is an executable;
i.e., it is a software program that you can run.</p>
</blockquote>
<p>Finally, let's take a look at the permissions for a directory.
On my system, I run the following command in my home directory,
which will show the permissions for my <code>/home/sean</code> directory:</p>
<pre><code>ls -ld
</code></pre>
<p>And the output is:</p>
<pre><code>drwx--x--- 51 sean sean 4.0K Jun 23 18:35 ./
</code></pre>
<p>This shows that:</p>
<div class="table-wrapper"><table><thead><tr><th>Attributes</th><th><code>ls -ld</code> output</th></tr></thead><tbody>
<tr><td>File permissions</td><td><code>drwx--x---</code></td></tr>
<tr><td>Number of links</td><td>1</td></tr>
<tr><td>Owner name</td><td>sean</td></tr>
<tr><td>Group name</td><td>sean</td></tr>
<tr><td>Byte size</td><td>4.0K</td></tr>
<tr><td>Last modification date</td><td>Jun 23</td></tr>
<tr><td>File name</td><td>./</td></tr>
</tbody></table>
</div>
<p>This is a little different from the previous examples, but let's parse it:</p>
<ul>
<li>Instead of an initial dash, this <em>file</em> has an initial <strong>d</strong> that identifies this
as a directory. Directories in Linux are simply special types of files.</li>
<li>User <strong>sean</strong> has read, write, and execute (<code>rwx</code>) permissions.</li>
<li>Group <strong>sean</strong> has execute (<code>--x</code>) permissions only.</li>
<li>The <strong>World</strong> has no permissions (<code>---</code>).</li>
<li><strong>./</strong> signifies the current directory, which happens to be my home
directory, since I ran that command at the <code>/home/sean</code> path.</li>
</ul>
<p>The takeaway from this set of permissions and the ownership is that only the
user <strong>sean</strong> and those in the group <strong>sean</strong>, which is just the user <strong>sean</strong>,
can access this home directory.</p>
<p>We might ask why the directory has an e(x)ecutable bit set
for the owner and the group if
a directory is not an executable file.
That is, it's not a program or software.
This is so that the owner and the group can access that directory
using, for example, the <code>cd</code> (change directory) command.
If the directory was not executable,
like it's not for the <strong>World</strong> (<code>---</code>),
then it would not be accessible
with the <code>cd</code> command,
or any other command.
In this case, the <strong>World</strong>
(users who are not me)
cannot access my home directory.</p>
<h2 id="changing-file-permissions-and-ownership"><a class="header" href="#changing-file-permissions-and-ownership">Changing File Permissions and Ownership</a></h2>
<h3 id="changing-file-permissions"><a class="header" href="#changing-file-permissions">Changing File Permissions</a></h3>
<p>All the files and directories on a Linux system
have default ownership and permissions set.
This includes new files that we might create as
we use our systems.
There will be times when we will want to change the defaults,
for example, the kinds of defaults described above.
There are several commands available to do that,
and here I'll introduce you to the two most common ones.</p>
<ol>
<li>The <code>chmod</code> command is used to change file (and directory) permissions
(or file mode bits).</li>
<li>The <code>chown</code> command is used to change a file's (and directory's) owner and
group.</li>
</ol>
<p>The <code>chmod</code> command changes the <code>-rwxrwxrwx</code> part of a file's attributes
that we see with the <code>ls -l</code> command.
Each one of those bits (the <code>r</code>, the <code>w</code>, and the <code>x</code>)
are assigned the following <a href="https://docs.oracle.com/cd/E19504-01/802-5750/6i9g464pv/index.html">octal</a> values:</p>
<div class="table-wrapper"><table><thead><tr><th>permission</th><th>description</th><th>octal value</th></tr></thead><tbody>
<tr><td>r</td><td>read</td><td>4</td></tr>
<tr><td>w</td><td>write</td><td>2</td></tr>
<tr><td>x</td><td>execute</td><td>1</td></tr>
<tr><td>-</td><td>no permissions</td><td>0</td></tr>
</tbody></table>
</div>
<p>There are three octal values for the three set of permissions
represented by <code>-rwxrwxrwx</code>.
If I bracket the sets (for demonstration purposes only),
they look like this:</p>
<pre><code>-[rwx][rwx][rwx]
</code></pre>
<p>The first set describes the permissions for the owner.
The second set describes the permissions for the group.
The third set describes the permissions for the World. </p>
<p>We use the <code>chmod</code> command and the octal values to change
a file or directory's permissions.
For each set, we add up the octal values.
For example, to make a file read (4), write (2), and executable (1)
for the owner only,
and zero out the permissions for the group and World,
we use the <code>chmod</code> command like so:</p>
<pre><code>chmod 700 paper.txt
</code></pre>
<p>We use 7 because <code>4+2+1=7</code>, and
we use two zeroes in the second two places
since we're removing permissions for group and World.</p>
<p>If we want to make the file read, write, and executable by
the owner, the group, and the world, then we repeat this for each set:</p>
<pre><code>chmod 777 paper.txt
</code></pre>
<p>More commonly, we might want to restrict ownership.
Here we enable <code>rw-</code> for the owner,
and <code>r--</code> for the group and the World:</p>
<pre><code>chmod 644 paper.txt
</code></pre>
<p>Because <code>4+2=6</code> for owner,
and <code>4</code> is read only for group and World, respectively.</p>
<h3 id="changing-file-ownership"><a class="header" href="#changing-file-ownership">Changing File Ownership</a></h3>
<p>In order to change the ownership of a file,
we use the <code>chown</code> command followed by
the name of the owner.
We can optionally change the owner of the group by adding a colon (no spaces)
and the name of the group.</p>
<p>We can see what groups we belong to with the <code>groups</code> command.
On one system that I have an account on, I am a member of two groups:
a group <strong>sean</strong> (same as my user name on this system),
and a group <strong>sudo</strong>,
which signifies that I'm an administrator on this system
(more on <code>sudo</code> later in the semester).</p>
<pre><code>groups
sean sudo 
</code></pre>
<p>We can only change the user and group ownership of a file or directory
if we have administrative privileges (<code>sudo</code> administrative access),
or if we share group membership.
This means that,
unless we have <code>sudo</code> (admin) privileges,
we often might change the group name for a file or directory
than the user owner.
Later in the semester,
you will have to do this kind of work (change user and group names)
of files and directories.
In the meantime, let's see some examples:</p>
<p>Imagine that my Linux user account belongs to the group <strong>sisFaculty</strong>, and
that there are other users on the Linux system (my colleagues at work)
who are also members of this group.
If I want to make a directory or file accessible to them,
then I can change the group name of a file I own to <strong>sisFaculty</strong>.
Let's call that file <strong>testFile.txt</strong>.
To change only the group name for the file:</p>
<pre><code>chown :sisFaculty testFile.txt
</code></pre>
<p>I can generally only change the user owner of a file if I have admin
access on a system.
In such a case,
I might have to use the <code>sudo</code> command
(you do not have access to the <code>sudo</code> command
on our shared server, 
but you will have it later on your virtual machines).
In this case, I don't need the colon.
To change the owner only,
say from the user <strong>sean</strong> to the user <strong>tmk</strong>:</p>
<pre><code>sudo chown tmk testFile.txt
</code></pre>
<p>To change both user owner and group name,
we simply specify both names
and separate those names by a colon,
where the syntax is <code>chown USER:GROUP testFile.txt</code></p>
<pre><code>sudo chown tmk:sisFaculty testFile.txt
</code></pre>
<p>After using the <code>chown</code> command to change 
either the owner or group,
we should double check the file or directory's permissions
using the <code>chmod</code> command.
Here I make it so that the user owner and the group <strong>sisFaculty</strong> has
(r)ead and (w)rite access to the file.
I use <code>sudo</code> because,
as the user <strong>sean</strong>,
I'm changing the file permissions for a file
that I do not own:</p>
<pre><code>sudo chmod 660 testFile.txt
</code></pre>
<h2 id="conclusion-4"><a class="header" href="#conclusion-4">Conclusion</a></h2>
<p>In this section, we learned:</p>
<ul>
<li>how to identify file/directory ownership and permissions</li>
<li>and how to change file/directory ownership and permissions.</li>
</ul>
<p>Specifically, we looked at two ways to change the attributes of a file.
This includes changing the ownership of a file
with the <code>chown</code> command, and
setting the read, write, and execute
permissions of a file with the <code>chmod</code>
command.</p>
<p>The commands we used to change these attributes include:</p>
<ul>
<li><code>chmod</code> : for changing file permissions (or file mode bits)</li>
<li><code>chown</code> : for changing file ownership</li>
</ul>
<p>We also used the following commands:</p>
<ul>
<li><code>ls</code>         : list directory contents
<ul>
<li><code>ls -ld</code> : long list directories themselves, not their contents</li>
</ul>
</li>
<li><code>groups</code>     : print the groups a user is in</li>
<li><code>sudo</code>       : execute a command as another user</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="text-processing-part-1"><a class="header" href="#text-processing-part-1">Text Processing: Part 1</a></h1>
<p>One of the more important sets of tools that Linux (as well Unix-like)
operating systems provide are tools that
<a href="https://tldp.org/LDP/abs/html/textproc.html">aid processing and manipulating text</a>.
The ability to process and manipulate text, programmatically,
is a basic and essential part of many programming languages,
(e.g., Python, JavaScript, etc),
and learning how to process and manipulate text is
an important skill for a variety of jobs including
statistics, data analytics, data science, programming, web programming,
systems administration, and so forth.
In other words,
this functionality of Linux (and Unix-like) operating systems
essentially means that to learn Linux and the tools that it provides
is akin to learning how to program.</p>
<blockquote>
<p>Plain text files are the basic building blocks of programs and data.
Programs are written in plain text editors, and
data is often stored as plain text.
Linux offers many tools to examine, manipulate, process, analyze,
and visualize data in plain text files.</p>
</blockquote>
<p>In this section, we will learn some of the basic
tools to examine plain text (i.e., data).
We will do some programming later in this class, but for us,
the main objective with learning to program
aligns with our work as systems administrators.
That means our text processing and programming goals will serve our interests
in managing users, security, networking, system configuration, and so forth
as Linux system administrators.</p>
<p>In the meantime, the goal of this section is to acquaint ourselves with
some of the tools that can be used to process text.
In this section, we will only cover a handful of text processing
programs or utilities,
but here is a fairly comprehensive list,
and we'll examine some additional ones from this list
later in the semester:</p>
<ul>
<li><code>cat</code>      : concatenate files and print on the standard output</li>
<li><code>cut</code>      : remove sections from each line of files</li>
<li><code>diff</code>     : compare files line by line</li>
<li><code>echo</code>     : display a line of text</li>
<li><code>expand</code>   : convert tabs to spaces</li>
<li><code>find</code>     : search for files in a directory hierarchy</li>
<li><code>fmt</code>      : simple optimal text formatter</li>
<li><code>fold</code>     : wrap each input line to fit in specified width</li>
<li><code>grep</code>     : print lines that match patterns</li>
<li><code>head</code>     : output the first part of files</li>
<li><code>join</code>     : join lines of two files on a common field</li>
<li><code>look</code>     : display lines beginning with a given string</li>
<li><code>nl</code>       : number lines of files</li>
<li><code>paste</code>    : merge lines of files</li>
<li><code>printf</code>   : format and print data</li>
<li><code>shuf</code>     : generate random permutations</li>
<li><code>sort</code>     : sort lines of text files</li>
<li><code>tail</code>     : output the last part of files</li>
<li><code>tr</code>       : translate or delete characters</li>
<li><code>unexpand</code> : convert spaces to tabs</li>
<li><code>uniq</code>     : report or omit repeat lines</li>
<li><code>wc</code>       : print newline, word, and byte counts for each file</li>
</ul>
<p>We will also discuss two types of operators, the pipe and the redirect.
The latter has a version that will write over the contents of a file,
and a version that will append contents to the end of a file:</p>
<ul>
<li><code>|</code> : redirect standard output from command1 to standard input for command2</li>
<li><code>&gt;</code> : redirect to standard output to a file, overwriting</li>
<li><code>&gt;&gt;</code> : redirect to standard output to a file, appending</li>
</ul>
<p>Today I want to cover a few of the above commands for processing data in a file;
specifically:</p>
<ul>
<li><code>cat</code>  : concatenate files and print on the standard output</li>
<li><code>cut</code>  : remove sections from each line of files</li>
<li><code>head</code> : output the first part of files</li>
<li><code>sort</code> : sort lines of text files</li>
<li><code>tail</code> : output the last part of files</li>
<li><code>uniq</code> : report or omit repeat lines</li>
<li><code>wc</code>   : print newline, word, and byte counts for each file</li>
</ul>
<p>Let's look at a toy, sample file that contains
structured data as a CSV (comma separated value) file.
The file contains a list of operating systems (column one),
their software license (column two),
and the year they were released (column three).
We can use the <code>cat</code> command to view the entire
contents of this small file:</p>
<p><strong>Command:</strong></p>
<pre><code>cat operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
Linux, GPL, 1991
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>It's a small file, but
we might want the line and word count of the file.
To acquire that, we can use the <code>wc</code> (word count) command.
By itself, the <code>wc</code> command will print 
the number of lines, words, and bytes of a file.
The following output states that the file contains
seven lines, 23 words, and 165 bytes:</p>
<p><strong>Command:</strong></p>
<pre><code>wc operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>  7  23 165 operating-systems.csv
</code></pre>
<p>We can use the <code>head</code> command to output,
by default,
the first ten lines of a file.
Since our file is only seven lines long,
we can use the <code>-n</code> option 
to change the default number of lines:</p>
<p><strong>Command:</strong></p>
<pre><code>head -n3 operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
Linux, GPL, 1991
</code></pre>
<p>Using the <code>cut</code> command, we can select data from file.
In the first example, I want to select column two (or field two),
which contains the license information.
Since this is a CSV file,
the fields (aka, columns) are separated by commas.
The <code>-d</code> option tells the <code>cut</code> command to use commas
as the separator character.
The <code>-f</code> option tells the <code>cut</code> command to select
field two.
(A CSV file may use other characters as the separator character,
like the Tab character or a colon.)</p>
<p><strong>Command:</strong></p>
<pre><code>cut -d&quot;,&quot; -f2 operating-system.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code> Proprietary
 BSD
 GPL
 Proprietary
 Proprietary
 Proprietary
 Apache
</code></pre>
<p>From there it's trivial to select a different column.
In the next example,
I select field (or column) three to get the release year:</p>
<p><strong>Command:</strong></p>
<pre><code>cut -d&quot;,&quot; -f3 operating-system.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code> 2009
 1993
 1991
 2007
 2001
 1993
 2008
</code></pre>
<p>One of the magical aspects of the Linux (and Unix) commandline
is the ability to <strong>pipe</strong> and <strong>redirect</strong> output from one program
to another program, and then to a file.
By stringing together multiple programs with these operators,
we can create small programs that do much more than the
simple programs that compose them.
In this next example,
I use the pipe operators to send the output of the <code>cut</code>
command to the <code>sort</code> command,
which sorts the data in alphabetical or numerical order,
depending on the character type (lexical or numerical),
pipe that output to the <code>uniq</code> command,
which removes duplicate rows,
and then redirect that final output to a new
file titled <strong>os-years.csv</strong>.
Since the year <strong>1993</strong> appears twice in the original file,
it only appears once in the output
because the <code>uniq</code> command removed the duplicate:</p>
<p><strong>Command:</strong></p>
<pre><code>cut -d&quot;,&quot; -f3 operating-system.csv | sort | uniq &gt; os-years.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>cat os-years.csv
 1991
 1993
 2001
 2007
 2008
 2009
</code></pre>
<p>Data files like this often have a
header line at the top row that
names the data columns.
It's useful to know how
to work with such files, so
let's add a header row to the top of the file.
In this example,
I'll use the <code>sed</code> command,
which we will learn more about in the
next lesson.
For now,
we use <code>sed</code> with the option <code>-i</code>
to edit the file,
then <code>1i</code> instructs <code>sed</code> to <strong>insert</strong>
text at <strong>line 1</strong>.
<code>\OS, License, Year</code> is the text
that we want inserted at line 1.
We wrap the argument within single quotes:</p>
<p><strong>Command:</strong></p>
<pre><code>sed -i '1i \OS, License, Year' operating-systems.csv
cat operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>OS, License, Year
Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
Linux, GPL, 1991
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>Since the CSV file now has a header line,
we want to remove it from the output.
Say we want the license field data,
but we need to remove that first line.
In this case, we need the tail command:</p>
<p><strong>Command:</strong></p>
<pre><code>tail -n +2 operating-system-csv | cut -d&quot;,&quot; -f2 | sort | uniq &gt; license-data.csv
cat license-data.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code> Apache
 BSD
 GPL
 Proprietary
</code></pre>
<blockquote>
<p>The <code>tail</code> command generally outputs the last lines of a file,
but the <code>-n +2</code> option is special.
It makes the <code>tail</code> command ouput a file starting
at the second line.
We could specify a different number in order
to start output at a different line.
See <code>man tail</code> for more information.</p>
</blockquote>
<h2 id="conclusion-5"><a class="header" href="#conclusion-5">Conclusion</a></h2>
<p>In this lesson, we learned how to process and
make sense of data held in a text file.
We used some commands that let us select,
sort, de-duplicate, redirect, and view data in different ways.
Our data file was a small one,
but these are powerful and useful command and operators
that would easily make sense of large amounts of data
in a file.</p>
<p>The commands we used in this lesson include:</p>
<ul>
<li><code>cat</code>  : concatenate files and print on the standard output</li>
<li><code>cut</code>  : remove sections from each line of files</li>
<li><code>head</code> : output the first part of files</li>
<li><code>sort</code> : sort lines of text files</li>
<li><code>tail</code> : output the last part of files</li>
<li><code>uniq</code> : report or omit repeat lines</li>
<li><code>wc</code>   : print newline, word, and byte counts for each file</li>
</ul>
<p>We also used two types of operators, the pipe and the redirect:</p>
<ul>
<li><code>|</code> : redirect standard output command1 to standard input of command2</li>
<li><code>&gt;</code> : redirect to standard output to a file, overwriting</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="text-processing-part-2"><a class="header" href="#text-processing-part-2">Text Processing: Part 2</a></h1>
<h2 id="introduction-2"><a class="header" href="#introduction-2">Introduction</a></h2>
<p>In the last section, we covered the
<code>cat</code>, <code>cut</code>, <code>head</code>, <code>sort</code>, <code>tail</code>, <code>uniq</code>, and <code>wc</code> utilities.</p>
<p>We also learned about the <code>|</code> pipe operator,
which we use to redirect <strong>standard output</strong>
from one command
to a second command so that second command
can process the output from the first command.
An example is:</p>
<pre><code>sort file.txt | uniq
</code></pre>
<p>This sorts the lines in a file named <strong>file.txt</strong> and
then prints to standard output only the unique lines
(by the way, files must be sorted before piped to <code>uniq</code>).</p>
<p>We learned about the <code>&gt;</code> and <code>&gt;&gt;</code> redirect operators.
They work like the pipe operator, but
instead of directing output to a new command
for the new command to process,
they direct output to a file for saving.
As a reminder,
the single redirect <code>&gt;</code> overwrites a file or creates a file
if it does not exist.
The double redirect <code>&gt;&gt;</code> appends to a file or
creates a file if it does not exist.
It's safer to use the double redirect, but
if you are processing large amounts of data,
it could also mean creating large files really quickly.
If that gets out of hand,
then you might crash your system.
To build on our prior example,
we can add <code>&gt;&gt;</code> to send the output to
a new file called <strong>output.txt</strong>:</p>
<pre><code>sort file.txt | uniq &gt;&gt; output.txt
</code></pre>
<p>We have available more powerful utilities and programs
to process, manipulate, and analyze text files.
In this section, we will cover the following three of these:</p>
<ul>
<li><code>grep</code> : print lines that match patterns</li>
<li><code>sed</code>  : stream editor for filtering and transforming text</li>
<li><code>awk</code>  : pattern scanning and text processing language</li>
</ul>
<h2 id="grep"><a class="header" href="#grep">Grep</a></h2>
<p>The <code>grep</code> command is one of my most often used commands.
Basically, <code>grep</code> &quot;prints lines that match patterns&quot;
(see <code>man grep</code>).
In other words, it's search, and
it's super powerful.</p>
<p><code>grep</code> works line by line.
So when we use it to search a file for a <strong>string</strong> of text,
it will return the whole line that matches the string.
This <strong>line by line</strong> idea is part of the history of
Unix-like operating systems,
and it's super important to remember that most utilities
and programs that we use on the commandline
are line oriented.</p>
<blockquote>
<p>&quot;A string is any series of characters that are interpreted
literally by a script. For example, 'hello world' and 'LKJH019283'
are both examples of strings.&quot; -- <a href="https://www.computerhope.com/jargon/s/string.htm">Computer Hope</a>.
More generally, it's the literal characters that we type. It's data.</p>
</blockquote>
<p>Let's consider the file <strong>operating-systems.csv</strong>, as seen below:</p>
<pre><code>OS, License, Year
Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
Linux, GPL, 1991
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>If we want to search for the string <strong>Chrome</strong>,
we can use <code>grep</code>.
Notice that even though the string <strong>Chrome</strong> only appears once,
and in one part of a line,
<code>grep</code> returns the entire line.</p>
<p><strong>Command:</strong></p>
<pre><code>grep &quot;Chrome&quot; operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Chrome OS, Proprietary, 2009
</code></pre>
<p>Be aware that, by default, <code>grep</code> is case-sensitive,
which means a search for the string <strong>chrome</strong>,
with a lower case <strong>c</strong>,
would return no results.
Fortunately, <code>grep</code> has an <code>-i</code> option,
which means to ignore the case of the search string.
In the following examples, <code>grep</code> returns nothing in the first search
since we do not capitalize the string <strong>chrome</strong>.
However, adding the <code>-i</code> option results in success:</p>
<p><strong>Command:</strong></p>
<pre><code>grep &quot;chrome&quot; operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<p>None.</p>
<p><strong>Command:</strong></p>
<pre><code>grep -i &quot;chrome&quot; operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Chrome OS, Proprietary, 2009
</code></pre>
<p>We can also search for lines that <strong>do not</strong> match our string 
using the <code>-v</code> option.
We can combine that with the <code>-i</code> option to ignore the string's case.
Therefore, in the following example,
all lines that do not contain the string <strong>chrome</strong> are returned:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -vi &quot;chrome&quot; operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>FreeBSD, BSD, 1993
Linux, GPL, 1991
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>I used the <code>tail</code> command in the prior section to show
how we might use <code>tail</code> to remove the header (1st line) line in a file,
but it's an odd use of the <code>tail</code> command,
which normally just returns the last lines of a file.
Instead, we can use <code>grep</code> to remove the first line.
To do so, we use what's called a <strong>regular expression</strong>,
or <strong>regex</strong> for short.
Regex is a method used to identify patterns in text via abstractions.
They can get complicated, but we can use some easy regex methods.</p>
<p>Let's use a version of the above file with the header line:</p>
<p><strong>Command:</strong></p>
<pre><code>cat operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>OS, License, Year
Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
Linux, GPL, 1991
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>To use <code>grep</code> to remove the first line of a file,
we can invert our search to select all lines not matching
&quot;OS&quot; at the start of a line.
Here the carat key <code>^</code> is a <strong>regex</strong> indicating the
start of a line.
Again, this <code>grep</code> command returns all lines that
do not match the string <strong>os</strong> at the start of a line,
ignoring case:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -vi &quot;^os&quot; operating-systems.csv
</code></pre>
<p><strong>Output</strong>:</p>
<pre><code>Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
Linux, GPL, 1991
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>Alternatively, since we know that the string <strong>Year</strong> comes
at the end of the first line,
we can use <code>grep</code> to invert search for that.
Here the dollar sign key <code>$</code> is a <strong>regex</strong> indicating the
end of a line.
Like the above, this <code>grep</code> command returns all lines that
do not match the string <strong>year</strong> at the end of a line,
ignoring case:</p>
<p><strong>Command</strong>:</p>
<pre><code>grep -vi &quot;year$&quot; operating-systems.csv
</code></pre>
<p><strong>Output</strong>:</p>
<pre><code>Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
Linux, GPL, 1991
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>The <code>man grep</code> page lists other options,
but a couple of other good ones include:</p>
<p>Get a count of the matching lines with the <code>-c</code> option:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -ic &quot;proprietary&quot; operating-systems.csv
</code></pre>
<p><strong>Output</strong>:</p>
<pre><code>4
</code></pre>
<p>Print only the match and not the whole line with the <code>-o</code> option:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -io &quot;proprietary&quot; operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Proprietary
Proprietary
Proprietary
Proprietary
</code></pre>
<p>We can simulate a Boolean OR search, and
print lines matching one or both strings
using the <code>-E</code> option.
We separate the strings with a vertical bar <code>|</code>.
This is similar to a Boolean OR search
since there's at least one match in the following string,
there is at least one result.</p>
<p>Here is an example where only one string
returns a true value:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -Ei &quot;bsd|atari&quot; operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>FreeBSD, BSD, 1993
</code></pre>
<p>Here's an example where both strings evaluate to true:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -Ei &quot;bsd|gpl&quot; operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>FreeBSD, BSD, 1993
Linux, GPL, 1991
</code></pre>
<p>By default, <code>grep</code> will return results where the
string appears within a larger word,
like <strong>OS</strong> in <strong>macOS</strong>.</p>
<p><strong>Command:</strong></p>
<pre><code>grep -i &quot;os&quot; operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>OS, License, Year
Chrome OS, Proprietary, 2009
iOS, Proprietary, 2007
macOS, Proprietary, 2001
</code></pre>
<p>However, we might want to limit results so that
we only return results where <strong>OS</strong> is a complete word.
To do that, we can surround the string with
special characters:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -i &quot;\&lt;os\&gt;&quot; operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>OS, License, Year
Chrome OS, Proprietary, 2009
</code></pre>
<p>Sometimes we want to the context for a result;
that is,
we might want to print lines that surround our matches.
For example, print the matching line plus the two lines
after the matching line using the <code>-A NUM</code> option:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -i &quot;chrome&quot; -A 2 operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
Linux, GPL, 1991
</code></pre>
<p>Or, print the matching line plus the two lines
before the matching line using the <code>-B NUM</code> option:</p>
<p><strong>Command</strong></p>
<pre><code>grep -i &quot;android&quot; -B 2 operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>We can combine many of the variations.
Here I search for the whole word <strong>BSD</strong>,
case insensitive, and
print the line before and the line after
the match:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -i -A 1 -B 1 &quot;\&lt;bsd\&gt;&quot; operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
Linux, GPL, 1991
</code></pre>
<p><code>grep</code> is very powerful, and
there are more options listed in its <code>man</code> page.</p>
<blockquote>
<p>Note that I enclose my search strings in double quotes.
For example: <code>grep &quot;search string&quot; filename.txt</code>
It's not always required to enclose a search string
in double quotes,
but it's good practice because
if your string contains more than one word or
empty spaces, the search will fail.</p>
</blockquote>
<h2 id="sed"><a class="header" href="#sed">Sed</a></h2>
<p><code>sed</code> is a type of non-interactive text editor
that filters and transforms text (<code>man sed</code>).
By default <code>sed</code> works on <strong>standard output</strong>,
and edits can be redirected (<code>&gt;</code> or <code>&gt;&gt;</code>) to new files
or, more appropriately,
made <strong>in-place</strong> using the <code>-i</code> option.</p>
<p>Like the other utilities and programs we've covered,
including <code>grep</code>,
<code>sed</code> works line by line.
But unlike <code>grep</code>,
<code>sed</code> provides a way to <strong>address</strong>
specific lines or ranges of lines,
and then run filters or transformations on those lines.
Once the lines in a text file have been identified or addressed,
<code>sed</code> offers a number of commands to filter or transform the text
at those specific lines.</p>
<p>This concept of the line address is important, but
not all text files are explicitly numbered by each line.
Below I use the <code>nl</code> command to number lines in our file,
even though the contents of the file do not actually display line numbers:</p>
<p><strong>Command:</strong></p>
<pre><code>nl operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>     1	OS, License, Year
     2	Chrome OS, Proprietary, 2009
     3	FreeBSD, BSD, 1993
     4	Linux, GPL, 1991
     5	iOS, Proprietary, 2007
     6	macOS, Proprietary, 2001
     7	Windows NT, Proprietary, 1993
     8	Android, Apache, 2008
</code></pre>
<p>After we've identified the lines in a file that we want to edit,
<code>sed</code> offers commands to filter, transform, or edit
the text at the line addresses.
Some of these commands include:</p>
<ul>
<li><code>a</code> : appending text</li>
<li><code>c</code> : replace text</li>
<li><code>d</code> : delete text</li>
<li><code>i</code> : inserting text</li>
<li><code>p</code> : print text</li>
<li><code>r</code> : append text from file</li>
<li><code>s</code> : substitute text</li>
<li><code>=</code> : print the current line number</li>
</ul>
<p>Let's see how to use <code>sed</code> to print line numbers
instead of using the <code>nl</code> command.
To do so, we use the equal sign <code>=</code> to
identify line numbers
(although note that it places the line numbers
just above each line):</p>
<p><strong>Command:</strong></p>
<pre><code>sed '=' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>1
OS, License, Year
2
Chrome OS, Proprietary, 2009
3
FreeBSD, BSD, 1993
4
Linux, GPL, 1991
5
iOS, Proprietary, 2007
6
macOS, Proprietary, 2001
7
Windows NT, Proprietary, 1993
8
Android, Apache, 2008
</code></pre>
<p>In the last section,
we used the <code>tail</code> command to
remove the header line of our file, and above,
we used <code>grep</code> to accomplish this task.
It's much easier to use <code>sed</code>
to remove the header line of the <strong>operating-systems.csv</strong>.
We simply specify the line number (<code>1</code>) and
then use the delete command (<code>d</code>).
Thus, we delete line 1:</p>
<p><strong>Command:</strong></p>
<pre><code>sed '1d' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
Linux, GPL, 1991
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<blockquote>
<p>Note that I use single apostrophes for the <code>sed</code> command.
This is required.</p>
</blockquote>
<p>If I wanted to make that a permanent deletion,
then I would use the <code>-i</code> option,
which means that I would edit the file <strong>in-place</strong>
(see <code>man sed</code>):</p>
<p><strong>Command:</strong></p>
<pre><code>sed -i '1d' operating-system.csv
</code></pre>
<p>To refer to line <strong>ranges</strong>,
I add a comma between <strong>addresses</strong>.
Therefore, to edit lines 1, 2, and 3:</p>
<p><strong>Command:</strong></p>
<pre><code>sed '1,3d' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Linux, GPL, 1991
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>I can use <code>sed</code> to <strong>find and replace</strong> strings.
The syntax for this is:</p>
<pre><code>sed 's/regexp/replacement/' filename.txt
</code></pre>
<p>The <strong>regexp</strong> part of the above command can take
regular expressions, but
simple strings like words work here, too,
since they are treated as
regular expressions themselves.</p>
<p>In the next example,
I use <code>sed</code> to search for the string &quot;Linux&quot;,
and replace it with the string &quot;GNU/Linux&quot;:</p>
<p><strong>Command:</strong></p>
<pre><code>sed 's/Linux/GNU\/Linux/' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>OS, License, Year
Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
GNU/Linux, GPL, 1991
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<blockquote>
<p>Because the string <strong>GNU/Linux</strong> contains a forward slash, and because
<code>sed</code> uses the forward slash as a separator, note that I <strong>escaped</strong> the
forward slash with a back slash. This escape tells <code>sed</code> to interpret the
forward slash in <strong>GNU/Linux</strong> literally and not as a special <code>sed</code>
character.</p>
</blockquote>
<p>If we want to add new rows to the file,
we can append <code>a</code> or insert <code>i</code>
text after or at specific lines:</p>
<p>To append text <strong>after line 3</strong>, use <code>a</code>:</p>
<p><strong>Command:</strong></p>
<pre><code>sed '3a FreeDOS, GPL, 1998' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>OS, License, Year
Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
FreeDOS, GPL, 1998
Linux, GPL, 1991
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>To insert <strong>at line 3</strong>, use <code>i</code>:</p>
<p><strong>Command:</strong></p>
<pre><code>sed '3i CP\/M, Proprietary, 1974' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>OS, License, Year
Chrome OS, Proprietary, 2009
CP/M, Proprietary, 1974
FreeBSD, BSD, 1993
Linux, GPL, 1991
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>Note that the FreeDOS line doesn't appear
in the last output.
This is because I didn't use the <code>-i</code> option nor 
did I redirect output to a new file.
If we want to edit the file <strong>in-place</strong>,
that is, save the edits,
then the commands would look like so:</p>
<pre><code>sed -i '3a FreeDOS, GPL, 1998' operating-systems.csv
sed -i '3i CP\/M, Proprietary, 1974' operating-systems.csv
</code></pre>
<p>Instead of using line numbers to specify
addresses in a text file,
we can use regular expressions as addresses,
which may be simple words.
In the following example,
I use the regular expression <code>1991$</code>
instead of specifying line 4.
The regular expression <code>1991$</code>  means
&quot;lines ending with the string <strong>1991</strong>&quot;.
Then I use the <code>s</code> command to start a find and replace.
<code>sed</code> finds the string <strong>Linux</strong> and then replaces
that with the string <strong>GNU/Linux</strong>.
I use the back slash to escape the
forward slash in GNU/Linux: </p>
<p><strong>Command:</strong></p>
<pre><code>sed '/1991$/s/Linux/GNU\/Linux/' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>OS, License, Year
Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
GNU/Linux, GPL, 1991
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>Here's an example using <code>sed</code> to
simply search for a pattern.
In this example,
I'm interested in searching for all operating systems
that were released on or after 2000:</p>
<p><strong>Command:</strong></p>
<pre><code>sed -n '/20/p' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Chrome OS, Proprietary, 2009
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Android, Apache, 2008
</code></pre>
<p>The above would be equivalent to
<code>grep &quot;20&quot; operating-systems.csv</code>.</p>
<p><code>sed</code> is much more powerful than
what I've demonstrated here, and
if you're interested in learning more,
there are lots of tutorials on the web.
Here are a few good ones:</p>
<ul>
<li><a href="https://opensource.com/article/20/12/sed">Learn to use the Sed text editor</a></li>
<li><a href="https://www.gnu.org/software/sed/manual/sed.html">Sed Introduction</a> </li>
<li><a href="https://catonmat.net/sed-one-liners-explained-part-one">Sed One-Liners Explained, Part I: File Spacing, Numbering and Text Conversion and Substitution</a></li>
<li><a href="https://edoras.sdsu.edu/doc/sed-oneliners.html">sed one-liners</a></li>
<li><a href="https://www.tutorialspoint.com/sed/index.htm">Sed Tutorial</a></li>
</ul>
<h2 id="awk"><a class="header" href="#awk">Awk</a></h2>
<p><code>awk</code> is a complete scripting language designed for
&quot;pattern scanning and processing&quot; text.
It generally performs some <strong>action</strong> when
it detects some <strong>pattern</strong> and
is particularly suited for <strong>columns of structured data</strong>
(see <code>man awk</code>).</p>
<p><code>awk</code> works on columns 
regardless if the contents include structured data 
(like a CSV file) or not (like a letter or essay).
If the data is structured,
then that means the data will be formatted in some way.
In the last few sections,
we have looked at a CSV file.
This is structured data because the data points 
in this file are separated by commas.</p>
<p>For <code>awk</code> to work with columns in a file,
it needs some way to refer to those columns.
In the examples below, we'll see that columns in a text 
file are referred to by a dollar sign and
then the number of the column <code>$n</code>.
So, <code>$1</code> indicates column one, 
<code>$2</code> indicates column two, and so on.
If we use <code>$0</code>, then we refer to the entire file.
In our example text file,
<code>$1</code> indicates the OS Name column,
<code>$2</code> indicates the License column,
<code>$3</code> indicates the release Year column,
and <code>$0</code> indicates all columns.</p>
<p>The syntax for <code>awk</code> is a little different
than what we've seen so far.
Basically, <code>awk</code> uses the following syntax,
where <strong>pattern</strong> is optional.</p>
<pre><code>awk pattern { action statements }
</code></pre>
<p>Let's see some examples.</p>
<p>To print the first column of our file,
we do not need the <strong>pattern</strong> part of the command but
only need to state an action statement
(within curly braces).
In the command below,
the action statement is <code>'{ print $1 }'</code>.</p>
<p><strong>Command:</strong></p>
<pre><code>awk '{ print $1 }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>OS,
Chrome
FreeBSD,
Linux,
iOS,
macOS,
Windows
Android,
</code></pre>
<p>By default,
<code>awk</code> considers the first empty space
as the field delimiter.
That's why in the command above
only the term <strong>Windows</strong> and <strong>Chrome</strong> appear in the results
even though it should be <strong>Windows NT</strong> and <strong>Chrome OS</strong>.
It's also why we see commas in the output.
To fix this,
we tell <code>awk</code> to use a comma as the field separator,
instead of the default empty space.
To specify that we want <code>awk</code>
to treat the comma as a field delimiter,
we use the <code>-F</code> option, and
we surround the comma with single quotes:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '{ print $1 }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>OS
Chrome OS
FreeBSD
Linux
iOS
macOS
Windows NT
Android
</code></pre>
<p>By specifying the comma as the field separator,
our results are more accurate,
and the commas no longer appear either.</p>
<p>Like <code>grep</code> and <code>sed</code>,
<code>awk</code> can do search.
In this next example,
I print the column containing the string <strong>Linux</strong>.
Here I am using the <strong>pattern</strong> part
of the command: <code>'/Linux/'</code>.</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '/Linux/ { print $1 }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Linux
</code></pre>
<p>Note how <code>awk</code> does not return the whole
line but only the match.</p>
<p>With <code>awk</code>,
we can retrieve more than one column, and
we can use <code>awk</code> to generate reports,
which was part of the original motivation
to create this language.</p>
<p>In the next example,
I select columns two and one in that order,
which is something the <code>cut</code> command cannot do.
I also add a space between the columns
using the double quotes to surround an empty space,
and I modified the field delimiter to include both
a comma and a space to get the output that I want:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F', ' '{ print $2 &quot; &quot; $1 }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>License OS
Proprietary Chrome OS
BSD FreeBSD
GPL Linux
Proprietary iOS
Proprietary macOS
Proprietary Windows NT
Apache Android
</code></pre>
<p>I can make output more readable by adding
text to print:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '{ print $1 &quot; was released in&quot; $3 &quot;.&quot; }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>OS was released in Year.
Chrome OS was released in 2009.
FreeBSD was released in 1993.
Linux was released in 1991.
iOS was released in 2007.
macOS was released in 2001.
Windows NT was released in 1993.
Android was released in 2008.
</code></pre>
<p>Since <code>awk</code> is a full-fledged programming language,
it understands data structures,
which means it can do math or work on strings of text.
Let's illustrate this by doing some math
or logic on column 3.</p>
<p>Here I print all of column three:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '{ print $3 }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code> Year
 2009
 1993
 1991
 2007
 2001
 1993
 2008
</code></pre>
<p>Next I print only the parts of column three that
are greater than 2005, and
then pipe <code>|</code> the output through the <code>sort</code> command
to sort the numbers in numeric order:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '$3 &gt; 2005 { print $3 }' operating-systems.csv | sort
</code></pre>
<p><strong>Output:</strong></p>
<pre><code> 2007
 2008
 2009
</code></pre>
<p>If I want to print only the parts of column one where
column three equals to 2007,
then I would run this command:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '$3 == 2007 { print $1 }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>iOS
</code></pre>
<p>If I want to print only the parts of columns one and three
where column 3 equals 2007:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '$3 == 2007 { print $1 $3 }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>iOS 2007
</code></pre>
<p>Or, print the entire line where column three equals 2007:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '$3 == 2007 { print $0 }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>iOS, Proprietary, 2007
</code></pre>
<p>I can print only those lines where column three
is greater than 2000 and less than 2008:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '$3 &gt; 2000 &amp;&amp; $3 &lt; 2008 { print $0 }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>iOS, Proprietary, 2007
macOS, Proprietary, 2001
</code></pre>
<p>Even though we wouldn't normally sum years,
let's print the sum of column three 
to demonstrate how summing works in <code>awk</code>:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' 'sum += $3 { print sum }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>2009
4002
5993
8000
10001
11994
14002
</code></pre>
<p>Here are a few basic string operations.
First, print column one in upper case:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '{ print toupper($1) }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>OS
CHROME OS
FREEBSD
LINUX
IOS
MACOS
WINDOWS NT
ANDROID
</code></pre>
<p>Or print column on in lower case:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '{ print tolower($1) }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>os
chrome os
freebsd
linux
ios
macos
windows nt
android
</code></pre>
<p>Or, get the length of each string in column one:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '{ print length($1) }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>2
9
7
5
3
5
10
7
</code></pre>
<p>We can add additional logic.
The double ampersands <code>&amp;&amp;</code> indicate a
Boolean/Logical <strong>AND</strong>.
The exclamation point <code>!</code> indicates a
Boolean/Logical <strong>NOT</strong>.
In the next example,
I print only those lines where
column three is greater than 1990,
and the line has the string &quot;BSD&quot; in it:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '$3 &gt; 1990 &amp;&amp; /BSD/ { print $0 }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>FreeBSD, BSD, 1993
</code></pre>
<p>Now I reverse that, and
print only those lines where column three
is greater than 1990
and the line DOES NOT have the string &quot;BSD&quot; in it:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '$3 &gt; 1990 &amp;&amp; !/BSD/ { print $0 }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Chrome OS, Proprietary, 2009
Linux, GPL, 1991
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>The double vertical bar <code>||</code> indicates
a Boolean/Logical <strong>OR</strong>.
The next command prints only those lines that
contain the string &quot;Proprietary&quot;
or the string &quot;Apache&quot;,
or it would print both if both strings were in the text:</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '/Proprietary/ || /Apache/ { print $0 }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Chrome OS, Proprietary, 2009
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>I can take advantage of regular expressions.
If the file that I was looking at was large,
and if I wasn't sure that some fields
would be upper or lower case,
then I could use regular expressions
to consider both possibilities.
That is, by adding <strong>[pP]</strong> and <strong>[aA]</strong>,
<code>awk</code> will check for both the words <strong>Proprietary</strong>
and <strong>proprietary</strong>,
and <strong>Apache</strong> and <strong>apache</strong>.</p>
<p><strong>Command:</strong></p>
<pre><code>awk -F',' '/[pP]roprietary/ || /[aA]pache/ { print $0 }' operating-systems.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Chrome OS, Proprietary, 2009
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p><code>awk</code> is full-fledged programming language.
It provides conditionals, control structures, variables, etc.,
and so I've only scratched the surface.
If you're interested in learning more,
then check out some of these tutorials:</p>
<ul>
<li><a href="https://www.tecmint.com/category/awk-command/">Awk Command</a></li>
<li><a href="https://catonmat.net/awk-one-liners-explained-part-one">Awk One-Liners Explained, Part I: File Spacing, Numbering and Calculations</a></li>
<li><a href="https://www.grymoire.com/Unix/Awk.html">Awk Tutorial</a></li>
<li><a href="https://blog.robertelder.org/intro-to-awk-command/">How To Become a 10x Engineer using the Awk Command</a></li>
<li><a href="https://arstechnica.com/gadgets/2021/08/linux-bsd-command-line-101-using-awk-sed-and-grep-in-the-terminal/">Linux/BSD command line wizardry: Learn to think in sed, awk, and grep</a></li>
<li><a href="https://earthly.dev/blog/awk-examples/">Understanding AWK</a></li>
</ul>
<h2 id="conclusion-6"><a class="header" href="#conclusion-6">Conclusion</a></h2>
<p>The Linux (and other Unix-like OSes) command line
offers a lot of utilities to examine data.
Prior to this lesson, we covered a few of
them that help us get
parts of a file and then pipe those parts
through other commands
or redirect output to files.
We can use pipes and redirects with
<code>grep</code>, <code>sed</code>, and <code>awk</code>.
If needed, we may be able to avoid using
the basic utilities like
<code>cut</code>, <code>wc</code>, etc if want to learn more powerful programs
like <code>grep</code>, <code>sed</code>, and <code>awk</code>.</p>
<p>It's fun to learn and practice these.
Despite this, you do not have to become
a <code>sed</code> or an <code>awk</code> programmer.
Like the utilities that we've discussed in prior lectures,
the power of programs like these is that their on hand and
easy to use as <strong>one-liners</strong>.
If you want to get started,
the resources listed above can guide you.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="review"><a class="header" href="#review">Review</a></h1>
<p>Here is a review of commands
and concepts that we have 
covered so far.</p>
<h2 id="commands"><a class="header" href="#commands">Commands</a></h2>
<p>We have covered the following
commands so far:</p>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Example</th><th>Explanation</th></tr></thead><tbody>
<tr><td>tree</td><td>tree -dfL 1</td><td>List directories, full path, one level</td></tr>
<tr><td>cd</td><td>cd ~</td><td>change to home directory</td></tr>
<tr><td></td><td>cd /</td><td>change to root directory</td></tr>
<tr><td></td><td>cd bin</td><td>change to bin directory from current directory</td></tr>
<tr><td>pwd</td><td>pwd</td><td>print working / current directory</td></tr>
<tr><td>ls</td><td>ls ~</td><td>list home directory contents</td></tr>
<tr><td></td><td>ls -al</td><td>list long format and hidden files in current directory</td></tr>
<tr><td></td><td>ls -dl</td><td>list long format the current directory</td></tr>
<tr><td>man</td><td>man ls</td><td>open manual page for the ls command</td></tr>
<tr><td></td><td>man man</td><td>open manual page for the man command</td></tr>
<tr><td>cp</td><td>cp * bin/</td><td>copy all files in current directory to bin subdir</td></tr>
<tr><td>mv</td><td>mv oldname newname</td><td>rename file oldname to newname</td></tr>
<tr><td></td><td>mv oldir bin/newdir</td><td>move oldman to bin subdir and rename to newdir</td></tr>
<tr><td>rm</td><td>rm oldfile</td><td>delete file named oldfile</td></tr>
<tr><td></td><td>rm -r olddir</td><td>delete directory olddir and its contents</td></tr>
<tr><td>touch</td><td>touch newfile</td><td>create a file called newfile</td></tr>
<tr><td></td><td>touch oldfile</td><td>modify timestamp of file called oldfile</td></tr>
<tr><td>mkdir</td><td>mkdir newdir</td><td>create a new directory called newdir</td></tr>
<tr><td>rmdir</td><td>rmdir newdir</td><td>delete directory called newdir if empty</td></tr>
<tr><td>echo</td><td>echo &quot;hello&quot;</td><td>print &quot;hello&quot; to screen</td></tr>
<tr><td>cat</td><td>cat data.csv</td><td>print contents of file called data.csv to screen</td></tr>
<tr><td></td><td>cat data1.csv data2.csv</td><td>concatenate data1.csv and data2.csv to screen</td></tr>
<tr><td>less</td><td>less file</td><td>view contents of file called file</td></tr>
<tr><td>sudo</td><td>sudo command</td><td>run command as superuser</td></tr>
<tr><td>chown</td><td>sudo chown root:root file</td><td>change owner and group to root of file file</td></tr>
<tr><td>chmod</td><td>chmod 640 file</td><td>change permissions of file to -rw-r-----</td></tr>
<tr><td></td><td>chmod 775 somedir</td><td>change permissions of of somedir to drwxrwxr-x</td></tr>
<tr><td>groups</td><td>groups user</td><td>print the groups the user is in</td></tr>
<tr><td>wc</td><td>wc -l file</td><td>print number of lines of file</td></tr>
<tr><td></td><td>wc -w file</td><td>print number of words of file</td></tr>
<tr><td>head</td><td>head file</td><td>print top ten lines of file</td></tr>
<tr><td></td><td>head -n3 file</td><td>print top three lines of file</td></tr>
<tr><td>tail</td><td>tail file</td><td>print bottom ten lines of file</td></tr>
<tr><td></td><td>tail -n3 file</td><td>print bottom three lines of file</td></tr>
<tr><td>cut</td><td>cut -d&quot;,&quot; -f2 data.csv</td><td>print second column of file data.csv</td></tr>
<tr><td>sort</td><td>sort -n file</td><td>sort file by numerical order</td></tr>
<tr><td></td><td>sort -rn file</td><td>sort file by reverse numerical order</td></tr>
<tr><td></td><td>sort -df file</td><td>sort file by dictionary order and ignore case</td></tr>
<tr><td>uniq</td><td>uniq file</td><td>report or omit repeated lines in sorted file</td></tr>
<tr><td></td><td>uniq -c file</td><td>report count of duplicate lines in sorted file</td></tr>
</tbody></table>
</div>
<p>In addition to the above commands,
we also have pipelines using the <code>|</code>.
Pipelines send the standard output of
one command to a second command
(or more).
The following command sorts the
contents of a file and then
sends the output to the <code>uniq</code>
command to remove duplicates:</p>
<pre><code>sort file | uniq
</code></pre>
<p>Redirection uses the <code>&gt;</code> or the <code>&gt;&gt;</code>
to redirect output of a command to a file.
A single <code>&gt;</code> will overwrite the contents
of a file.
A double <code>&gt;&gt;</code> will append to the
contents of a file.</p>
<p>Redirect the output of the <code>ls</code>
command to a file called <strong>dirlist</strong>:</p>
<pre><code>ls &gt; dirlist
</code></pre>
<p>Append the date to the end of
the file <strong>dirlist</strong>:</p>
<pre><code>date &gt;&gt; dirlist
</code></pre>
<h2 id="paths"><a class="header" href="#paths">Paths</a></h2>
<p>I introduced the concept of absolute and relative paths
in <a href="03-filesystem-file-management.html">section 2.3</a>.
In this session, the goal is to revisit paths
(locations of files and directories in the filesystem),
and provide some examples.
This will be important as we proceed to Bash scripting
and other tasks going forward.</p>
<h3 id="change-directories"><a class="header" href="#change-directories">Change Directories</a></h3>
<p>The <code>cd</code> command is used to change directories.
When we login to our systems,
we will find ourselves in our <strong>$HOME</strong> directory,
which is located at <code>/home/USER</code>.</p>
<p>To change to the root directory, type:</p>
<pre><code>pwd
/home/sean
cd /
pwd
/
</code></pre>
<p>From there, to change to the <code>/bin</code> directory:</p>
<pre><code>cd bin
pwd
/bin
</code></pre>
<p>To change to the previous working directory:</p>
<pre><code>cd -
pwd
/
</code></pre>
<p>To go home quickly, just enter <code>cd</code> by itself:</p>
<pre><code>cd
pwd
/home/sean
</code></pre>
<p>To change to the <code>public_html</code> directory:</p>
<pre><code>cd public_html
pwd
/home/sean/public_html
</code></pre>
<p>To change to the directory one level up:</p>
<pre><code>cd ..
pwd
cd /home/sean
</code></pre>
<h2 id="make-directories"><a class="header" href="#make-directories">Make Directories</a></h2>
<p>Sometimes we'll want to create new directories.
To do so, we use the <code>mkdir</code> command.</p>
<p>To make a new directory in our <strong>$HOME</strong> directory:</p>
<pre><code>pwd
/home/sean
mkdir documents
cd documents
pwd
/home/sean/documents
cd
pwd
/home/sean
</code></pre>
<p>To make more than one directory at the same time,
where the second or additional directories are nested,
use the <code>-p</code> option:</p>
<pre><code>mkdir -p photos/2022
</code></pre>
<h2 id="remove-or-delete-files-and-directories"><a class="header" href="#remove-or-delete-files-and-directories">Remove or Delete Files and Directories</a></h2>
<p>To remove a file, we use the <code>rm</code> command.
If the file is in a subdirectory,
specify the relative path:</p>
<pre><code>pwd
/home/sean
rm public_html/index.html
</code></pre>
<p>To remove a file in a directory one level up,
use the <code>..</code> notation.
For example, if I'm in my <strong>documents</strong> directory,
and I want to delete a file in my home (parent) directory:</p>
<pre><code>cd documents
pwd
/home/sean/documents
rm ../file.txt
</code></pre>
<p>Alternatively, I could the tilde as shorthand for <strong>$HOME</strong>:</p>
<pre><code>rm ~/file.txt
</code></pre>
<p>To remove a file nested in multiple subdirectories,
just specify the path (absolute or relative).</p>
<pre><code>rm photos/2022/05/22/IMG_2022_05_22.jpg
</code></pre>
<p>Remember that the <code>rm</code> command deletes files and directories.
Use it with caution,
or with the <code>-i</code> option.</p>
<h2 id="copy-files-or-directories"><a class="header" href="#copy-files-or-directories">Copy Files or Directories</a></h2>
<p>Let's say I want to copy a file in my <strong>$HOME</strong> directory
to a nested directory:</p>
<pre><code>cp file.txt documents/ICT418/homework/
</code></pre>
<p>Or, we can copy a file from one subdirectory to another.
Here I copy a file in my <code>~/bin</code> directory
to my <code>~/documents</code>directory.
The <code>~</code> (tilde) is shorthand for my <strong>$HOME</strong> directory.</p>
<pre><code>cp ~/bin/file.txt ~/documents/``
</code></pre>
<h2 id="move-or-rename-files-or-directories"><a class="header" href="#move-or-rename-files-or-directories">Move or Rename Files or Directories</a></h2>
<p>Let's say I downloaded a file to my <code>~/Downloads</code> directory,
and I want to move it to my <code>~/documents</code> directory:</p>
<pre><code>mv ~/Downloads/article.pdf ~/documents/
</code></pre>
<p>Or, let's say we rename it in the process:</p>
<pre><code>mv ~/Downloads/article.pdf ~/documents/article-2022.pdf
</code></pre>
<p>We can also move directories.
Since the commandline is case-sensitive,
let's say I rename the <strong>documents</strong> directory
to <strong>Documents</strong>:</p>
<pre><code>mv ~/documents ~/Documents
</code></pre>
<h2 id="conclusion-7"><a class="header" href="#conclusion-7">Conclusion</a></h2>
<p>Use this page as a reference to
the commands that we have covered
so far.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="scripting-the-command-line"><a class="header" href="#scripting-the-command-line">Scripting the Command Line</a></h1>
<p>We have learned some
of the many commands available
on the Linux command line as
well as how to navigate
around the filesystem.
Now we can begin to learn
how to use command line 
text editors in order
to write Bash scripts.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="text-editors"><a class="header" href="#text-editors">Text editors</a></h1>
<p>Working on the command line
means writing a lot of commands.
But there will be times when we
want to save some of the commands
that we write in order to re-use them later,
or we might want to develop the commands
into a script (i.e., program) because we might
want to automate a process.
The shell is great for writing one off commands,
so-called <strong>one-liners</strong>,
but it's not a great place
to write multi-line or very long commands.
Therefore it can be helpful
to write and save our commands
in a text editor.
In this lesson,
we'll learn about three text editors:
<code>ed</code>, <code>vim</code>, and <code>nano</code>.
Of these,
I'll encourage you to use <code>nano</code>, but
I want you to know something about
<code>ed</code> and <code>vim</code> because
<code>ed</code>, even if not often used,
is historically important
to the Unix and Linux ecosystem.
(I use <code>ed</code> almost daily).
Vim, which is my everyday editor,
is important and
highly used and 
under active development to this day.
If you want to use Vim,
I'd encourage you to do so, but
know that it's not required because
it takes some time and
consistent practice to get good at it.</p>
<p>Another thing to keep
in mind is that
the shell that we are
working with is called <code>bash</code>,
and <code>bash</code> is a
full-fledged programming language.
That means that when we write a simple command,
like <code>cd public_html</code>,
we are programming.
It makes sense that the
more programming that we do,
the better we'll get at it.
This requires 
more sophisticated environments
to help manage our programs
than the command line
prompt can provide.
Text editors fulfill that role.</p>
<p>As we learn more about
how to do systems administration
with Linux,
we will need to edit
configuration files, too.
Most configuration files exist
in the <code>/etc</code> directory.
For example,
later in the semester
we will install the
<a href="https://httpd.apache.org/">Apache Web Server</a>, and
we will need to edit
Apache's configuration
files in the process.
We could do this using
some of the tools
that we've already covered,
like <code>sed</code> and <code>awk</code>,
but it'll make our lives
much easier to use a text editor.</p>
<p>In any case,
in order to save our
commands or edit text files, 
a text editor is very helpful.
Programmers use text editors
to write programs,
but because programmers 
often work in
graphical user environments,
they may often use 
graphical text editors
or graphical <a href="https://en.wikipedia.org/wiki/Integrated_development_environment">IDE</a>s. 
As systems administrators,
it would be unusual to have a
graphical user interface
installed on a server.
The servers that we
manage will contain
limited or specific software
that serves the server's
main purpose.
Additional software on a server
that is not relevant to the
main function of a server
only takes up extra disk space,
consumes valuable computing resources, and
poses an additional security footprint.</p>
<p>As stated,
although <code>ed</code> and <code>vim</code>
are difficult,
they are very powerful editors.
I use both daily, and
am in fact using <code>vim</code>
to write what this.
I believe they are
both worth learning;
however, for the purposes
of this course,
I think it's more important
that you are aware of them.
If you wish to learn more,
there are lots of additional
tutorials on the web
on how to use these
fine, esteemed text editors.</p>
<h2 id="ed"><a class="header" href="#ed"><code>ed</code></a></h2>
<p><code>ed</code> is a line editor
that is installed by default
on many Linux distributions.
Ken Thompson created <code>ed</code>
in the late 1960s
to write the original
Unix operating system.
It was used without computer monitors
because those were still uncommon,
and instead for <a href="https://en.wikipedia.org/wiki/Teleprinter">teletypewriters (TTYs)</a>
and <a href="https://www.youtube.com/watch?v=S81GyMKH7zw">printers</a>.
The lack of a visual display,
like a monitor,
is the reason
that ed(1) was written
as a line editor.
If you visit that second link,
you will see the
terminal interface
from those earlier days.
It is the same basic
interface you are using now
when you use
your terminal applications,
which are virtualised versions
of those old teletypewriters.
I think this is a testament
of the power of the terminal:
that advanced computer users
still use the same
basic technology today.</p>
<p>In practice,
when we use a
line editor like <code>ed</code>,
the main process of
entering text is like
any other editor.
The big difference is
when we need
to manipulate text.
In a graphical text editor,
if we want
to delete a word or
edit some text,
we might backspace
over the text or
highlight a word
and delete it.
In a line editor,
we manipulate text by
referring to lines or
across multiple lines and
then run commands
on the text in those line(s).
This is much
the same process
we followed when
we covered
<code>grep</code>, <code>sed</code>, and <code>awk</code>,
and especially <code>sed</code>, and
it should not
surprise you that
<a href="https://www.oreilly.com/library/view/sed-awk/1565922255/ch02s01.html">these are related</a>.</p>
<p>To operationalize this,
like in <code>sed</code>,
each line has an <strong>address</strong>.
The address for
line 7 is <strong>7</strong>,
and so forth.
Line editors like
<code>ed</code> are command driven. 
There is no menu to
select from at
the top of the <em>window</em>,
and in fact,
when we used <code>ed</code>
to open an existing file,
the text in the file
isn't even printed on the screen.
If a user wants
to delete a word, or
print (to screen) some text,
the user has to command
the line editor
to print the relevant line
by specifying its address and
issuing a command
to delete the word on that line,
or print the line.
Line editors also
work on ranges of line,
including all the
lines in the file,
just like <code>sed</code> does.</p>
<p>In fact,
many of the commands
that <code>ed</code> uses are
also used by <code>sed</code>,
since <code>sed</code> is
based on <code>ed</code> .
To compare:</p>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th><code>sed</code></th><th><code>ed</code></th></tr></thead><tbody>
<tr><td>append text</td><td><code>a</code></td><td><code>a</code></td></tr>
<tr><td>replace text</td><td><code>c</code></td><td><code>c</code></td></tr>
<tr><td>delete text</td><td><code>d</code></td><td><code>d</code></td></tr>
<tr><td>insert text</td><td><code>i</code></td><td><code>i</code></td></tr>
<tr><td>print text</td><td><code>p</code></td><td><code>p</code></td></tr>
<tr><td>substitute text</td><td><code>s</code></td><td><code>s</code></td></tr>
<tr><td>print w/ line #</td><td><code>=</code></td><td><code>n</code></td></tr>
</tbody></table>
</div>
<p>However, there are big
differences that mainly relate
to the fact that
<code>ed</code> is a text editor
and <code>sed</code> is not.
For example,
here are some commands
that mostly make sense in
<code>ed</code> as a text editor.
<code>sed</code> can do
some of these tasks,
where it makes sense
(e.g., we don't quit <code>sed</code>),
but sometimes in a non-trivial way.</p>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th><code>ed</code> only</th></tr></thead><tbody>
<tr><td>edit file</td><td><code>e</code></td></tr>
<tr><td>join lines</td><td><code>j</code></td></tr>
<tr><td>copies lines</td><td><code>t</code></td></tr>
<tr><td>moves lines</td><td><code>m</code></td></tr>
<tr><td>undo</td><td><code>u</code></td></tr>
<tr><td>saves file</td><td><code>w</code></td></tr>
<tr><td>quits <code>ed</code></td><td><code>q</code></td></tr>
<tr><td>Quits <code>ed</code> w/o saving</td><td><code>Q</code></td></tr>
</tbody></table>
</div>
<p>There are other differences,
but these are sufficient for our purposes.</p>
<p>Let's see how to use
<code>ed</code> to open a file, and
print the content with
and without line numbers.</p>
<pre><code>ed operating-systems.csv
183
1,$p
OS, License, Year
Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
Linux, GPL, 1991
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
1,$n
1 OS, License, Year
2 Chrome OS, Proprietary, 2009
3	FreeBSD, BSD, 1993
4	Linux, GPL, 1991
5	iOS, Proprietary, 2007
6	macOS, Proprietary, 2001
7	Windows NT, Proprietary, 1993
8	Android, Apache, 2008
</code></pre>
<p>Using <code>ed</code>,
another way to remove
the header line of the
<strong>operating-systems.csv</strong> file
is to specify the line number (<code>1</code>)
and then the delete command (<code>d</code>),
just like in <code>sed</code>.
This becomes a permanent change
if I save the file
with the <code>w</code> (write) command:</p>
<pre><code>1d
1,$p
Chrome OS, Proprietary, 2009
FreeBSD, BSD, 1993
Linux, GPL, 1991
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
</code></pre>
<p>To refer to line <strong>ranges</strong>,
I add a comma between <strong>addresses</strong>.
Therefore, to delete lines 1, 2, and 3,
and then quit without saving:</p>
<pre><code>1,3d
,p
iOS, Proprietary, 2007
macOS, Proprietary, 2001
Windows NT, Proprietary, 1993
Android, Apache, 2008
Q
</code></pre>
<p>Note that with <code>sed</code>,
in order to make a change <strong>in-place</strong>,
we need to use the <code>-i</code> option.
But with <code>ed</code>,
we save changes
with the <code>w</code> command.</p>
<p>I can use <code>ed</code>
to <strong>find and replace</strong> strings.
The syntax is the same as it is in <code>sed</code>.
I'll start with a fresh version of the file:</p>
<pre><code>ed operating-systems.csv
183
1,$s/Linux/GNU\/Linux/
</code></pre>
<p>If we want to add
new rows to the file,
we can append <code>a</code>
or insert <code>i</code> text 
after or at specific lines.
To append text after
line 3, use <code>a</code>.
We enter a period
on a newline to leave
input mode and return
to command mode:</p>
<pre><code>3a
FreeDOS, GPL, 1998
.
</code></pre>
<p>Because we enter input mode
when using the <code>a</code>, <code>i</code>,
or <code>c</code> commands,
we enter a period <code>.</code> on a line
by itself to revert 
to command mode.</p>
<p>To insert at line 2, use <code>i</code>:</p>
<pre><code>2i
CP/M, Proprietary, 1974
.
</code></pre>
<p>Like <code>sed</code>,
we can also
<strong>find and replace</strong> using
regular expressions instead
of line numbers.
I start a new <code>ed</code> session
to reload the file to start fresh:</p>
<pre><code>ed operating-systems.csv
183
/Linux/s/Linux/GNU\/Linux/
</code></pre>
<p>Of course,
<code>ed</code> can be used
to write and
not simply edit files.
Let's start fresh,
in the following session,
I'll start <code>ed</code>,
enter append mode <code>a</code>,
write a short letter,
exit append mode <code>.</code>,
name the file <code>f</code>,
write <code>w</code> (save) the file,
and quit <code>q</code>:</p>
<pre><code>ed
a
Dear Students,

I hope you find this really interesting.
Feel free to practice and play on the command line,
as well as use tools like ed, the standard editor.

Sincerely,
Dr. Burns
.
f letter.txt
w
q
</code></pre>
<p>It's good to know something
about <code>ed</code> not just
for historical reasons,
but also because
the line editing technology
developed for it
is still in use today,
and is a basic part of
the <code>vim</code> text editor,
which is a very
widely used application.</p>
<h2 id="vim"><a class="header" href="#vim"><code>vim</code></a></h2>
<p>The <code>vim</code> text editor
is an <strong>improved</strong> version of
the <code>vi</code> text editor
and is in fact called <strong>Vi IMproved</strong>.
(The original <code>vi</code> text editor is
usually available via the <code>nvi</code>
editor these days.
<code>nvi</code> is a rewrite
of the original.)
<code>vim</code> is a visual editor.
It is multi-modal like <code>ed</code> and
is a direct descendant through <a href="https://en.wikipedia.org/wiki/Vi">vi</a>.
Due to this genealogy,
<code>vim</code> can use many
of the same commands as <code>ed</code> does
when <code>vim</code> is in command mode.
Like <code>ed</code>,
we can start <code>vim</code> at the Bash prompt
with or without a file name.
Here I will open
the <strong>letter.txt</strong> file with <code>vim</code>.
The default mode is <strong>command mode</strong>:</p>
<pre><code>vim letter.txt
Dear Students,

I hope you find this really interesting.
Feel free to practice and play on the command line,
as well as use tools like ed, the standard editor.

Sincerely,
Dr. Burns
</code></pre>
<p>To enter <strong>insert mode</strong>,
I can type <code>i</code> or <code>a</code>
for <strong>insert</strong> or <strong>append</strong> mode.
There isn't any difference
on an empty file,
but on a file that has text,
<code>i</code> will start <strong>insert</strong>
mode where the cursor lies,
and <strong>a</strong> will start
<strong>insert</strong> mode
right-adjacent to the cursor.
Once in <strong>insert</strong> mode,
you can type text
as you normally would and
use the arrow keys
to navigate around the file.</p>
<p>To return to <strong>command mode</strong> in <code>vim</code>,
you press the <strong>Esc</strong> key.
And then you can enter
commands like you would with <code>ed</code>,
using the same syntax.</p>
<p>Unlike <code>ed</code>,
when in <strong>command mode</strong>,
the commands we type are
not placed wherever the cursor is,
but at the bottom of the screen.
Let's first turn on
line numbers to know
which address is which,
and then we'll
replace <strong>ed</strong> with <strong>Ed</strong>.
Note that I precede
these commands with a colon:</p>
<pre><code>:set number
:5s/ed/Ed/
</code></pre>
<p>One of the more powerful things
about both <code>ed</code> and <code>vim</code> is that
I can call Bash shell
commands from the editors.
Let's say that I wanted
to add the date to my letter file.
To do that,
Linux has a command
called <code>date</code> that
will return today's
date and time.
To call the <code>date</code> command
within Vim and
insert the output
into the file,
I press <strong>Esc</strong> to enter <strong>command mode</strong>
(if I'm not already in it),
enter a colon,
type <code>r</code> for the
read into buffer command,
then enter the shell escape command,
which is an exclamation point <code>!</code>,
and then the Bash shell <code>date</code> command:</p>
<pre><code>:r !date
Dear Students,

I hope you find this really interesting.
Feel free to practice and play on the command line,
as well as use tools like ed, the standard editor.
Thu Jun 30 02:44:08 PM EDT 2022

Sincerely,
Dr. Burns
</code></pre>
<p>Since the last edit I made
was to replace <strong>ed</strong> with <strong>Ed</strong>,
<code>vim</code> entered the date
after that line,
which is line 6.
To move that date line
to the top of the letter,
I can use the move <code>m</code>
command and move it to line 0,
which is the top of the file:</p>
<pre><code>:6m0
Thu Jun 30 02:44:30 PM EDT 2022
Dear Students,

I hope you find this really interesting.
Feel free to practice and play on the command line,
as well as use tools like Ed, the standard editor.

Sincerely,
Dr. Burns
</code></pre>
<p>Although you can use the
arrow keys and Page Up/Page Down keys
to navigate in <code>vim</code> and <code>vi</code>,
by far the most excellent thing
about this editor is to be
able to use the <strong>j,k,l,h</strong> keys
to navigate around a file:</p>
<ul>
<li><code>j</code> moves down line by line</li>
<li><code>k</code> moves up line by line</li>
<li><code>l</code> moves right letter by letter</li>
<li><code>h</code> moves left letter by letter</li>
</ul>
<p>Like the other commands,
you can precede this with addresses.
To move 2 lines down,
you type <code>2j</code>,
and so forth.
<code>vi</code> and <code>vim</code> have had
such a powerful impact on
software development that
you can in fact use these
same keystrokes to navigate
a number of sites such as
Gmail, Facebook, Twitter, and more.</p>
<p>To save the file and exit <code>vim</code>,
return to <strong>command mode</strong>
by pressing the <strong>Esc</strong> key,
and then write and quit:</p>
<pre><code>:wq
</code></pre>
<p>The above barely
scratches the surface.
There are whole books
on these editors as well as
websites, videos, etc that explore them, and
especially <code>vim</code> in more detail.
But now that you have
some familiarity with them,
you might find this funny:
<a href="https://www.gnu.org/fun/jokes/ed-msg.en.html">Ed, man! !man ed</a>.</p>
<h2 id="nano"><a class="header" href="#nano"><code>nano</code></a></h2>
<p>The <code>nano</code> text editor
is the user-friendliest
of these text editors but
still requires some adjustment
as a new commandline user.
The friendliest thing about
<code>nano</code> is that it is modeless,
which is what you're
already accustomed to using,
because it can be used
to enter text and manipulate text
without changing to
insert or command mode.
It is also friendly because,
like many graphical text editors
and software,
it uses control keys
to perform its operations.
The tricky part is that
the control keys are assigned
to different keystroke combinations
than what
many graphical editors
(or word processors) use
by convention today.
For example,
instead of Ctrl-c or Cmd-c to copy,
in <code>nano</code> you press the <code>M-6</code> key
(press <code>Alt, Cmd, or Esc key</code>
and <code>6</code>) to copy.
Then to paste,
you press <code>Ctrl-u</code> instead
of the more common <code>Ctrl-v</code>.
Fortunately, <code>nano</code> lists
the shortcuts at the bottom
of the screen.</p>
<p>The shortcuts listed
need some explanation, though.
The carat mark is shorthand
for the keyboard's <strong>Control (Ctrl)</strong> key.
Therefore to <strong>Save As</strong> a file,
we <strong>write</strong> out the file
by pressing <code>Ctrl-o</code>.
The <strong>M-</strong> key is also important,
and depending on your keyboard
configuration,
it may correspond to your
<code>Alt, Cmd, or Esc</code> keys.
To search for text,
you press <code>^W</code>,
If your goal is to copy,
then press <strong>M-6</strong>
to copy a line.
Move to where you want
to paste the text,
and press <strong>Ctrl-u</strong>
to paste.</p>
<p>For the purposes of this class,
that's all you really
need to know about <code>nano</code>.
Use it and get comfortable writing in it.
Some quick tips:</p>
<ol>
<li><code>nano file.txt</code> will open and display the file named <strong>file.txt</strong>.</li>
<li><code>nano</code> by itself will open to an empty page.</li>
<li>Save a file by pressing <code>Ctrl-o</code>.</li>
<li>Quit and save by pressing <code>Ctrl-x</code>.</li>
<li>Be sure to follow the prompts at the bottom of the screen.</li>
</ol>
<h2 id="conclusion-8"><a class="header" href="#conclusion-8">Conclusion</a></h2>
<p>In prior lessons,
we learned how to use the
Bash interactive shell and
how to view, manipulate, and
edit files from that shell.
In this lesson,
we learned how to use
several command line text editors.
Editors allow us to save our commands,
create scripts,
and in the future,
edit configuration files.</p>
<p>The commands we used in this lesson include:</p>
<ul>
<li><code>ed</code> : line-oriented text editor</li>
<li><code>vim</code> : Vi IMproved, a programmer's text editor</li>
<li><code>nano</code> : Nano's ANOther editor, inspired by Pico</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="regular-expressions"><a class="header" href="#regular-expressions">Regular Expressions</a></h1>
<p>Oftentimes, as systems administrators,
we will need to search the contents of a file, like a log file.
One of the commands that we use to do that is the <code>grep</code> command.
We have already discussed using the <code>grep</code> command,
which is not unlike doing any kind of search,
such as in Google.
The command simply involves running <code>grep</code>
along with the search string and against a file.</p>
<h2 id="multiword-strings"><a class="header" href="#multiword-strings">Multiword strings</a></h2>
<p>It's good habit to include search strings within quotes,
but this is especially important if
we would search for multiword strings.
In these cases, we must enclose them in quotes.</p>
<p><strong>Command:</strong></p>
<pre><code>cat cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>City              | 2020 Census | Founded
New York City, NY | 8804190     | 1624
Los Angeles, CA   | 3898747     | 1781
Chicago, IL       | 2746388     | 1780
Houston, TX       | 2304580     | 1837
Phoenix, AZ       | 1624569     | 1881
Philadelphia, PA  | 1576251     | 1701
San Antonio, TX   | 1451853     | 1718
San Diego, CA     | 1381611     | 1769
Dallas, TX        | 1288457     | 1856
San Jose, CA      | 983489      | 1777
</code></pre>
<p><strong>Command:</strong></p>
<pre><code>grep &quot;San Antonio&quot; cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>San Antonio, TX | 1451853 | 1718
</code></pre>
<h2 id="whole-words-case-sensitive-by-default"><a class="header" href="#whole-words-case-sensitive-by-default">Whole words, case sensitive by default</a></h2>
<p>As a reminder,
<code>grep</code> commands are case-sensitive
by default, and
since the contents of <strong>cities.csv</strong>
are all in lowercase,
if I run the above command without
the city named capitalized,
then <code>grep</code> will return nothing:</p>
<p><strong>Command:</strong></p>
<pre><code>grep &quot;san antonio&quot; cities.csv
</code></pre>
<p>In order to tell grep to ignore case,
I need to use the <code>-i</code> option.
We also want to make sure that
we enclose our entire search string
withing double quotes.</p>
<p>This is a reminder for you to run <code>man grep</code> and
to read through the documentation and
see what the various options exit for this command.</p>
<p><strong>Command:</strong></p>
<pre><code>grep -i &quot;san antonio&quot; cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>San Antonio, TX   | 1451853     | 1718
</code></pre>
<h3 id="whole-words-by-the-edges"><a class="header" href="#whole-words-by-the-edges">Whole words by the edges</a></h3>
<p>To search whole words,
we can use special characters
to match strings at the start
and/or the end of words.
For example, note the output
if I search for cities
in California in my file by
searching for the string <strong>ca</strong>.
Since this string appears
in Chi<strong>ca</strong>go,
then that city matches my
grep search:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -i &quot;ca&quot; cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Los Angeles, CA   | 3898747     | 1781
Chicago, IL       | 2746388     | 1780
San Diego, CA     | 1381611     | 1769
San Jose, CA      | 983489      | 1777
</code></pre>
<p>To limit results to only <strong>CA</strong>,
we can enclose our search in
certain special characters:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -i &quot;\bca\b&quot; cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Los Angeles, CA   | 3898747     | 1781
San Diego, CA     | 1381611     | 1769
San Jose, CA      | 983489      | 1777
</code></pre>
<p>We can reverse that output
and look for strings within
other words.
Here is an example of searching
for the string <strong>ca</strong> within words:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -i &quot;\Bca\B&quot; cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Chicago, IL       | 2746388     | 1780
</code></pre>
<h2 id="bracket-expressions-and-character-classes"><a class="header" href="#bracket-expressions-and-character-classes">Bracket Expressions and Character Classes</a></h2>
<p>In conjunction with
the <code>grep</code> command,
we can also use regular expressions
to search for more general patterns
in text files.
For example, we can use <strong>bracket expressions</strong> and
<strong>character classes</strong> to search
for patterns in the text.
Here again using <code>man grep</code>
is very important because
it includes instructions on
how to use these regular expressions.</p>
<h3 id="bracket-expressions"><a class="header" href="#bracket-expressions">Bracket expressions</a></h3>
<p>From <code>man grep</code> on <strong>bracket expressions</strong>:</p>
<blockquote>
<p>A  bracket  expression  is  a  list  of  characters  enclosed  by  [ and ].
It matches any single character in that list.  If the first character of the
list is the caret ^ then it matches any character not in the list ... For
example, the regular expression [0123456789] matches any single digit.</p>
</blockquote>
<blockquote>
<p>Within a bracket expression, a range expression consists of two characters
separated by a hyphen. It matches any single character that sorts between the
two characters</p>
</blockquote>
<p>To see how this works,
let's search the <strong>cities.csv</strong> file
for letters matching <strong>A, B, or C</strong>.
Specifically in the following command
I use a hyphen to match
any characters <strong>in</strong> the range A, B, C.
The output does not include
the cities <strong>Houston</strong> or <strong>Dallas</strong>
since neither of those lines contain
capital <strong>A, B, or C</strong> characters:</p>
<p><strong>Command:</strong></p>
<pre><code>grep &quot;[A-C]&quot; cities.csv 
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>City              | 2020 Census | Founded
New York City, NY | 8804190     | 1624
Los Angeles, CA   | 3898747     | 1781
Chicago, IL       | 2746388     | 1780
Phoenix, AZ       | 1624569     | 1881
Philadelphia, PA  | 1576251     | 1701
San Antonio, TX   | 1451853     | 1718
San Diego, CA     | 1381611     | 1769
San Jose, CA      | 983489      | 1777
</code></pre>
<h3 id="bracket-expressions-inverse-searches"><a class="header" href="#bracket-expressions-inverse-searches">Bracket expressions, inverse searches</a></h3>
<p>When placed after the first bracket,
the carat key acts as a Boolean NOT.
The following command matches any
characters <strong>not in</strong> the range A,B,C:</p>
<p><strong>Command:</strong></p>
<pre><code>grep &quot;[^A-C]&quot; cities.csv
</code></pre>
<p>However, the output matches
all lines since there are no
instances of <strong>A, B, and C</strong>
in all lines:</p>
<p><strong>Output:</strong></p>
<pre><code>City              | 2020 Census | Founded
New York City, NY | 8804190     | 1624
Los Angeles, CA   | 3898747     | 1781
Chicago, IL       | 2746388     | 1780
Houston, TX       | 2304580     | 1837
Phoenix, AZ       | 1624569     | 1881
Philadelphia, PA  | 1576251     | 1701
San Antonio, TX   | 1451853     | 1718
San Diego, CA     | 1381611     | 1769
Dallas, TX        | 1288457     | 1856
San Jose, CA      | 983489      | 1777
</code></pre>
<h4 id="process-substitution"><a class="header" href="#process-substitution">Process substitution</a></h4>
<p>We can confirm that output
from the first command
does not include Houston or Dallas
in the second command by comparing
the outputs of the two commands 
using <strong>process substitution</strong>.
This is a technique that pipes
the standard output of multiple
commands to be processed by
another command.
Here I use the <code>diff</code> command
to compare the output of both
<code>grep</code> commands:</p>
<p><strong>Command:</strong></p>
<pre><code>diff &lt;(grep &quot;[A-C]&quot; cities.csv) &lt;(grep &quot;[^A-C]&quot; cities.csv)
</code></pre>
<p>The <code>diff</code> output shows
that the second <code>grep</code>
command includes the
two lines below that
are not in the output
of the first <code>grep</code> command: </p>
<p><strong>Output:</strong></p>
<pre><code>4a5
&gt; Houston, TX       | 2304580     | 1837
8a10
&gt; Dallas, TX        | 1288457     | 1856
</code></pre>
<blockquote>
<p>The output of the <code>diff</code> command is nicely explained in this <a href="https://unix.stackexchange.com/a/216131">Stack
Overflow</a> answer.</p>
</blockquote>
<p>Try this command for an alternate output:</p>
<pre><code>diff -y &lt;(grep &quot;[A-C]&quot; cities.csv) &lt;(grep &quot;[^A-C]&quot; cities.csv)
</code></pre>
<p>Our ranges may be alphabetical or numerical.
The following command matches any numbers <strong>in</strong> the range 1,2,3:</p>
<p><strong>Command:</strong></p>
<pre><code>grep [1-3] cities.csv
</code></pre>
<p>Since all single digits appear
in the file, the above command
returns all lines.
To invert the search,
we can use the following
grep command.
This will match all non-integers:</p>
<p><strong>Command:</strong></p>
<pre><code>grep [^0-9] cities.csv
</code></pre>
<h3 id="bracket-expressions-carat-preceding-the-bracket"><a class="header" href="#bracket-expressions-carat-preceding-the-bracket">Bracket expressions, carat preceding the bracket</a></h3>
<p>We saw in a previous
section that the carat <code>^</code>
key indicates
the start of line;
however, we learned above
that it is used to
return the inverse of a string.
To use the carat to signify
the start of a line,
the carat key must precede
the opening bracket.
For example, the following command matches
any lines that start with the upper case letters
within the range of <strong>N,O,P</strong>:</p>
<p><strong>Command:</strong></p>
<pre><code>grep ^[N-P] cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>New York City, NY | 8804190 | 1624
Phoenix, AZ       | 1624569 | 1881
Philadelphia, PA  | 1576251 | 1701
</code></pre>
<p>And we can reverse that
with the following command,
which returns all lines
that <strong>do not</strong> start with
<strong>N,O, or P</strong>:</p>
<p><strong>Command:</strong></p>
<pre><code>grep ^[^N-P] cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>City            | 2020 Census | Founded
Los Angeles, CA | 3898747     | 1781
Chicago, IL     | 2746388     | 1780
Houston, TX     | 2304580     | 1837
San Antonio, TX | 1451853     | 1718
San Diego, CA   | 1381611     | 1769
Dallas, TX      | 1288457     | 1856
San Jose, CA    | 983489      | 1777
</code></pre>
<h3 id="character-classes"><a class="header" href="#character-classes">Character classes</a></h3>
<p>Character classes are special
types of predefined 
bracket expressions.
They make it easy to
search for general patterns.
From <code>man grep</code> on <strong>character classes</strong>:</p>
<blockquote>
<p>Finally, certain named classes of characters are predefined
within bracket expressions, as follows.
Their names are self explanatory, and they are
[:alnum:], [:alpha:], [:blank:], [:cntrl:],
[:digit:], [:graph:], [:lower:], [:print:],
[:punct:], [:space:], [:upper:], and [:xdigit:].
For example, [[:alnum:]] means the character class
of numbers and letters ... </p>
</blockquote>
<p>Here I search for anything
that matches the Year column.
Specifically, I search for
a empty space <code>[[:blank:]]</code>,
a four digit string <code>[[:digit:]]{4}</code>.
The <code>{4}</code> means
&quot;The preceding item is matched
exactly 4 times&quot; (<code>man grep</code>),
and the number 4 can be replaced
with any relevant number.
and an end of line <code>$</code>:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -Eo &quot;[[:blank:]][[:digit:]]{4}$&quot; cities.csv 
</code></pre>
<p><strong>Output:</strong></p>
<pre><code> 1624
 1781
 1780
 1837
 1881
 1701
 1718
 1769
 1856
 1777
</code></pre>
<p>In the above command, the <code>[[:blank:]]</code>
can be excluded and
we'd still retrieve the desired results because
we've included the dollar sign to
mark the end of the line, but
I include it here for demonstration purposes.
Note that I also added the <code>-E</code> option.
This is required for character classes.</p>
<h2 id="anchoring"><a class="header" href="#anchoring">Anchoring</a></h2>
<p>As seen above,
outside of
bracket expressions and character classes,
we use the caret <code>^</code>
to mark the beginning of a line.
We can also use the <code>$</code>
to match the end of a line.
Using either (or both)
is called <strong>anchoring</strong>.
Anchoring works in many places.
For example, to search all lines
that start with capital <strong>D through L</strong></p>
<p><strong>Command:</strong></p>
<pre><code>grep &quot;^[D-L]&quot; cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Los Angeles, CA | 3898747 | 1781
Houston, TX     | 2304580 | 1837
Dallas, TX      | 1288457 | 1856
</code></pre>
<p>And all lines that end with the numbers <strong>4, 5, or 6</strong>:</p>
<p><strong>Command:</strong></p>
<pre><code>grep &quot;[4-6]$&quot; cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>New York City, NY | 8804190 | 1624
Dallas, TX        | 1288457 | 1856
</code></pre>
<p>We can use both anchors in
our <code>grep</code> commands.
The following searches
for any lines starting
with capital letters ranging
from D through L and any lines
ending with the numbers
starting from 4 through 6.
The single dot stands for any character,
and the asterisk stands for
&quot;the preceding character will
zero or more times&quot; (<code>man grep</code>).</p>
<p><strong>Command:</strong></p>
<pre><code>grep &quot;^[D-L].*[4-6]$&quot; cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Dallas, TX        | 1288457     | 1856
</code></pre>
<h2 id="repetition"><a class="header" href="#repetition">Repetition</a></h2>
<p>If we want to use regular expressions to identify repetitive patterns,
then we can use repetition operators.
As we saw above,
the most useful one is the <code>*</code> asterisk.
But there are other options:</p>
<p>In come cases, we need to add the -E option
to extend <code>grep</code>'s regular expression functionality:</p>
<p>Here, the preceding item <strong>S</strong> is matched one or more times:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -E &quot;S+&quot; cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>San Antonio, TX | 1451853 | 1718
San Diego, CA   | 1381611 | 1769
San Jose, CA    | 983489  | 1777
</code></pre>
<p>In the next search,
the preceding item <strong>l</strong> is
matched exactly 2 times:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -E &quot;l{2}&quot; cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Dallas, TX | 1288457 | 1856
</code></pre>
<p>Finally, in this example,
the preceding item <strong>7</strong> is matched 
at least two times or
at most three times:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -E &quot;7{2,3}&quot; cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>San Jose, CA | 983489 | 1777
</code></pre>
<h2 id="or-searches"><a class="header" href="#or-searches">OR searches</a></h2>
<p>We can use the vertical bar <code>|</code>
to do a Boolean OR search.
In a Boolean OR statement,
the statement is True if either
one part is true,
the other part is true,
or both are true.
In a search statement,
this means that at least one part
of the search is true.</p>
<p>The following will return lines
for each city because they
both appear in the file:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -E &quot;San Antonio|Dallas&quot; cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>San Antonio, TX | 1451853 | 1718
Dallas, TX      | 1288457 | 1856
</code></pre>
<p>The following will match
San Antonio even though
Lexington does not appear
in the file:</p>
<p><strong>Command:</strong></p>
<pre><code>grep -E &quot;San Antonio|Lexington&quot; cities.csv
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>San Antonio, TX   | 1451853     | 1718
</code></pre>
<h2 id="conclusion-9"><a class="header" href="#conclusion-9">Conclusion</a></h2>
<p>We covered a lot in this section on <code>grep</code> and regular expressions.</p>
<p>We specifically covered:</p>
<ul>
<li>multiword strings</li>
<li>whole word searches and case sensitivity</li>
<li>bracket expressions and character classes</li>
<li>anchoring</li>
<li>repetition</li>
<li>Boolean OR searches</li>
</ul>
<p>Even though we focused on <code>grep</code>,
many these regular expressions work
across many programming languages.</p>
<p>See <a href="https://www.regular-expressions.info/">Regular-Expression.info</a> for
more in-depth lessons on regular expressions.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bash-scripting"><a class="header" href="#bash-scripting">Bash Scripting</a></h1>
<p>It's time to get started on Bash scripting.
So far, we've been working on the Linux commandline.
Specifically, we have been working in the <a href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)">Bash</a> shell.
Wikipedia refers to Bash as a <strong>command language</strong>, and
by that it means that Bash is used as a commandline language
but also as a scripting language.
The main purpose of Bash is to write small applications/scripts
that analyze text (e.g., log files) and automate jobs, but
it can be used for a variety of other purposes.</p>
<h2 id="variables"><a class="header" href="#variables">Variables</a></h2>
<p>One of the most important abilities of any programming or scripting language
is to be able to declare a variable.
Variables enable us to attach some value to a name.
That value may be temporary,
and it's used to pass information to other parts of a program.</p>
<p>In Bash, we declare a variable with the name of the variable,
an equal sign,
and then the value of the variable within double quotes.
Do not insert spaces.
In the following code snippet,
which can be entered on the commandine,
I create a variable named <code>name</code>
and assign it the value <code>Sean</code>.
I create another variable named <code>backup</code> 
and assign it the value <code>/media</code>.
Then I use the <code>echo</code> and <code>cd</code> commands
to test the variables:</p>
<pre><code>name=&quot;Sean&quot;
backup=&quot;/media&quot;
echo &quot;My name is ${name}&quot;
echo &quot;${backup}&quot;
cd &quot;${backup}&quot;
pwd
cd
</code></pre>
<p>Variables may include values that may change given some context.
For example, if we want a variable to refer to today's day of week,
we can use <a href="https://www.gnu.org/software/bash/manual/html_node/Command-Substitution.html">command substitution</a>,
which &quot;allows the output of a command
to replace the command name&quot; (see <code>man bash</code>).
Thus, the output at the time this variable is set
will differ if it is set on a different day.</p>
<pre><code>today=&quot;$(date +%A)&quot;
echo &quot;${today}&quot;
</code></pre>
<p>The curly braces are not strictly necessary,
but they offer benefits when we start to use things
like <a href="https://tldp.org/LDP/Bash-Beginners-Guide/html/sect_10_02.html">array variables</a>.
See:</p>
<ul>
<li><a href="https://www.howtogeek.com/725657/how-to-use-brace-expansion-in-linuxs-bash-shell/">How to use curly braces in Bash</a></li>
<li><a href="https://wiki.bash-hackers.org/syntax/expansion/brace">Brace Expansion</a></li>
</ul>
<p>For example, let's look at basic <strong>brace expansion</strong>,
which can be used to generate arbitrary strings:</p>
<pre><code>echo {1..5}
echo {5..1}
echo {a..l}
echo {l..a}
</code></pre>
<p>Another example: using brace notation,
we can generate multiple sub-directories at once.
Start off in your home directory, and:</p>
<pre><code>mkdir -p homework/{drafts,notes}
cd homework
ls
</code></pre>
<p>But more than that, they allow us to deal with arrays (or lists).
Here I create a variable named <code>seasons</code>,
which holds an <strong>array</strong>, or multiple values: <code>winter spring summer fall</code>.
Bash lets me access parts of that array:</p>
<pre><code>seasons=(winter spring summer fall)
echo &quot;${seasons[@]}&quot;
echo &quot;${seasons[1]}&quot;
echo &quot;${seasons[2]}&quot;
echo &quot;${seasons[-1]}&quot;
</code></pre>
<p>See <a href="https://devhints.io/bash#parameter-expansion">Parameter expansions</a> for more advanced techniques.</p>
<h2 id="conditional-expressions"><a class="header" href="#conditional-expressions">Conditional Expressions</a></h2>
<p>Whether working on the commandline, or
writing scripts in a text editor,
it's sometimes useful to be able to write multiple commands
on one line.
There are several ways to do that.
We can include a list of commands on one line in Bash
where each command is separated by a semicolon:</p>
<pre><code>cd ; ls -lt
</code></pre>
<p>But we can use <a href="https://ss64.com/bash/syntax-execute.html">conditional expressions</a> and
apply logic with <code>&amp;&amp;</code> (<strong>Logical AND</strong>) or <code>||</code> (<strong>Logical OR</strong>).</p>
<p>Here, <code>command2</code> is executed if and only if <code>command1</code> is successful:</p>
<pre><code>command1 &amp;&amp; command2
</code></pre>
<p>Here, <code>command2</code> is executed if and only if <code>command1</code> fails:</p>
<pre><code>command1 || command2
</code></pre>
<p>Example:</p>
<pre><code>cd documents &amp;&amp; echo &quot;success&quot;
cd documents || echo &quot;failed&quot;
# combine them:
cd test &amp;&amp; pwd || echo &quot;no such directory&quot;
mkdir test
cd test &amp;&amp; pwd || echo &quot;no such directory&quot;
</code></pre>
<h2 id="shebang-or-hashbang"><a class="header" href="#shebang-or-hashbang">Shebang or Hashbang</a></h2>
<p>When we start to write scripts,
the first thing we add is a <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)">shebang</a> at line one.
We can do so a couple of ways:</p>
<pre><code>##!/usr/bin/env bash
</code></pre>
<p>The first one should be more portable, but alternatively,
you could put the direct path to Bash:</p>
<pre><code>#!/usr/bin/bash
</code></pre>
<h2 id="looping"><a class="header" href="#looping">Looping</a></h2>
<p>There are several looping methods Bash,
including: <code>for</code>, <code>while</code>, <code>until</code>, and <code>select</code>.
The <code>for</code> loop is often very useful. </p>
<pre><code>for i in {1..5} ; do
  echo &quot;${i}&quot;
done
</code></pre>
<p>With that, we can create a rudimentary timer:</p>
<pre><code>for i in {1..5} ; do
  echo &quot;${i}&quot; &amp;&amp; sleep 1
done
</code></pre>
<p>We can loop through our <strong>seasons</strong> variable:</p>
<pre><code>seasons=(winter spring summer fall)
for i in ${seasons[@]} ; do
  echo &quot;I hope you have a nice ${i}&quot;
done
</code></pre>
<h2 id="testing"><a class="header" href="#testing">Testing</a></h2>
<p>Sometimes we will want to test certain conditions.
There are two parts to this,
we can use <code>if; then ; else</code> commands,
and we can also use the double square brackets: <code>[[</code>.
There are a few ways to get documentation on these functions.
See the following:</p>
<pre><code>man test
help test
help [
help [[
help if
</code></pre>
<p>We can test integers:</p>
<pre><code>if [[ 5 -ge 3 ]] ; then
  echo &quot;true&quot;
else
  echo &quot;false&quot;
fi
</code></pre>
<p>Reverse it to return the else statement:</p>
<pre><code>if [[ 3 -ge 5 ]] ; then
  echo &quot;true&quot;
else
  echo &quot;false&quot;
fi
</code></pre>
<p>We can test strings:</p>
<pre><code>if [[ &quot;$HOME&quot; = &quot;$PWD&quot; ]] ; then
 echo &quot;You are home.&quot;
else
 echo &quot;You are not home, but I will take you there.&quot;
 cd &quot;$HOME&quot;
 pwd
fi
</code></pre>
<p>We can test file conditions.
Let's first create a file called <strong>paper.txt</strong> and
a file called <strong>paper.bak</strong>.
We will add some trivial content to <strong>paper.txt</strong>
but not to the <strong>paper.bak</strong>.
The following <code>if</code> statement will test if <strong>paper.txt</strong> 
has a more recent modification date, and if so,
it'll back up the file with the <code>cp</code> and echo back its success:</p>
<pre><code>if [[ &quot;$HOME/paper.txt&quot; -nt &quot;$HOME/paper.bak&quot; ]] ; then
  cp &quot;$HOME/paper.txt&quot; &quot;$HOME/paper.bak&quot; &amp;&amp; echo &quot;Paper is backed up.&quot;
fi
</code></pre>
<p>Here's a script that prints info depending on which day of the week it is:</p>
<pre><code>day1=&quot;Tue&quot;
day2=&quot;Thu&quot;
day3=&quot;$(date +%a)&quot;

if [[ &quot;$day3&quot; = &quot;$day1&quot; ]] ; then
  printf &quot;\nIf %s is %s, then class is at 9:30am.\n&quot; &quot;$day3&quot; &quot;$day1&quot;
elif [[ &quot;$day3&quot; = &quot;$day2&quot; ]] ; then
  printf &quot;\nIf %s is %s, then class is at 9:30am.\n&quot; &quot;$day3&quot; &quot;$day2&quot;
else
  printf &quot;\nThere is no class today.&quot;
fi
</code></pre>
<h2 id="resources"><a class="header" href="#resources">Resources</a></h2>
<p>I encourage you to explore
some useful guides and cheat sheets on Bash scripting:</p>
<ul>
<li><a href="https://tldp.org/LDP/abs/html/index.html">Advanced Bash-Scripting Guide</a></li>
<li><a href="https://devhints.io/bash">Bash scripting cheatsheet</a></li>
<li><a href="https://www.shellcheck.net/">Bash shellcheck</a></li>
<li><a href="https://www.freecodecamp.org/news/shell-scripting-crash-course-how-to-write-bash-scripts-in-linux/">Shell Scripting for Beginners</a></li>
<li><a href="https://fedoramagazine.org/bash-shell-scripting-for-beginners-part-1/">Bash Shell Scripting for Beginners</a></li>
<li><a href="https://cs.lmu.edu/%7Eray/notes/bash/">Introduction to Bash</a></li>
</ul>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>In this demo, we learned about:</p>
<ul>
<li>creating and referring to variables</li>
<li>conditional expressions with <code>&amp;&amp;</code> and <code>||</code></li>
<li>adding the <strong>shebang</strong> or <strong>hashbang</strong> at the beginning of a script</li>
<li>looping with the <code>for</code> statement</li>
<li>testing with the <code>if</code> statement</li>
</ul>
<p>These are the basics.
I'll cover more practical examples in upcoming demos,
but note that mastering the basics requires understanding
a lot of the commands and paths that we have covered so far in class.
So keep practicing.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="managing-the-system"><a class="header" href="#managing-the-system">Managing the System</a></h1>
<p>Now that we have the basics of
the command line interface down,
it's time to learn some systems administration.
In this section,
we learn how to expand storage space,
create new user and group accounts and
manage those accounts,
install and remove software,
and manage that software and other processes.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="expanding-storage"><a class="header" href="#expanding-storage">Expanding Storage</a></h1>
<p>I'm sure all or most of you have needed
extra disk storage at some point
(USB drives, optical disks, floppies???).
Such needs are no different for systems administrators,
who often are responsible for managing, monitoring,
or storing large amounts of data.</p>
<p>The disk that we created for our VM is small (10 GB),
and that's fine for our needs,
albeit quite small in many real world scenarios.
To address this,
we can add a persistent disk
that is much larger.
In this section,
we will add a disk to our VM, 
mount it onto the VM's filesystem, and format it.
Extra storage does incur extra cost.
So at the end of this section,
I will show you how to delete the extra 
disk to avoid that if you want.</p>
<p>We will essentially follow the Google Cloud tutorial
to add a non-boot disk to our VM, but
with some modification.</p>
<p><a href="https://cloud.google.com/compute/docs/disks/add-persistent-disk">Add a persistent disk to your VM</a></p>
<blockquote>
<p>Note: the main disk used by our VM is the <strong>boot disk</strong>.
The boot disk contains the 
software required to boot the system.
All of our computers
(desktops, laptops, tablets, phones, etc.),
regardless of which operating system they run,
have some kind of boot system.</p>
</blockquote>
<h2 id="creating-a-disk"><a class="header" href="#creating-a-disk">Creating a Disk</a></h2>
<p>In the Google Cloud console,
visit the <strong>Disks</strong> page in the <strong>Storage</strong> section,
which should be here:</p>
<p><a href="https://console.cloud.google.com/compute/disksAdd">Create a disk</a></p>
<p>And then follow these steps:</p>
<ol>
<li>Under <strong>Name</strong>, add a preferred name or leave the default.</li>
<li>Under <strong>Description</strong>, add text to describe your disk.</li>
<li>Under <strong>Location</strong>, leave or choose <strong>Single zone</strong>.
<ul>
<li>We are not concerned about data safety.</li>
<li>If we were, then we would select other options here.</li>
</ul>
</li>
<li>Under <strong>Source</strong>, select <strong>Blank disk</strong>.</li>
<li>Under <strong>Disk settings</strong>, select <strong>Balanced persistent disk</strong>.</li>
<li>Under <strong>Size</strong>, change this to 10GB.
<ul>
<li>You can actually choose larger sizes, but be aware that <a href="https://cloud.google.com/compute/all-pricing#disk">disk
pricing</a> is $0.10 per GB.</li>
<li>At that cost, 100 GB = $10 / month.</li>
</ul>
</li>
<li>Click on <strong>Enable snapshot schedule</strong>.</li>
<li>Under <strong>Encryption</strong>, make sure <strong>Google-managed encryption key</strong> is
selected.</li>
<li>Click <strong>Create</strong> to create your disk.</li>
</ol>
<h2 id="adding-the-disk-to-our-vm"><a class="header" href="#adding-the-disk-to-our-vm">Adding the Disk to our VM</a></h2>
<p>Now that we have created our disk,
we need to <strong>mount</strong> it onto our filesystem
so that it's available to our VM.
Conceptually, this process is like inserting
a new USB drive into our computer.</p>
<p>To add the new disk to our VM,
follow these steps:</p>
<ol>
<li>Visit the <strong>VM instances</strong> page.</li>
<li>Click on the check box next to your virtual machine.
<ul>
<li>That will convert the <strong>Name</strong> of your VM into a hyperlink.</li>
</ul>
</li>
<li>Click on that <strong>Name</strong>.
<ul>
<li>That will take you to the <strong>VM instance details</strong> page.</li>
</ul>
</li>
<li>Click on the <strong>Edit</strong> button at the top of the details page.</li>
<li>Under the <strong>Additional disks</strong> section, click on <strong>+ ATTACH EXISTING DISK</strong>. </li>
<li>A panel will open on the right side of your browser.</li>
<li>Click on the drop down box and select the disk, by name, you created.</li>
<li>Leave the defaults as-is.</li>
<li>Click on the <strong>SAVE</strong> button.</li>
<li>Then click on the <strong>SAVE</strong> button on the details page.</li>
</ol>
<p>If you return to the <strong>Disks</strong> page in the <strong>Storage</strong> section,
you will now see that the new disk is in use by our VM.</p>
<h2 id="formatting-and-mounting-a-non-boot-disk"><a class="header" href="#formatting-and-mounting-a-non-boot-disk">Formatting and Mounting a Non-Boot Disk</a></h2>
<h3 id="formatting-our-disk"><a class="header" href="#formatting-our-disk">Formatting Our Disk</a></h3>
<p>In order for our VM to make use of the extra storage,
the new drive must be formatted and mounted.
Different operating systems use different filesystem formats.
You may already know that
macOS uses the <a href="https://support.apple.com/guide/disk-utility/file-system-formats-dsku19ed921c/mac">Apple File System (APFS)</a> by default
and that Windows uses the
<a href="https://docs.microsoft.com/en-us/windows-server/storage/file-server/ntfs-overview">New Technology File System (NTFS)</a>.
Linux is no different, but
uses different file systems than macOS and Windows, by default.
There are many formatting technologies that we can use in Linux,
but we'll use the <a href="https://ext4.wiki.kernel.org/index.php/Main_Page">ext4 (fourth extended filesystem)</a> format,
since this is recommended by Google Cloud and
is also a stable and common one for Linux.</p>
<p>In this section, we will closely follow the steps
outlined under the
<a href="https://cloud.google.com/compute/docs/disks/add-persistent-disk"><strong>Formatting and mounting a non-boot disk on a Linux VM</strong></a>
section.
I replicate those instructions below, but
I highly encourage you to read through
the instructions on Google Cloud and here:</p>
<ol>
<li>Use the <code>gcloud compute ssh</code> command that you
have previously used to connect to your VM.
<ul>
<li>Alternatively, you can <code>ssh</code> to your VM via your browser:
<ul>
<li>Click on the <strong>VM instances</strong> page.</li>
<li>Under the <strong>Connect</strong> column,
select <strong>Open in browser window</strong> next to <strong>SSH</strong>.</li>
</ul>
</li>
</ul>
</li>
<li>When you have connected to your VM's command line, run the <code>lsblk</code>
command.
<ul>
<li>Ignore the <strong>loop</strong> devices.</li>
<li>Instead, you should see <strong>sda</strong> and <strong>sdb</strong> under the <strong>NAME</strong> column
outputted by the <code>lsblk</code> command.</li>
<li><strong>sda</strong> represents your main disk.
<ul>
<li><strong>sda1, sda14, sda15</strong> (may be slightly different for you)
represent the partitions of the <strong>sda</strong> disk.</li>
<li>Notice the <strong>MOUNTPOINT</strong> for <strong>sda1</strong> is <code>/</code>,
or the root level of our filesystem.</li>
</ul>
</li>
<li><strong>sdb</strong> represents the attached disk we just added.
<ul>
<li>After we format this drive, there will be an <strong>sdb1</strong>, and this
partition will also have a mountpoint.</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>To format our disk for the <strong>ext4</strong> filesystem,
we will use the <code>mkfs.ext4</code>
(see <code>man mkfs.ext4</code> for details).
The instructions tell us to run the following command
(please read the Google Cloud instructions closely;
<strong>it's important to understand these commands as much
as possible and not just copy and paste them</strong>):</p>
<pre><code>sudo mkfs.ext4 -m 0 -E lazy_itable_init=0,lazy_journal_init=0,discard /dev/DEVICE_NAME
</code></pre>
<p>But replace <strong>DEVICE_NAME</strong> with the name of our device.
My device's name is <strong>sdb</strong>,
which we saw with the output of the <code>lsblk</code> command;
therefore, the specific command I run is:</p>
<pre><code>sudo mkfs.ext4 -m 0 -E lazy_itable_init=0,lazy_journal_init=0,discard /dev/sdb
</code></pre>
<h3 id="mounting-our-disk"><a class="header" href="#mounting-our-disk">Mounting Our Disk</a></h3>
<p>Now that our disk has been formatted in <strong>ext4</strong>,
I can mount it.</p>
<blockquote>
<p>Note: to <strong>mount</strong> a disk simply means to make the disk's
filesystem available so that we can use it for accessing,
storing, etc files on the disk.
Whenever we insert a USB drive, a DVD drive, etc
into our computers,
the OS you use should mount that disk automatically
so that you can access and use that disk.
Conversely, when we remove those drives,
the OS <strong>unmounts</strong> them.
In Linux, the commands for these are <code>mount</code> and <code>umount</code>.
Note that the <code>umount</code> command is not <strong>unmount</strong>.</p>
</blockquote>
<p>You will recall that we have
<a href="03-filesystem-file-management.html">discussed filesystems earlier</a>,
and that the term is a bit confusing since it refers to both
the directory hierarchy and also the formatting type (e.g., ext4).
In that prior section, I discussed how in Windows,
attaching a new drive,
whether it's a USB drive, a DVD drive,
an additional disk drive, or an external drive,
Windows gives the new drive a letter,
like <strong>A:</strong>, <strong>B:</strong>, <strong>D:</strong>, etc.
Unlike Windows, I mentioned that in Linux and Unix (e.g., macOS),
when we add an additional disk,
its filesystem gets added onto our existing one.
That is, it becomes part of the directory hierarchy
and under the <code>/</code> top level part of the hierarchy.
In practice, this means that we have to create the <strong>mountpoint</strong>
for our new disk, and
we do that with the <code>mkdir</code> command.
The Google Console documentation instructs us
to use the following command:</p>
<pre><code>sudo mkdir -p /mnt/disks/MOUNT_DIR
</code></pre>
<p>And to replace <strong>MOUNT_DIR</strong> with the directory we 
want to create.
Since my added disk is named <strong>disk-1</strong>,
I'll call it that:</p>
<pre><code>sudo mkdir -p /mnt/disks/disk-1
</code></pre>
<p>Now we can <code>mount</code> the disk to that directory.
Per the instructions on Google Console,
and given that my added drive has the device name <strong>sdb</strong>,
I use the following command:</p>
<pre><code>sudo mount -o discard,defaults /dev/sdb /mnt/disks/disk-1
</code></pre>
<p>We also need to change the modifications, and
grant access for additional users:</p>
<pre><code>sudo chmod 777 /mnt/disks/disk-1
</code></pre>
<p>We can test that it exists and is accessible with
the <code>lsblk</code> and the <code>cd</code> commands.
The <code>lsblk</code> command should show that <strong>sdb</strong> is
mounted at <code>/mnt/disks/disk-1</code>, and 
we can <code>cd</code> (change directory) to it:</p>
<pre><code>cd /mnt/disks/disk-1
</code></pre>
<h3 id="automounting-our-disk"><a class="header" href="#automounting-our-disk">Automounting Our Disk</a></h3>
<p>Our disk is mounted, but if the computer (VM) gets rebooted,
we would have to re-<code>mount</code> the additional drive manually.
In order to avoid this and automount the drive upon reboot,
we need to edit the file <code>/etc/fstab</code>.</p>
<blockquote>
<p>Note that the file is named <strong>fstab</strong> and 
that it's located in the <strong>/etc</strong> directory.
Therefore the full path is <code>/etc/fstab</code></p>
</blockquote>
<p>The <strong>fstab</strong> file is basically a configuration file 
that provides information to the OS about the filesystems 
the system can mount.
The standard information <strong>fstab</strong> contains includes
the name (or label) of the device being mounted,
the mountpoint (e.g., <code>/mnt/disks/disk-1</code>),
the filesystem type (e.g., <strong>ext4</strong>),
and various other mount options.
See <code>man fstab</code> for more details.
For devices to mount upon boot up automatically,
they have to be listed in this file.
That means we need to edit this file on our VM.</p>
<p>Again, here we're following the Google Cloud instructions:</p>
<p>Before we edit system configuration files, however,
always create a backup.
We'll use the <code>cd</code> command to create a backup of the <strong>fstab</strong> file.</p>
<pre><code>sudo cp /etc/fstab /etc/fstab.backup
</code></pre>
<p>Next we use the <code>blkid</code> command to get
the UUID (universally unique identifier)
number for our new device.
Since my device is <code>/dev/sdb</code>,
I'll use that:</p>
<pre><code>sudo blkid /dev/sdb
</code></pre>
<p>The output should look something like this
<strong>BUT NOTE that your UUID value will
be DIFFERENT</strong>:</p>
<pre><code>/dev/sdb: UUID=&quot;3bc141e2-9e1d-428c-b923-0f9vi99a1123&quot; TYPE=&quot;ext4&quot;
</code></pre>
<p>We need to add that value to <code>/etc/fstab</code>
plus the standard information that file requires.
The Google Cloud documentation explicitly guides us here.
We'll use <code>nano</code> to make the edit:</p>
<pre><code>sudo nano /etc/fstab
</code></pre>
<p>And then add this line at the bottom:</p>
<pre><code>UUID=3bc141e2-9e1d-428c-b923-0f9vi99a1123 /mnt/disks/disk-1 ext4 discard,defaults,nofail 0 2
</code></pre>
<p>And that's it!
If you reboot your VM, or
if your VM rebooted for some reason,
the extra drive we added should automatically 
mount upon reboot.
If it doesn't,
then it may mean that the drive failed,
or that there was an error (i.e., typo) in the configuration.</p>
<h3 id="delete-the-disk"><a class="header" href="#delete-the-disk">Delete the Disk</a></h3>
<p>You are welcome to keep the disk attached to the VM,
but if you do not want to incur any charges for it,
which would be about $1 / month at 10 GB,
then we can delete it.</p>
<p>To delete the disk,
first delete the line that we added in <code>/etc/fstab</code>,
unmount it,
and then delete the disk in the gcloud console.</p>
<p>To unmount the disk, we use the <code>umount</code> command:</p>
<pre><code>sudo umount /mnt/disks/disk-1
</code></pre>
<p>Then we need to delete the disk in gcloud.</p>
<ol>
<li>Go to the <strong>VM instances</strong> page.</li>
<li>Click on the check box next to the VM.</li>
<li>Click on the name, which should be a hyperlink.</li>
<li>This goes to the <strong>VM instances detail</strong> page.</li>
<li>Click on the <strong>Edit</strong> button at the top of the page.</li>
<li>Scroll down to the <strong>Additional disks</strong> section.</li>
<li>Click the edit (looks like a pencil) button.</li>
<li>In the right-hand pane that opens up, select <strong>Delete disk</strong> under the
<strong>Deletion rule</strong> section.</li>
<li>Scroll back to the <strong>Additional disks</strong> section.</li>
<li>Click on the <code>X</code> to detach the disk.</li>
<li>Click on <strong>Save</strong>.</li>
<li>Go the <strong>Disk</strong> section in the left-hand navigation pane.</li>
<li>Check the disk to delete, and then Delete it.</li>
<li>Click on the <strong>Snapshots</strong> section in the left-hand navigation pane.</li>
<li>Check the disk snapshot to delete, and then Delete it.
<ul>
<li>Be sure you don't delete your VM here but just your disk.</li>
</ul>
</li>
</ol>
<h2 id="conclusion-10"><a class="header" href="#conclusion-10">Conclusion</a></h2>
<p>In this section we learned how to expand 
the storage of our VM by creating a new virtual drive,
adding it to our VM,
formatting the drive in the <strong>ext4</strong> filesystem format,
mounting the drive at <code>/mnt/disks/disk-1</code>, and
then editing <code>/etc/fstab</code> to make automount the drive.</p>
<p>In addition to using the gcloud console,
the commands we used in this section include:</p>
<ol>
<li><code>ssh</code>  : to connect to the remote VM</li>
<li><code>sudo</code> : to run commands as the administrator</li>
<li><code>mkfs.ext</code> : to create an <strong>ext4</strong> filesystem on our new drive</li>
<li><code>mkdir -p</code> : to create multiple directories under <code>/mnt</code></li>
<li><code>mount</code> : to mount manually the new drive</li>
<li><code>umount</code> : to unmount manually the new drive</li>
<li><code>chmod</code> : to change the mountpoint's file permission attributes</li>
<li><code>cd</code> : to change directories</li>
<li><code>cp</code> : to copy a file</li>
<li><code>nano</code> : to use the text editor <code>nano</code> to edit <code>/etc/fstab</code></li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="managing-users-and-groups"><a class="header" href="#managing-users-and-groups">Managing Users and Groups</a></h1>
<p>In some cases we'll want to provide user accounts
on the servers we administrate, or
we'll want to set up servers for others to use.
The process of creating accounts is fairly straightforward, but
there are a few things to know about how user accounts work.</p>
<h2 id="the-passwd-file"><a class="header" href="#the-passwd-file">The passwd file</a></h2>
<p>The <strong>/etc/passwd</strong> file contains information
about the users on your system.
There is a man page that describes the file, but
man pages are divided into sections (see <code>man man</code>), and
the man page for the <code>passwd</code> file is in section 5.
Therefore in order to read the man page
for the <strong>/etc/passwd</strong> file,
we run the following command:</p>
<pre><code>man 5 passwd
</code></pre>
<p>Before we proceed,
let's take a look at a single line of the file.
Below I'll show the output for a made up user account:</p>
<pre><code>grep &quot;peter&quot; /etc/passwd
peter:x:1000:1000:peter,,,:/home/peter:/bin/bash
</code></pre>
<p>The line starting with <strong>peter</strong> is a colon separated line.
That means that the line is composed of multiple fields
each separated by a colon.</p>
<p><code>man 5 passwd</code> tells us what each field indicates.
The first field is the login name,
which in this case is <strong>peter</strong>.
The second field, marked <strong>x</strong>, marks the password field.
This file does not contain the password, though.
The passwords, which are <a href="https://auth0.com/blog/adding-salt-to-hashing-a-better-way-to-store-passwords/">hashed and salted</a>,
for users are stored in the <strong>/etc/shadow</strong> file,
which can only be read by the root user
(or using the <code>sudo</code> command).</p>
<blockquote>
<p>Hashing a file or a string of text is a
process of running a hashing algorithm on the file or text.
If the file or string is copied exactly, byte for byte,
then hashing the copy will return the same value.
If anything has changed about the file or string,
then the hash value will be different.
By implication, this means that if two users on a system
use the same password,
then the hash of each will be equivalent.
Salting a hashed file (or file name)
or string of text is a process
of adding random data to the file or string.
Each password will have a unique and mostly random salt
added to it.
This means that even if two users on a system use the
same password,
salting their passwords will result in unique values.</p>
</blockquote>
<p>The third column indicates the user's numerical ID, and
the fourth column indicates the users' group ID.
The fifth column repeats the login name, but
could also serve as a comment field.
Comments are added using certain commands (discussed later).
The fifth field identifies the user's home directory,
which is <strong>/home/peter</strong>.
The sixth field identifies the user's default shell,
which is <code>/bin/bash</code>.</p>
<p>The <strong>user name or comment</strong> field merely repeats the login name here,
but it can hold specific types of information.
We can add comments using the <code>chfn</code> command.
Comments include the user's full name,
their home and work phone numbers,
their office or room number, and so forth.
To add a full name to user <strong>peter</strong>'s account,
we use the <strong>-f</strong> option:</p>
<pre><code>sudo chfn -f &quot;Peter Parker&quot; peter
</code></pre>
<p>The <strong>/etc/passwd</strong> file is a standard Linux file, but
some things will change depending on the Linux distribution.
For example, the user and group IDs above start at 1000 because
<strong>peter</strong> is the first human account on the system.
This is a common starting numerical ID nowadays,
but it could be different on other Linux or Unix-like distributions.
The home directory could be different on other systems, too;
for example, the default could be located at <strong>/usr/home/peter</strong>.
Also, other shells exist besides <code>bash</code>, 
like <a href="https://www.zsh.org/">zsh</a>,
which is now the default shell on macOS;
so other systems may default to different shell environments.</p>
<h2 id="the-shadow-file"><a class="header" href="#the-shadow-file">The shadow file</a></h2>
<p>The <strong>/etc/passwd</strong> file does not contain any passwords but
a simple <strong>x</strong> to mark the password field.
Passwords on Linux are stored in <strong>/etc/shadow</strong> and
are hashed with <strong>sha512</strong>,
which is indicated by <strong>$6$</strong>.
You need to be root to examine the shadow file or use <code>sudo</code>:</p>
<p>The fields are (see <code>man 5 shadow</code>):</p>
<ul>
<li>login name (username)</li>
<li>encrypted password</li>
<li>days since 1/1/1970 since password was last changed</li>
<li>days after which password must be changed</li>
<li>minimum password age</li>
<li>maximum password age</li>
<li>password warning period</li>
<li>password inactivity period</li>
<li>account expiration date</li>
<li>a reserved field</li>
</ul>
<p>The <strong>/etc/shadow</strong> file should not be directly edited.
To set, for example, a warning that a user's password will expire,
we would use the <code>passwd</code> command
(see <code>man passwd</code> for options).
The following command would make it so the user <strong>peter</strong>
is warned that their password will expire in 14 days: </p>
<pre><code>passwd -w 14 peter
</code></pre>
<h2 id="the-group-file"><a class="header" href="#the-group-file">The group file</a></h2>
<p>The <strong>/etc/group</strong> file holds group information
about the entire system
(see <code>man 5 group</code>).
The file can be viewed by anyone on a system, by default,
but there is also a <code>groups</code> command
(see <code>man groups</code>)
that will return the groups for a user.
Running the <code>groups</code> command by itself
will return your own memberships.</p>
<h2 id="management-tools"><a class="header" href="#management-tools">Management Tools</a></h2>
<p>There are different ways to create new users and groups, and
the following list includes most of the utilities to help
with this.
Note that, based on the names of the utilities,
some of them are repetitive.</p>
<ul>
<li>useradd (8) - create a new user or update default new user information</li>
<li>usermod (8) - modify a user account</li>
<li>userdel (8) - delete a user account and related files</li>
<li>groupadd (8) - create a new group</li>
<li>groupdel (8) - delete a group</li>
<li>groupmod (8) - modify a group definition on the system</li>
<li>gpasswd (1) - administer /etc/group and /etc/gshadow</li>
<li>adduser.conf (5) - configuration file for adduser(8) and addgroup(8) .</li>
<li>adduser (8) - add a user or group to the system</li>
<li>deluser (8) - remove a user or group from the system</li>
<li>delgroup (8) - remove a user or group from the system</li>
<li>chgrp (1) - change group ownership</li>
</ul>
<p>The numbers within parentheses above indicate the <code>man</code> section.
Therefore, to view the man page for the <code>userdel</code> command:</p>
<pre><code>man 8 userdel
</code></pre>
<h2 id="practice"><a class="header" href="#practice">Practice</a></h2>
<h3 id="modify-default-new-user-settings"><a class="header" href="#modify-default-new-user-settings">Modify default new user settings</a></h3>
<p>Let's modify some default user account settings for new users,
and then we'll create a new user account.</p>
<p>Before we proceed,
let's review several important configuration files
that establish some default settings:</p>
<ul>
<li><strong>/etc/skel</strong></li>
<li><strong>/etc/adduser.conf</strong></li>
</ul>
<p>The <strong>/etc/skel</strong> directory defines the home directory for new users.
Whatever files or directories exist in this directory
at the time a new user account is created
will result in those files and directories being created
in the new user's home directory.
We can view what those are using the following command:</p>
<pre><code>ls -a /etc/skel/
</code></pre>
<p>The <strong>/etc/adduser.conf</strong> file defines
the default parameters for new users.
It's in this file
where the default starting user and group IDs are set,
where the default home directory is located
(e.g., in <strong>/home/</strong>),
where the default shell is defined
(e.g., <code>/bin/bash</code>),
where the default permissions are set for new 
home user directories
(e.g., <strong>0755</strong>)
and more.</p>
<p>Let's change some defaults for <strong>/etc/skel</strong>.
We need to use <code>sudo [command]</code> or
use <code>su</code> to become the root user.
I prefer to use <code>sudo [command]</code>
since this is a bit safer than becoming root.
Let's edit the default <strong>.bashrc</strong> file:</p>
<pre><code>sudo nano /etc/skel/.bashrc
</code></pre>
<p>We want to add these lines at the end of the file.
This file is a configuration file for <code>/bin/bash</code>,
and will be interpreted by Bash.
Therefore, lines starting with a hash mark
are comments:</p>
<pre><code># Dear New User,
#
# I have made the following settings
# to make your life a bit easier:
#
# make &quot;c&quot; a shortcut for &quot;clear&quot;
alias c='clear'
</code></pre>
<p>Use <code>nano</code> again to create a README file.
This file will be added to the
home directories of all new users.
Add any welcome message you want to add,
plus any guidelines for using the system.</p>
<pre><code>sudo nano /etc/skel/README
</code></pre>
<h3 id="add-new-user-account"><a class="header" href="#add-new-user-account">Add new user account</a></h3>
<p>After writing (saving) and exiting <code>nano</code>,
we can go ahead and create a new user named <strong>linus</strong>.</p>
<pre><code>sudo adduser linus
</code></pre>
<p>We'll be prompted to enter a password for the new user,
plus comments (full name, phone number, etc).
Any of these can be skipped by pressing enter.
You can see from the output of the <code>grep</code> command
below that I added some extra information:</p>
<pre><code>grep &quot;linus&quot; /etc/passwd
linus:x:1003:1004:Linus Torvalds,333,555-123-4567,:/home/linus:/bin/bash
</code></pre>
<p>Let's modify the minimum days before the password can be changed,
and the maximum days of the password's lifetime:</p>
<pre><code>sudo passwd -n 90 linus
sudo passwd -x 180 linus
</code></pre>
<p>You can see these values by grepping the shadow file:</p>
<pre><code>sudo grep &quot;linus&quot; /etc/shadow
</code></pre>
<p>To log in as the new user,
use the <code>su</code> command:</p>
<pre><code>su linus
</code></pre>
<p>To exit the new user's account,
use the <code>exit</code> command:</p>
<pre><code>exit
</code></pre>
<h3 id="add-users-to-a-new-group"><a class="header" href="#add-users-to-a-new-group">Add users to a new group</a></h3>
<p>Because of the default configuration defined in <strong>/etc/adduser.conf</strong>,
the <strong>linus</strong> user only belongs to a group of the same name.
Let's create a new group that both
<strong>linus</strong> and <strong>peter</strong> belong to.
For that, we'll use the <strong>-a</strong> option for the <code>gpasswd</code> command.
We'll also make the user <strong>peter</strong> the group administrator
using the <strong>-A</strong> option
(see <code>man gpasswd</code> for more details).</p>
<pre><code>sudo groupadd developers
sudo gpasswd -a peter developers
sudo gpasswd -A peter developers
sudo gpasswd -a linus developers
grep &quot;developers&quot; /etc/group
</code></pre>
<blockquote>
<p>Note: if a user is logged in when you add them 
to a group, they need to logout and log back
in before the group membership goes into effect.</p>
</blockquote>
<h3 id="create-a-shared-directory"><a class="header" href="#create-a-shared-directory">Create a shared directory</a></h3>
<p>One of the benefits of group membership is that members
can work in a shared directory.</p>
<p>Let's make the <strong>/srv/developers</strong> a shared directory.
The <strong>/srv</strong> directory already exists,
so we only need to create the <strong>developers</strong> subdirectory:</p>
<pre><code>sudo mkdir /srv/developers
</code></pre>
<p>We'll have to change the default permissions,
which are currently set to <strong>0755</strong>:</p>
<pre><code>ls -ld /srv
ls -ld /srv/developers
</code></pre>
<p>Now we can change ownership of the directory:</p>
<pre><code>sudo chgrp developers /srv/developers
</code></pre>
<p>The directory ownership should now reflect that it's owned by 
the <strong>developers</strong> group:</p>
<pre><code>ls -ld /srv/developers
</code></pre>
<p>In order to allow group members to read and write to 
the above directory,
we need to use the <code>chmod</code> command in a way we haven't yet.
Specifically, we add a leading <strong>2</strong> sets the group identity.
The <strong>770</strong> indicates that the user and group owners of
the directory have read, write, and execute permissions
for the directory:</p>
<pre><code>sudo chmod 2770 /srv/developers
</code></pre>
<p>Now either <strong>linus</strong> or <strong>peter</strong> can add, modify, and delete
files in the <strong>/srv/developers</strong> directory.</p>
<h3 id="user-account-and-group-deletion"><a class="header" href="#user-account-and-group-deletion">User account and group deletion</a></h3>
<p>You can keep the additional user and group on your system,
but know that you can also remove them.
The <code>deluser</code> and <code>delgroup</code> commands
offer great options
and may be preferable to the others utilities
(see <code>man deluser</code> or <code>man delgroup</code>).</p>
<p>If we want to delete the new user's account and the new group,
these are the commands to use.
The first command will create an archival backup of
<strong>linus</strong>' home directory and also remove the home 
directory and any files in it.</p>
<pre><code>deluser --backup --remove-home linus
delgroup developers
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="managing-software"><a class="header" href="#managing-software">Managing Software</a></h1>
<h2 id="introduction-3"><a class="header" href="#introduction-3">Introduction</a></h2>
<p>Many modern Linux distributions offer some kind of
package manager to
install, manage, and remove software.
These package management systems interact with
curated and audited central repositories of software
that are collected into <strong>packages</strong>.
They also provide a set of tools to learn about 
the software that exists in these repositories.</p>
<blockquote>
<p>If <strong>package management</strong> seems like an odd concept to you,
it's just a way to manage software installation, and
it's very similar to the way that Apple and Google
distribute software via the App Store and Google Play.</p>
</blockquote>
<p>On Debian based systems,
which includes Ubuntu,
we use <code>apt</code>, <code>apt-get</code>, and <code>apt-cache</code>
to manage most software installations.
For most cases,
you will simply want to use the <code>apt</code> command,
as it is meant to combine the functionality commonly
used with <code>apt-get</code> and <code>apt-cache</code>.</p>
<p>We can also install software from source code or
from pre-built binaries.
On Debian and Ubuntu, for example,
we might want to install
(if we trust it)
pre-build binaries distributed on the
internet as <strong>.deb</strong> files.
These are comparable to <strong>.dmg</strong> files for macOS
and to <strong>.exe</strong> files for Windows.
When installing <strong>.deb</strong> files, though,
we need to use the <code>dpkg</code> command.</p>
<p>Installing software from source code often
involves compiling the software.
It's usually not difficult to install software
this way, but it can become complicated to manage
software that's installed from source code
simply because it means managing dependencies
and keeping a close eye on new versions
of the software.</p>
<p>Another way to install software
(I know, there's a lot)
is to use the <code>snap</code> command.
This is a newer way of packaging programs
that involves packaging all of a program
and all of its dependencies
into a single <a href="https://www.ibm.com/cloud/learn/containers">container</a>.
The main point of <a href="https://ubuntu.com/core/services/guide/snaps-intro">snap</a> seems to be aimed
at IoT and embedded devices, but
it's perfectly usable and preferable
(in some scenarios)
on the desktop because the general
aim is end users and not system administrators.
See the <a href="https://snapcraft.io/">snap store</a> for examples.</p>
<blockquote>
<p>You might also want to know that some programming
languages provide their own mechanisms to install
packages.
In many cases, these packages may be installed
with the <code>apt</code> command, but
the packages that <code>apt</code> will install tend to
be older (but more stable)
than the packages that a programming language will install.
For example, Python has the <code>pip</code> or <code>pip3</code>
command to install and remove Python libraries.
The R programming language has the
<code>install.packages()</code>, <code>remove.packages()</code>, and the
<code>update.packages()</code> commands to install R libraries.</p>
</blockquote>
<p>Despite all these ways to install, manage, remove, and
update software,
we will focus on using the <code>apt</code> command, which
is pretty straightforward.</p>
<h2 id="apt"><a class="header" href="#apt">APT</a></h2>
<p>Let's look at the basic <code>apt</code> commands.</p>
<h3 id="apt-update"><a class="header" href="#apt-update">apt update</a></h3>
<p>Before installing any software,
we need to update the index of packages that are available
for the system.</p>
<pre><code>sudo apt update
</code></pre>
<h3 id="apt-upgrade"><a class="header" href="#apt-upgrade">apt upgrade</a></h3>
<p>The above command will also state if there is software
on the system that is ready for an upgrade.
If any upgrades are available,
we run the following command:</p>
<pre><code>sudo apt upgrade
</code></pre>
<h3 id="apt-search"><a class="header" href="#apt-search">apt search</a></h3>
<p>We may know a package's name when we're ready to install it, but
we also may not.
To search for a package,
we use the following syntax:</p>
<pre><code>apt search [package-name]
</code></pre>
<blockquote>
<p>Package names will never have spaces between words.
Rather, if a package name has more than one word,
each word will be separated by a hyphen.</p>
</blockquote>
<p>In practice, say I'm curious if there
are any console based games:</p>
<pre><code>apt search ncurses game
</code></pre>
<blockquote>
<p>I added <strong>ncurses</strong> to my search query because
the <a href="https://en.wikipedia.org/wiki/Ncurses">ncurses</a> library is often used to create console-based
applications.</p>
</blockquote>
<h3 id="apt-show"><a class="header" href="#apt-show">apt show</a></h3>
<p>The above command returned a lit that included
a game called <strong>ninvaders</strong>, which
seems to be a console-based Space Invaders like game.
To get additional information about this package,
we use the <code>apt show [package-name]</code> command:</p>
<pre><code>apt show ninvaders
</code></pre>
<h3 id="apt-install"><a class="header" href="#apt-install">apt install</a></h3>
<p>It's quite simple to install the package called <strong>ninvaders</strong>:</p>
<pre><code>sudo apt install ninvaders
</code></pre>
<h3 id="apt-remove-or-apt-purge"><a class="header" href="#apt-remove-or-apt-purge">apt remove or apt purge</a></h3>
<p>To remove an installed package,
we can use either the <code>apt remove</code> or
the <code>apt purge</code> commands.
Sometimes when a program is installed,
configuration files get installed with it
in the <strong>/etc</strong> directory.
The <code>apt purge</code> command will remove
those configuration files but the 
<code>apt remove</code> command will not.
Both commands are offered because sometimes
it is useful to keep those configuration files.</p>
<pre><code>apt remove ninvaders
</code></pre>
<p>Or:</p>
<pre><code>apt purge ninvaders
</code></pre>
<h3 id="apt-autoremove"><a class="header" href="#apt-autoremove">apt autoremove</a></h3>
<p>All big software requires other software to run.
This other software are called <a href="https://queue.acm.org/detail.cfm?id=3344149">dependencies</a>.
The <code>apt show [package-name]</code> command
will list a program's dependencies.
However, when we remove software with the prior
two commands, the dependencies,
even if no longer needed,
are not necessarily removed.
To remove them,
(which restores more disk space)
we do:</p>
<pre><code>sudo apt autoremove
</code></pre>
<h3 id="apt-history"><a class="header" href="#apt-history">apt history</a></h3>
<p>Unfortunately, the <code>apt</code> command does
not provide a way to get a history of how
it's been used on a system, but
a log of its activity is kept.
We can review that log with the following command:</p>
<pre><code>less /var/log/apt/history.log
</code></pre>
<h2 id="daily-usage"><a class="header" href="#daily-usage">Daily Usage</a></h2>
<p>This all may seem complicated, but
it's really not.
For example, to keep my systems updated,
I run the following two commands on a daily
or near daily basis:</p>
<pre><code>apt update
sudo apt upgrade
</code></pre>
<h2 id="conclusion-11"><a class="header" href="#conclusion-11">Conclusion</a></h2>
<p>There are a variety of ways to install
software on a Linux or Ubuntu system.
The common way to do it on Ubuntu is to
use the <code>apt</code> command, which
was covered in this section.</p>
<p>We'll come back to this command often because
we'll soon install and setup a complete LAMP 
(<strong>L</strong>inux, <strong>A</strong>apache, <strong>M</strong>ariaDB, and <strong>P</strong>HP) server.
Until then, I encourage you to read through the
manual page for <code>apt</code>:</p>
<pre><code>man apt
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-systemd"><a class="header" href="#using-systemd">Using systemd</a></h1>
<h2 id="introduction-4"><a class="header" href="#introduction-4">Introduction</a></h2>
<p>When computers boot up,
obviously some software manages that process.
On Linux and other Unix or Unix-like systems,
this is usually handled via an <strong>init</strong> system.
For example, macOS uses <a href="https://en.wikipedia.org/wiki/Launchd">launchd</a> and
many Linux distributions,
including Ubuntu,
use <a href="https://en.wikipedia.org/wiki/Systemd">systemd</a>.</p>
<p><strong>systemd</strong> does more than handle the startup process,
it also manages various services and connects
the Linux kernel to various applications.
In this section,
we'll cover how to use <strong>systemd</strong> to manage services, and
to review log files.</p>
<h2 id="manage-services"><a class="header" href="#manage-services">Manage Services</a></h2>
<p>When we install complicated software,
like a web server (e.g., Apache2, Nginx),
a SSH server (e.g., OpenSSH), or
a database server (e.g., mariaDB or MySQL),
then it's helpful to have commands that manage that service
(the web service, the SSH service, the database service, etc).</p>
<p>For example, the <code>ssh</code> service is installed
by default on our gcloud servers, and
we can check its status with the following 
<code>systemctl</code> command:</p>
<pre><code>systemctl status ssh
</code></pre>
<p>The output tells us a few things.
The line beginning with <strong>Loaded</strong> tells us that
the SSH service is configured.
At the end of that line,
it also tells us that it is <strong>enabled</strong>,
which means that the service will automatically start
when the system gets rebooted or starts up.</p>
<p>The line beginning with <strong>Active</strong> tells us
that the service is <strong>active (running)</strong> and for how long.
It has to say this since I'm connecting to the machine
using <code>ssh</code>.
If the service was not active (running), then
I wouldn't be able to login remotely.
We also can see the process ID (PID) for the service
as well as how much memory it's using.</p>
<p>At the bottom of the output,
we can see the recent log files.
We can view more of those log files
using the <code>journalctl</code> command.
By default, running <code>journalctl</code> by itself
will return all log files, but
we can specify that we're interested in
log files only for the ssh service.
We can specify using the PID number.
Replace <em>NNN</em> with the PID number attached
to your ssh service:</p>
<pre><code>journalctl _PID=NNN
</code></pre>
<p>Or we can specify by service, or
more specifically, its <strong>unit</strong> name:</p>
<pre><code>journalctl -u ssh
</code></pre>
<h3 id="use-cases"><a class="header" href="#use-cases">Use Cases</a></h3>
<p>Later we'll install the <a href="https://httpd.apache.org/">Apache web server</a>, and
we will use <code>systemctl</code> to manage some aspects of this service.</p>
<p>In particular, we will use the following commands to: </p>
<ol>
<li>check the state of the Apache service,</li>
<li>configure the Apache service to auto start on reboot,</li>
<li>start the service,</li>
<li>reload the service after editing its configuration files, and</li>
<li>stop the service.</li>
</ol>
<p>In order, these work out to:</p>
<pre><code>systemctl status apache2
sudo systemctl enable apache2
sudo systemctl start apache2
sudo systemctl reload apache2
sudo systemctl stop apache2
</code></pre>
<p><code>systemctl</code> is a big piece of software, and
there are other arguments the command will take.
See <code>man systemct</code> for details.</p>
<h2 id="examine-logs"><a class="header" href="#examine-logs">Examine Logs</a></h2>
<p>As mentioned, the <code>journalctl</code> command is
part of the <strong>systemd</strong> software suite, and
it is used to monitor system logs.</p>
<p>It's really important to monitor system logs.
They help identify any problems in the system or
with various services.
For example, by monitoring the log entries for <strong>ssh</strong>,
I can see all the attempts to break into the server.
Or if the Apache2 web server malfunctions for some reason,
which might be because of a configuration error,
the logs will indicated how to identify the problem.</p>
<p>If we type <code>journalctl</code> at the command prompt,
we are be presented with the logs for the entire system.
These logs can be paged through by pressing the space bar,
the page up/page down keys, or
the up/down arrow keys, and
they can also be searched by pressing the forward slash <strong>/</strong> and
then entering a search keyword.
To exit out of the pager,
press <strong>q</strong> to quit.</p>
<pre><code>journalctl
</code></pre>
<p>It's much more useful to specify the field and
to declare an option when using <code>journalctl</code>.
See the following man pages for details:</p>
<pre><code>man systemd.journal-fields
man journalctl
</code></pre>
<p>There are many fields and options we can use, but
as an example,
we see that there is an option to view the more 
recent entries first (which is not the default):</p>
<pre><code>journalctl -r
</code></pre>
<p>Or we view log entries in reverse order,
for users on the system, and
since the last boot with the following options:</p>
<pre><code>journalctl -r --user -b 0
</code></pre>
<p>Or for the system:</p>
<pre><code>journalctl -r --system -b 0
</code></pre>
<p>I can more specifically look at the
logs files for a service by using the <code>-u</code>
option with <code>journalctl</code>:</p>
<pre><code>journalctl -u apache2
</code></pre>
<p>I can follow the logs in real-time
(press <strong>ctrl-c</strong> to quit the real-time view):</p>
<pre><code>journalctl -f
</code></pre>
<h2 id="useful-systemd-commands"><a class="header" href="#useful-systemd-commands">Useful Systemd Commands</a></h2>
<p>You can see more of what <code>systemctl</code> or <code>journalctl</code>
can do by reading through their documentation:</p>
<pre><code>man systemctl
man journalctl
</code></pre>
<p>You can check if a service if enabled:</p>
<pre><code>systemctl is-enabled apache2
</code></pre>
<p>You can reboot, poweroff, or suspend a system
(suspending a system mostly makes sense for laptops
and not servers):</p>
<pre><code>systemctl reboot
systemctl poweroff
systemctl suspend
</code></pre>
<p>To show configuration file changes to the system:</p>
<pre><code>systemd-delta
</code></pre>
<p>To list real-time control group process, resource usage, and memory usage:</p>
<pre><code>systemd-cgtop
</code></pre>
<ul>
<li>to search failed processes/services:</li>
</ul>
<pre><code>systemctl --state failed
</code></pre>
<ul>
<li>to list services</li>
</ul>
<pre><code>systemctl list-unit-files -t service
</code></pre>
<ul>
<li>to examine boot time:</li>
</ul>
<pre><code>systemd-analyze
</code></pre>
<h2 id="conclusion-12"><a class="header" href="#conclusion-12">Conclusion</a></h2>
<p>This is a basic introduction to <strong>systemd</strong>,
which is composed of a suite of software to help
manage booting a system, managing services, and
monitoring logs.</p>
<p>We'll put what we've learned into practice
when we set up our LAMP servers.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="networking-and-security"><a class="header" href="#networking-and-security">Networking and Security</a></h1>
<p>Even if we do not work as network administrators,
system administrators need to know network basics.
In this section, we cover TCP/IP and other protocols
related to the internet protocol suite,
and how to protect our systems locally,
from external threats,
and how to create backups of our systems in case
of disaster.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="networking-and-tcpip"><a class="header" href="#networking-and-tcpip">Networking and TCP/IP</a></h1>
<p>An important function of a system administrator
is to set up, configure, and monitor a network.
This may involve planning, configuring, and
connecting the devices on a local area network,
to planning and implementing a large network
that interfaces with an outside network,
and to monitoring networks for various sorts of attacks,
such as <a href="https://en.wikipedia.org/wiki/Denial-of-service_attack">denial of service attacks</a>.</p>
<p>In order to prepare for this type of work,
we need at least a basic understanding of how
the internet works and how local devices
interact with the internet.
In this section, we will focus mostly on
internet addressing, but
we will also devote some space to TCP and UDP,
two protocols for transmitting data.</p>
<p>Connecting two or more devices together 
nowadays involves the TCP/IP or the UDP/IP protocols,
otherwise part of the
<a href="https://en.wikipedia.org/wiki/Internet_protocol_suite">Internet protocol suite</a>.
This suite is a kind of expression of the more
generalized <a href="https://en.wikipedia.org/wiki/OSI_model">OSI communication model</a>.</p>
<p>The internet protocol suite is generally
framed as a series
of layers beginning with a lower layer,
the <strong>link layer</strong>,
that interfaces with internet capable hardware,
to the highest layer, the <strong>application layer</strong>.</p>
<p>The <strong>link layer</strong> describes the local area network.
Devices connected locally, e.g., via Ethernet cables,
comprise the link layer.
The link layer connects to the <strong>internet layer</strong>.
Data going into or out of a local network must
be negotiated between these two layers.</p>
<p>The <strong>internet layer</strong> makes the internet possible by
basically making the ability to transmit data
among multiple networks possible.
(The internet is, in fact, a network of networks).
The primary characteristic of the internet layer
is the <strong>IP address</strong>, which currently comes in two versions:
IPv4 (32 bit) and IPv6 (128 bit).
IP addresses are used to locate hosts on a network.</p>
<p>The <strong>transport layer</strong> makes the exchange of data
on the internet possible.
There are two dominant protocols attached to this layer:
<a href="https://en.wikipedia.org/wiki/User_Datagram_Protocol">UDP</a> and <a href="https://en.wikipedia.org/wiki/Transmission_Control_Protocol">TCP</a>.
Very generally, <a href="https://www.cloudflare.com/learning/ddos/glossary/user-datagram-protocol-udp/">UDP</a> is used when the integrity
of data is less important than the its ability
to reach its destination.
For example, streaming video,
VOIP, and online gaming
are often transported
via UDP because the loss of some pixels or some audio is acceptable.
<a href="https://www.cloudflare.com/learning/ddos/glossary/tcp-ip/">TCP</a> is used when the integrity of the data is important.
If the data cannot be transmitted without error,
then the data won't reach its final destination
until the error is corrected.</p>
<p>The <strong>application layer</strong> provides the ability to
use the internet in particular ways.
For example, the <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">HTTP</a> protocol enables
the <strong>web</strong>,
which is simply an <strong>application</strong> on the internet.
The <strong>SMTP</strong>, <strong>IMAP</strong>, and <strong>POP</strong> protocols
control email exchange.
<strong>DNS</strong> is a system that maps IP addresses to domain names.
In this book,
we use <strong>SSH</strong>, also part of the application layer,
to connect to remote computers.</p>
<blockquote>
<p>By <strong>application</strong>, they simply mean that
these protocols provide the functionality for applications.
They are not themselves considered user applications,
like a web browser.</p>
</blockquote>
<h2 id="the-internet-protocol-suite"><a class="header" href="#the-internet-protocol-suite">The Internet Protocol Suite</a></h2>
<h3 id="link-layer"><a class="header" href="#link-layer">Link Layer</a></h3>
<h4 id="arp-address-resolution-protocol"><a class="header" href="#arp-address-resolution-protocol">ARP (Address Resolution Protocol)</a></h4>
<p><strong>ARP</strong> (Address Resolution Protocol) is a protocol
at the link layer and is
used to map network addresses,
like an IP address,
to the ethernet addresses,
also called the MAC or Media Access Control address, or
the hardware address.
Routers use MAC addresses to enable communication
inside networks
(w/in subnets or local area networks)
so that computers within a local network
can talk to each other.
Networks are designed so that IP addresses
are associated with MAC addresses
before systems can communicate over a network.
Everyone of your internet capable devices,
your smartphone, your laptop, your internet connected toaster,
have a MAC address.</p>
<p>To get ARP info for a system,
we use the <code>ip</code> command,
which uses regular options (like <code>-b</code>) and
names specific objects.
To get the MAC address for a specific computer,
we can use the following command,
where <code>ip</code> is the command and
<code>a</code> or <code>link</code> are considered objects
(see <code>man ip</code> for details):</p>
<pre><code>ip a
</code></pre>
<p>On my home system,
the above command produces three numbered sections of output.
The first section refers to the <strong>lo</strong> or loopback device.
This is a special device that allows the computer to
communicate with itself.
It always has an IPv4 address of 127.0.0.1.
The next section on my home machine refers to the ethernet card.
Currently, I'm connected via wifi, and
so this section reports the MAC address for that ethernet card
plus some other other information,
such as whether the device is down or up.
Since there's no physical cable connecting my machine
to the router,
this section reports DOWN.
The third section on my home system refers to the wifi card.
Since this is UP (or active),
it reports the internal IP address (e.g., 192.168.0.4), plus
the MAC address, and other details.
The internal address is different from the machine's
external address,
which might be something like 159.3.45.2.</p>
<p>We can get just the <strong>link</strong> object information
with the following command:</p>
<pre><code>ip link
</code></pre>
<p>The following two commands help identify
parts of the local network (or subnet)
and the routing table.</p>
<pre><code>ip neigh
ip route
</code></pre>
<p>The <code>ip neigh</code> command produces the ARP cache,
basically what other systems your system
is aware of on the local network.
The <code>ip route</code> command is used to
define how data is routed on the network but
can also define the routing table.
Both of these commands are more commonly used on
Linux-based routers.</p>
<p>These details enable the following scenario:
A router gets configured to use a specific <strong>network address</strong>
when it's brought online.
It searches the sub network for connected MAC addresses
that are assigned to wireless cards or ethernet cards.
It then assigns each of those MAC addresses an available
IP address based on the network address.</p>
<h3 id="internet-layer"><a class="header" href="#internet-layer">Internet Layer</a></h3>
<h4 id="ip-internet-protocol"><a class="header" href="#ip-internet-protocol">IP (Internet Protocol)</a></h4>
<p>The Internet Protocol, or <em>IP</em>, address
is used to uniquely identify a host on a network and
place that host at a specific location (its IP <strong>address</strong>).
If that network is subnetted (i.e., routed),
then a host's IP address will have a subnet or
private IP address that will not be
directly exposed to the Internet.
Remember this, there are public IP addresses that
are distinct from private IP addresses.
Public IP addresses are accessible on the internet.
Private IP addresses are not, but
they are accessible on subnets or local area networks.</p>
<p>Private IP address ranges are reserved address ranges,
which means no public internet device will have an
IP address within these ranges.
The private address ranges include:</p>
<div class="table-wrapper"><table><thead><tr><th>Start Address</th><th>End Address</th></tr></thead><tbody>
<tr><td>10.0.0.0</td><td>10.255.255.255</td></tr>
<tr><td>172.16.0.0</td><td>172.31.255.255</td></tr>
<tr><td>192.168.0.0</td><td>192.168.255.255</td></tr>
</tbody></table>
</div>
<p>If you have a router at home, and
look at the IP address for at any of
your devices connected to that router,
like your phone or computer,
you will see that it will have an address
within one of the ranges above.
For example, it might have an IP address
beginning with <strong>192.168.X.X</strong>.
This is a standard IP address range for a home router.
The <strong>10.X.X.X</strong> private range can assign
many more IP addresses on its network,
which is why you'll see that IP range on bigger networks,
like a university's network.
We'll talk more about subnetwork sizes, shortly.</p>
<h4 id="example-private-ip-usage"><a class="header" href="#example-private-ip-usage">Example Private IP Usage</a></h4>
<p>Let's say my office computer's IP address
is <strong>10.163.34.59/24</strong> via a wired connection.
My office neighbor has an
IP address of <strong>10.163.34.65/24</strong> via their wired connection.
Both IP addresses are private because they fall within the
<strong>10.0.0.0 to 10.255.255.255</strong> range.
And it's likely they both exist on the same
subnet since they share the first three <strong>octets</strong>:
<strong>10.163.34.XX</strong>.</p>
<p>However, if we both,
using our respective wired connected computers,
searched Google for <em>what's my IP address</em>,
we will see that we share the same public IP address,
which will be something like <strong>128.163.8.25</strong>.
That is a public IP address because it does not
fall within the ranges listed above.</p>
<p>Without any additional information,
therefore,
we know that all traffic coming from our computers and
going out to the internet looks like it's coming
from the same IP address (<strong>128.163.8.25</strong>).
And in reverse,
all traffic coming from outside our network
first goes to <strong>128.163.8.25</strong> before it's routed
to our respective computers via the router.</p>
<p>Let's say I also have a laptop in my office, and
that it has a wireless connection.
When I check with <code>ip a</code>,
I find that the laptop had the IP address
<strong>10.47.34.150/16</strong>.
You can see there's a different pattern with this IP address.
The reason it has a different pattern is
because this laptop is on an different subnet even
though it's physically sitting next to the wired computer.
This wireless subnet was configured to allow
more hosts to connect to it since it must allow for more devices
(i.e., laptops, phones, etc).
When I searched Google for my IP address from this laptop,
it reports <strong>128.163.238.148</strong>,
indicating that UK owns a range of public IP address spaces.</p>
<p>Here's kind of visual diagram of what this network looks like:</p>
<figure>
<img src="images/18-network.png"
alt="Network diagram"
title="Network diagram">
<figcaption>
Fig. 1. This figure contains a network switch,
which is used to route traffic within a subnet.
The switch relies solely on MAC addresses and not
IP addresses to determine the location of
devices on its subnet.
The router acts as the interface between
the private network and the public network and
is managing two subnets: a wired and a wireless one.
</figcaption>
</figure>
<h4 id="using-the-ip-command"><a class="header" href="#using-the-ip-command">Using the <code>ip</code> Command</a></h4>
<p>The <code>ip</code> command can do more than
provide us information about our network.
We can also use it to turn a connection
to the network on or off (and more).
Here we disable and then enable a connection on a machine.
Note that <strong>enp0s3</strong> is the name of my network card/device.
Yours might have a different name.</p>
<pre><code>sudo ip link set enp0s3 down
sudo ip link set enp0s3 up
</code></pre>
<h3 id="transport-layer"><a class="header" href="#transport-layer">Transport Layer</a></h3>
<p>The internet layer does not transmit content,
like web pages or video streams.
This is the work of the transport layer.
As discussed previously,
the two most common transport layer
protocols are <strong>TCP</strong> and <strong>UDP</strong>.</p>
<h4 id="tcp-transmission-control-protocol"><a class="header" href="#tcp-transmission-control-protocol">TCP, Transmission Control Protocol</a></h4>
<p><em>TCP</em> or Transmission Control Protocol
is responsible for the transmission of data and
for making sure the data arrives at its
destination w/o errors.
If there are errors,
the data is re-transmitted or halted
in case of some failure.
Much of the data sent over the internet is sent using TCP.</p>
<h4 id="udp-user-datagram-protocol"><a class="header" href="#udp-user-datagram-protocol">UDP, User Datagram Protocol</a></h4>
<p>The <strong>UDP</strong> or User Datagram Protocol
performs a similar function as TCP, but
it does not error check and data may get lost.
UDP is useful for conducting voice over internet
calls or for streaming video,
such as through YouTube,
which uses a type of UDP transmission
called <strong>QUIC</strong> that has builtin encryption. </p>
<h4 id="tcp-and-udp-headers"><a class="header" href="#tcp-and-udp-headers">TCP and UDP Headers</a></h4>
<p>The above protocols send data in
data TCP <strong>packets</strong> or UDP <strong>datagrams</strong>, but
<a href="https://www.cloudflare.com/learning/network-layer/what-is-a-packet/">these terms may be used interchangeably</a>.
Packets for both protocols include header
information to help route the data across the internet.
TCP includes <a href="https://www.imperva.com/learn/ddos/tcp-transmission-control-protocol/">ten fields</a> of header data, and
UDP includes <a href="https://www.imperva.com/learn/ddos/udp-user-datagram-protocol/">four fields</a>.</p>
<p>We can see this header data using
the <code>tcpdump</code> command,
which requires <code>sudo</code> or being <strong>root</strong> to use.
The first part of the IP header contains the source address,
then comes the destination address, and so forth.
Aside from a few other parts,
this is the primary information in an IP header.</p>
<p><strong>You should use <code>tcpdump</code> on your local computer and not
on your gcloud instance</strong>.
First we identify the IP number of a host,
which we can do with the <code>ping</code> command, and
then run <code>tcpdump</code>:</p>
<pre><code>ping -c1 www.uky.edu
sudo tcpdump host 128.163.35.46
</code></pre>
<p>While that's running,
we can type that IP address in our web browser,
or enter <strong>www.uky.edu</strong>, and
watch the output of <code>tcpdump</code>.</p>
<p>TCP headers include port information and other
mandatory fields for both source and destination servers.
The SYN, or synchronize, message is sent
when a source or client requests a connection.
The ACK, or acknowledgment, message is sent in response,
along with a SYN message,
to acknowledge the request for a connection.
Then the client responds with an additional ACK message.
This is referred to as the
<a href="https://www.geeksforgeeks.org/tcp-3-way-handshake-process/">TCP three-way handshake</a>.
In addition to the header info,
TCP and UDP packets include the data that's being sent
(e.g., a webpage) and
error checking if it's TCP.</p>
<h4 id="ports"><a class="header" href="#ports">Ports</a></h4>
<p>TCP and UDP connections use ports to bind
internet traffic to specific IP addresses.
Specifically, a <strong>port</strong> associates a process
with an application 
(and is part of the <strong>application layer</strong> of the internet suite),
such as a web service or outgoing email.
That is, ports provide a way to distinguish and
filter internet traffic (web, email, etc)
through an IP address.
For example, all traffic going to IP address 10.0.5.33:80
means that this is <strong>http</strong> traffic for the http web service,
since HTTP is commonly associated with port 80.
Note that the port info is attached to the end of the
IP address via a colon. </p>
<p>Common ports include:</p>
<ul>
<li>21: FTP</li>
<li>22: SSH</li>
<li>25: SMTP</li>
<li>53: DNS</li>
<li>143: IMAP</li>
<li>443: HTTPS</li>
<li>587: SMTP Secure</li>
<li>993: IMAP Secure</li>
</ul>
<p>There's a complete list of the 318
default ports/protocols on your Linux systems.
It's located in the following file:</p>
<pre><code>less /etc/services
</code></pre>
<p>And to get a count of the ports,
we can invert grep for lines starting with a pound sign or are empty</p>
<pre><code>grep -Ev &quot;^#|^$&quot; /etc/services | wc -l
</code></pre>
<p>See also the Wikipedia page:
<a href="https://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers">List of TCP and UDP port numbers</a></p>
<h2 id="ip-subnetting"><a class="header" href="#ip-subnetting">IP Subnetting</a></h2>
<p>Let's now return to the internet layer and
discuss one of the major duties of a systems administrator:
subnetting.</p>
<p>Subnets are used to carve out smaller and more manageable
subnetworks out of a larger network.
They are created using routers that have this capability
(e.g., commercial use routers) and certain types
of network switches.</p>
<h3 id="private-ip-ranges"><a class="header" href="#private-ip-ranges">Private IP Ranges</a></h3>
<p>When subnetting local area networks,
we work with the private IP ranges:</p>
<div class="table-wrapper"><table><thead><tr><th>Start Address</th><th>End Address</th></tr></thead><tbody>
<tr><td>10.0.0.0</td><td>10.255.255.255</td></tr>
<tr><td>172.16.0.0</td><td>172.31.255.255</td></tr>
<tr><td>192.168.0.0</td><td>192.168.255.255</td></tr>
</tbody></table>
</div>
<p>It's important to be able to work with IP addresses
like those listed above in order to subnet; and
therefore, we will need to learn a bit of IP math
along the way.</p>
<h4 id="ip-meaning"><a class="header" href="#ip-meaning">IP Meaning</a></h4>
<p>An IPv4 address is 32 bits (8 x 4),
or four bytes, in size.
In human readable context,
it's usually expressed in the following,
decimal-based, notation style:</p>
<ul>
<li><strong>192.168.1.6</strong></li>
<li><strong>172.16.3.44</strong></li>
</ul>
<p>Each set of numbers separated by a dot is
referred to as an <strong>octet</strong>.
An <strong>octet</strong> is a group of 8 <strong>bits</strong>.
Eight <strong>bits</strong> equal a single <strong>byte</strong>.
By implication, 8 gigabits equals 1 gigabyte, and
8 megabits equals 1 megabyte.
We use these symbols to note the terms:</p>
<div class="table-wrapper"><table><thead><tr><th>Term</th><th>Symbol</th></tr></thead><tbody>
<tr><td>bit</td><td><em>b</em></td></tr>
<tr><td>byte</td><td>B</td></tr>
<tr><td>octet</td><td><em>o</em></td></tr>
</tbody></table>
</div>
<p>Each bit is represented by either a 1 or a 0.
For example, the first address above in binary is:</p>
<ul>
<li><strong>11000000.10101000.00000001.00000110</strong> is <strong>192.168.1.6</strong></li>
</ul>
<p>Or:</p>
<div class="table-wrapper"><table><thead><tr><th>Byte</th><th>Decimal Value</th></tr></thead><tbody>
<tr><td>11000000</td><td>192</td></tr>
<tr><td>10101000</td><td>168</td></tr>
<tr><td>00000001</td><td>1</td></tr>
<tr><td>00000110</td><td>6</td></tr>
</tbody></table>
</div>
<h3 id="ip-math"><a class="header" href="#ip-math">IP Math</a></h3>
<p>When doing IP math,
one easy way to do it is to simply remember
that each bit in each of the above bytes is a
placeholder for the following values:</p>
<pre><code>128 64 32 16 8 4 2 1
</code></pre>
<p>Alternatively, from low to high:</p>
<div class="table-wrapper"><table><thead><tr><th>base-2</th><th>Output</th></tr></thead><tbody>
<tr><td>2<sup>0</sup></td><td>1</td></tr>
<tr><td>2<sup>1</sup></td><td>2</td></tr>
<tr><td>2<sup>2</sup></td><td>4</td></tr>
<tr><td>2<sup>3</sup></td><td>8</td></tr>
<tr><td>2<sup>4</sup></td><td>16</td></tr>
<tr><td>2<sup>5</sup></td><td>32</td></tr>
<tr><td>2<sup>6</sup></td><td>64</td></tr>
<tr><td>2<sup>7</sup></td><td>128</td></tr>
</tbody></table>
</div>
<p>In binary, 192 is equal to 11000000.
It's helpful to work backward.
For IP addresses,
all octets are 255 or less
(256 total, from 0 to 255) and
therefore do not exceed 8 bits or places.
To convert the integer 192 to binary:</p>
<pre><code>1 * 2^7 = 128
1 * 2^6 =  64 (128 + 64 = 192)
</code></pre>
<p>Then STOP.
There are no values left, and
so the rest are zeroes.
Thus: 11000000</p>
<p>Our everyday counting system is base-10, but
binary is base-2, and
thus another way to convert binary to decimal
is to multiple each bit (1 or 0)
by the power of base two of its placeholder:</p>
<pre><code>(0 * 2^0) = 0 +
(0 * 2^1) = 0 +
(0 * 2^2) = 0 +
(0 * 2^3) = 0 +
(0 * 2^4) = 0 +
(0 * 2^5) = 0 +
(1 * 2^6) = 64 +
(1 * 2^7) = 128 = 192
</code></pre>
<p>Another way to convert to binary:
simply subtract the numbers from each value.
As long as there is something remaining or
the placeholder equals the remainder of the
previous subtraction,
then the bit equals 1.
So:</p>
<ul>
<li>192 - 128 = 64 -- therefore the first bit is equal to 1.</li>
<li>Now take the leftover and subtract it:</li>
<li>64 - 64 = 0 -- therefore the second bit is equal to 1.</li>
</ul>
<p>Since there is nothing remaining,
the rest of the bits equal 0.</p>
<h3 id="subnetting-examples"><a class="header" href="#subnetting-examples">Subnetting Examples</a></h3>
<p>Subnetting involves dividing a network
into two or more subnets.
When we subnet,
we first identify the number of hosts,
aka, the size,
we will require on the subnet.
For starters,
let's assume that we need a subnet that can
assign at most 254 IP addresses to the
devices attached to it via the router.</p>
<p>In order to do this,
we need two additional IP addresses:
the <strong>subnet mask</strong> and the <strong>network address/ID</strong>.
The <strong>network address identifies the network</strong> and
the <strong>subnet mask marks the boundary between the network and the hosts</strong>.
Knowing or determining the <strong>subnet mask</strong>
allows us to determine how many hosts
can exist on a network.
Both the <strong>network address</strong> and the <strong>subnet mask</strong>
can be written as IP addresses, but
these IP addresses cannot be
assigned to computers on a network.</p>
<p>When we have determined these IPs,
we will know the <strong>broadcast address</strong>.
This is the last IP address in a subnet range, and
it also cannot be assigned to a connected device/host.
The <strong>broadcast address</strong> is used by a router
to communicate to all connected devices on the subnet.</p>
<p>For our sake, let's work through this process backwards; that is,
we want to identify and describe a network
that we are connected to.
Let's work with two example private IP addresses
that exist on two separate subnets.</p>
<h4 id="example-ip-address-1-19216816"><a class="header" href="#example-ip-address-1-19216816">Example IP Address 1: 192.168.1.6</a></h4>
<p>Using the private IP address 192.168.1.6,
let's derive the network mask and the network address
(or ID) from this IP address.
First, convert the decimal notation to binary.
State the mask, which is <strong>/24</strong>, or <strong>255.255.255.0</strong>.
And then derive the network addressing
using an <strong>bitwise logical AND</strong> operation:</p>
<pre><code>11000000.10101000.00000001.00000110 IP              192.168.1.6
11111111.11111111.11111111.00000000 Mask            255.255.255.0
-----------------------------------
11000000.10101000.00000001.00000000 Network Address 192.168.1.0
</code></pre>
<p>Note the mask has 24 ones followed by 8 zeroes.
That 24 is used as <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing">CIDR</a> notation:</p>
<ul>
<li>192.168.1.6/24</li>
</ul>
<p>For Example 1, we thus have the following subnet information:</p>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>IP</th></tr></thead><tbody>
<tr><td>Netmask/Mask</td><td>255.255.255.0</td></tr>
<tr><td>Network ID</td><td>192.168.1.0</td></tr>
<tr><td>Start Range</td><td>192.168.1.1</td></tr>
<tr><td>End Range</td><td>192.168.1.254</td></tr>
<tr><td>Broadcast</td><td>192.168.1.255</td></tr>
</tbody></table>
</div>
<h4 id="example-ip-address-2-101603875"><a class="header" href="#example-ip-address-2-101603875">Example IP Address 2: 10.160.38.75</a></h4>
<p>For example 2, let's start off with a private
IP address of 10.160.38.75 and a mask of /24:</p>
<pre><code>00001010.10100000.00100110.01001011 IP               10.160.38.75
11111111.11111111.11111111.00000000 Mask            255.255.255.0
-----------------------------------
00001010.10100000.00100110.00000000 Network Address   10.160.38.0
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>IP</th></tr></thead><tbody>
<tr><td>Netmask/Mask</td><td>255.255.255.0</td></tr>
<tr><td>Network ID</td><td>10.160.38.0</td></tr>
<tr><td>Start Range</td><td>10.160.38.1</td></tr>
<tr><td>End Range</td><td>10.160.38.254</td></tr>
<tr><td>Broadcast</td><td>10.160.38.255</td></tr>
</tbody></table>
</div>
<h4 id="example-ip-address-3-1721616224"><a class="header" href="#example-ip-address-3-1721616224">Example IP Address 3: 172.16.1.62/24</a></h4>
<p>For example 3, let's start off with a private
IP address of 172.16.1.62 and a mask of /24:</p>
<pre><code>10101100 00010000 00000001 00100111 IP                172.16.1.62
11111111 11111111 11111111 00000000 Mask            255.255.255.0
-----------------------------------
10101100 00010000 00000001 00000000 Network Address    172.16.1.0
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>IP</th></tr></thead><tbody>
<tr><td>Netmask/Mask</td><td>255.255.255.0</td></tr>
<tr><td>Network ID</td><td>172.16.1.0</td></tr>
<tr><td>Start Range</td><td>172.16.1.1</td></tr>
<tr><td>End Range</td><td>172.16.1.254</td></tr>
<tr><td>Broadcast</td><td>172.16.1.255</td></tr>
</tbody></table>
</div>
<h4 id="determine-the-number-of-hosts"><a class="header" href="#determine-the-number-of-hosts">Determine the Number of Hosts</a></h4>
<p>To determine the number of hosts on a CIDR /24 subnet,
we look at the start and end ranges.
In all three of the above examples,
the start range begins with X.X.X.1 and
ends with X.X.X.254.
Therefore, there are 254 maximum hosts allowed on these subnets because
1 to 254, inclusive of 1 and 254, is 254.</p>
<h4 id="example-ip-address-4-10052316"><a class="header" href="#example-ip-address-4-10052316">Example IP Address 4: 10.0.5.23/16</a></h4>
<p>The first three examples show instances
where the CIDR is set to /24.
This only allows 254 maximum hosts on a subnet.
If the CIDR is set to /16,
then we can theoretically allow 65,534 hosts on a subnet. </p>
<p>For example 4, let's start off then with a private
IP address of 10.0.5.23 and a mask of /16:</p>
<pre><code>00001010.00000000.00000101.00010111 IP Address: 10.0.5.23
11111111.11111111.00000000.00000000 Mask:       255.255.0.0
-----------------------------------------------------------
00001010.00000000.00000000.00000000 Network ID: 10.0.0.0
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>IP</th></tr></thead><tbody>
<tr><td>IP Address</td><td>10.0.5.23</td></tr>
<tr><td>Netmask/Mask</td><td>255.255.0.0</td></tr>
<tr><td>Network ID</td><td>10.0.0.0</td></tr>
<tr><td>Start Range</td><td>10.0.0.1</td></tr>
<tr><td>End Range</td><td>10.0.255.254</td></tr>
<tr><td>Broadcast</td><td>10.0.255.255</td></tr>
</tbody></table>
</div>
<p>Since the last two octets/bytes now vary, we count up
by each octet.
Therefore, the number of hosts is:</p>
<div class="table-wrapper"><table><thead><tr><th>IPs</th><th></th></tr></thead><tbody>
<tr><td>10.0.0.1</td><td></td></tr>
<tr><td>10.0.0.255</td><td>= 256</td></tr>
<tr><td>10.0.1.1</td><td></td></tr>
<tr><td>10.0.255.255</td><td>= 256</td></tr>
</tbody></table>
</div>
<ul>
<li>Number of Hosts = 256 x 256 = 65536</li>
<li>Subtract Network ID (1) and Broadcast (1) = 2 IP addresses</li>
<li>Number of Usable Hosts = 256 x 256 - 2 = 65534</li>
</ul>
<h3 id="ipv6-subnetting"><a class="header" href="#ipv6-subnetting">IPv6 subnetting</a></h3>
<p>We're not going to cover IPv6 subnetting, but
if you're interested,
this is a nice article: <a href="https://supportforums.cisco.com/document/66991/ipv6-subnetting-overview-and-case-study">IPv6 subnetting overview</a></p>
<h2 id="conclusion-13"><a class="header" href="#conclusion-13">Conclusion</a></h2>
<p>As a systems administrator,
it's important to have a basic understanding of
how networking works, and
the basic models used to describe the internet
and its applications.
System administrators have to know how to
create subnets and defend against various
network-based attacks.</p>
<p>In order to acquire a basic understanding,
this section covered topics that included:</p>
<ul>
<li>the internet protocol suite
<ul>
<li>link layer</li>
<li>internet layer</li>
<li>transport layer</li>
</ul>
</li>
<li>IP subnetting
<ul>
<li>private IP ranges</li>
<li>IP math</li>
</ul>
</li>
</ul>
<p>In the next section,
we extend upon this and discuss the
domain name system (DNS) and domain names.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dns-and-domain-names"><a class="header" href="#dns-and-domain-names">DNS and Domain Names</a></h1>
<p>The DNS (<strong>domain name system</strong>) is referred to
as the phone book of the internet, and it's
responsible for mapping IP addresses to
memorable names.
Thus, instead of having to remember:</p>
<p>https://128.163.35.46</p>
<p>We can instead remember this:</p>
<p>https://www.uky.edu</p>
<p>System administrators need to know about DNS
because they may be responsible for administrating
a domain name system on their network, and/or
they may be responsible for setting up and
administrating web site domains.
Either case requires a basic understanding of DNS.</p>
<h2 id="dns-intro-videos"><a class="header" href="#dns-intro-videos">DNS Intro Videos</a></h2>
<p>To help you get started,
watch these two YouTube videos.
The first one provides an overview of the DNS system:</p>
<p><a href="https://www.youtube.com/watch?v=mpQZVYPuDGU">How a DNS Server (Domain Name System) works</a></p>
<p>The second video illustrates how to use a
graphical user interface to create and manage DNS records.</p>
<p><a href="https://www.youtube.com/watch?v=cwT82ibOM2Q">DNS Records</a></p>
<p>And here is a nice intro to recursive DNS:</p>
<p><a href="https://www.cloudflare.com/learning/dns/what-is-recursive-dns/">https://www.cloudflare.com/learning/dns/what-is-recursive-dns/</a></p>
<h2 id="fqdn-the-fully-qualified-domain-name"><a class="header" href="#fqdn-the-fully-qualified-domain-name">FQDN: The Fully Qualified Domain Name</a></h2>
<p>The structure of the domain name system is
like the structure of the UNIX/Linux file hierarchy;
that is, it is like an inverted tree.</p>
<p>The fully qualified domain name includes a
period at the end of the top-level domain.
Your browser is able to supply that dot
since we often don't use it when typing website addresses.</p>
<p>Thus, for Google's main page, the FQDN is:</p>
<p>FQDN: www.google.com.</p>
<p>And the parts include:</p>
<pre><code>.           root domain
com         top-level domain
google.     second-level domain
www.        third-level domain
</code></pre>
<p>This is important to know so that you understand
how the <strong>Domain Name System</strong> works and
which DNS servers are responsible for their part of the network.</p>
<h3 id="root-domain"><a class="header" href="#root-domain">Root Domain</a></h3>
<p>The root domain is managed by root name servers.
These servers are listed on the <a href="https://www.iana.org/domains/root/servers">IANA</a>,
the Internet Assigned Numbers Authority, website, but
are managed by multiple operators.
The root servers manage the root domain,
alternatively referred to as the zone, or
the <strong>.</strong> at the end of the <code>.com.</code>, <code>.edu.</code>, etc.</p>
<h4 id="alternative-dns-root-systems"><a class="header" href="#alternative-dns-root-systems">Alternative DNS Root Systems</a></h4>
<p>It's possible to have alternate internets by
using outside root name servers.
This is not common, but it happens.
Read about a few of them here:</p>
<ul>
<li>sdf: <a href="https://web.archive.org/web/20081121061730/http://www.smtpnic.org/">https://web.archive.org/web/20081121061730/http://www.smtpnic.org/</a></li>
<li>opennic: <a href="https://www.opennicproject.org/">https://www.opennicproject.org/</a></li>
<li>alternic: <a href="https://en.wikipedia.org/wiki/AlterNIC">https://en.wikipedia.org/wiki/AlterNIC</a></li>
</ul>
<p>Russia, as an example, has threated to use
it's own alternate internet based on a different
DNS root system.
This would essentially create a large, second internet.
You can read about in this <a href="https://spectrum.ieee.org/tech-talk/telecom/internet/could-russia-really-build-its-own-alternate-internet">IEEE Spectrum article</a>.</p>
<h3 id="top-level-domain-tld"><a class="header" href="#top-level-domain-tld">Top Level Domain (TLD)</a></h3>
<p>We are all familiar with top level domains.
Specific examples include:</p>
<ul>
<li>generic TLD names:
<ul>
<li>.com</li>
<li>.gov</li>
<li>.mil</li>
<li>.net</li>
<li>.org</li>
</ul>
</li>
<li>and ccTLD, <a href="https://en.wikipedia.org/wiki/Country_code_top-level_domain">country code TLDs</a>
<ul>
<li>.ca (Canada)</li>
<li>.mx (Mexico)</li>
<li>.jp (Japan)</li>
<li>.uk (United Kingdom)</li>
<li>.us (United States)</li>
</ul>
</li>
</ul>
<p>We can download a list of those top level names from IANA, and
get a total count of 1,487 (as of August 2022):</p>
<pre><code>wget https://data.iana.org/TLD/tlds-alpha-by-domain.txt
sed '1d' tlds-alpha-by-domain.txt | wc -l
</code></pre>
<h3 id="second-level-domain-names"><a class="header" href="#second-level-domain-names">Second Level Domain Names</a></h3>
<p>In the Google example,
the second level domain is <strong>google</strong>.
The second level domain along with the TLD
together, along with any further subdomains,
for the <a href="https://en.wikipedia.org/wiki/Fully_qualified_domain_name">fully qualified domain name</a>.
Other examples include:</p>
<ul>
<li><strong>redhat</strong> in <strong>redhat.com</strong></li>
<li><strong>debian</strong> in <strong>debian.org</strong>.</li>
<li><strong>wikipedia</strong> in <strong>wikipedia.org</strong></li>
<li><strong>uky</strong> in <strong>uky.edu</strong></li>
<li><strong>twitter</strong> in <strong>twitter.com</strong></li>
</ul>
<h3 id="third-level-domain-names--subdomains"><a class="header" href="#third-level-domain-names--subdomains">Third Level Domain Names / Subdomains</a></h3>
<p>When you've purchased (leased) a top and second level
domain like <strong>ubuntu.com</strong>,
you can choose whether you add third level domains.
For example: www is a third level domain or subdomain.
If you owned <code>example.org</code>,
you could dedicate a machine or a cluster of machines
to <code>www.example.org</code> that
resolve to a different location, or
<code>www.example.org</code> could resolve to the second-level domain itself.
That is:</p>
<ul>
<li>www.debian.org can point to debian.org</li>
</ul>
<p>It could also point to a separate server,
such that <strong>debian.org</strong> and <strong>www.debian.org</strong>
would be two separate servers with two separate websites or services,
just like <strong>maps.google.com</strong> points to a different
site than <strong>mail.google.com</strong>.
Both <strong>maps</strong> and <strong>mail</strong> are subdomains of <strong>google.com</strong>.
Although this is not common with third-level
domains that start with <strong>www</strong>,
it is common with others.</p>
<p>For example, with hostnames that are not <code>www</code>:</p>
<ul>
<li>google.com resolves to www.google.com</li>
<li>google.com does not resolve to:
<ul>
<li>drive.google.com, or</li>
<li>maps.google.com, or</li>
<li>mail.google.com</li>
</ul>
</li>
</ul>
<p>This is because those other three provide different,
but specific services.</p>
<h2 id="dns-paths"><a class="header" href="#dns-paths">DNS Paths</a></h2>
<p>A recursive DNS server is the first DNS server
to be queried in the DNS system,
which is usually managed by an ISP.
This is the resolver server in the first video above.
This server queries itself (recursive) to check if the
domain to IP mapping has been cached (remembered/stored) in its system.</p>
<p>If it hasn't been cached,
then the DNS query is <em>forwarded</em> to a root server.
There are thirteen root servers.</p>
<pre><code>echo {a..m}.root-servers.net.
</code></pre>
<p>Those root servers will identify the next server to query,
depending on the top level domain (.com, .net, .edu, .gov, etc.).
If the site ends in <strong>.com</strong> or <strong>.net</strong>, then
the next server might be something like:
<strong>a.gtld-servers.net.</strong>
Or if the top level domain ends in <strong>.edu</strong>, then:
<strong>a.edu-servers.net.</strong>.
If the top level domain ends in <strong>.gov</strong>, then:
<strong>a.gov-servers.net.</strong>.
And so forth.</p>
<p>Those top level domains should know where to
send the query next.
In many cases, the next path is to send the query
to a custom domain server.
For example, Google's custom name servers are:
<strong>ns1.google.com</strong> to <strong>ns4.google.com</strong>.
UK's custom name servers are:
<strong>sndc1.net.uky.edu</strong> and <strong>sndc2.net.uky.edu</strong>.
Finally, those custom name servers will know
the IP address that maps to the domain.</p>
<p>We can use the <code>dig</code> command to query
the non-cached DNS paths.
Let's say we want to follow the DNS path for <strong>google.com</strong>,
then we can start by querying any <a href="https://www.iana.org/domains/root/servers">root server</a>.
In the output, we want to pay attention to the QUERY field,
the ANSWER field, and the Authority Section.
We keep <strong>digging</strong> until the ANSWER field returns
a number greater than 0.
The following commands query one of the root servers,
which points us to one of the authoritative servers for
<strong>.com</strong> sites,
which points us to Google's custom nameserver,
which finally provides an answer,
in fact six answers,
or six IP address that all map to <strong>google.com</strong>.</p>
<pre><code>dig @e.root-servers.net google.com
dig @a.gtld-servers.net google.com
dig @ns1.google.com google.com
</code></pre>
<p>Alternatively, we can query UK's:</p>
<pre><code>dig @j.root-servers.net. uky.edu
dig @b.edu-servers.net. uky.edu
dig @sndc1.net.uky.edu. uky.edu
</code></pre>
<p>We can also get this path information using
<code>dig</code>'s trace command:</p>
<pre><code>dig google.com +trace
</code></pre>
<p>There are a lot of <a href="https://www.geeksforgeeks.org/dig-command-in-linux-with-examples/">ways to use the dig command</a>, and
you can test and explore them on your own.</p>
<h3 id="dns-record-types"><a class="header" href="#dns-record-types">DNS Record Types</a></h3>
<p>In the <code>dig</code> command output above,
you will see various fields.</p>
<ul>
<li>SOA:    Start of Authority: describes the site's DNS entries
<ul>
<li>IN:     Internet Record</li>
</ul>
</li>
<li>NS:     Name Server: state which name server provides DNS resolution</li>
<li>A:      Address records: provides mapping hostname to IPv4 address</li>
<li>AAAA:   Address records: provides mapping hostname to IPv6 address</li>
</ul>
<pre><code>dig google.com
google.com.     IN      A       142.251.32.78
</code></pre>
<p>Other record types include:</p>
<ul>
<li>PTR:    Pointer Record: provides mapping from IP Address to Hostname</li>
<li>MX:     Mail exchanger: the MX record maps your email server.</li>
<li>CNAME:  Canonical name: used so that a domain name may act as an alias for
another domain name. Thus, say someone visits www.example.org, but if no
subdomain is set up for www, then the CNAME can point to example.org.</li>
</ul>
<h3 id="dns-toolbox"><a class="header" href="#dns-toolbox">DNS Toolbox</a></h3>
<p>It's important to be able to troubleshoot DNS issues.
To do that, we have a few utilities available.
Here are examples and you should read the <code>man</code> pages for each one:</p>
<p><code>host</code>: resolve hostnames to IP Address; or IP addresses to hostnames</p>
<pre><code>man -f host
host (1) - DNS lookup utility
host uky.edu
host 128.163.35.46
host -t MX uky.edu
host -t MX dropbox.com
host -t MX netflix.com
host -t MX wikipedia.org
</code></pre>
<p><code>dig</code>: domain information gopher -- get info on DNS servers</p>
<pre><code>man -f dig
dig (1) - DNS lookup utility
dig uky.edu
dig uky.edu MX
dig www.uky.edu CNAME
</code></pre>
<p><code>nslookup</code>: query internet name servers</p>
<pre><code>man -f nslookup
nslookup (1) - query Internet name servers interactively
nslookup
&gt; uky.edu
&gt; yahoo.com
&gt; exit
</code></pre>
<p><code>whois</code>: determine ownership of a domain</p>
<pre><code>man -f whois
whois (1) - client for the whois directory services
whois uky.edu | less
</code></pre>
<p><code>resolve.conf</code>: local resolver info; what's your DNS info</p>
<pre><code>man -f  resolv.conf
resolv.conf (5) - resolver configuration file
cat /etc/resolv.conf
resolvectl status
</code></pre>
<h2 id="conclusion-14"><a class="header" href="#conclusion-14">Conclusion</a></h2>
<p>In the same way that phones have phone numbers,
servers on the internet have IP addresses.
Since we're only human,
we don't remember every phone number that we dial or
every IP address that we visit.
In order to make such things human friendly,
we use names instead.</p>
<p>Nameservers and DNS records act as the phone book
and phone book entries of the internet.
Note that I refer to the <strong>internet</strong> and not the <strong>web</strong> here.
There is more at the application layer than the HTTP/HTTPS protocols,
and so other types of servers,
e.g., mail servers,
may also have domain names and IP addresses to resolve.</p>
<p>In this section, we covered the basics of DNS that include:</p>
<ul>
<li>FQDN: the Fully Qualified Domain Name</li>
<li>Root domains</li>
<li>Top level domains (TLDs) and Country Code TLDS (ccTLDs)</li>
<li>Second level and third level domains/subdomains</li>
<li>DNS paths, and</li>
<li>DNS record types</li>
</ul>
<p>We'll come back to this material when we set up our websites.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="local-security"><a class="header" href="#local-security">Local Security</a></h1>
<h2 id="introduction-5"><a class="header" href="#introduction-5">Introduction</a></h2>
<p>Most security issues come from the network, but
we also need to secure a system from insider attacks, too.
We can do that by setting appropriate file permissions and
by making sure users on a system do not have certain kinds
of access (e.g., <code>sudo</code> access)
to some utilities.
For example, the <code>/usr/bin/gcc</code> program is the
GNU C and C++ compiler.
If users have unrestricted access to that compiler,
then it's possible for them to compile programs
that compromise the system.</p>
<p>In the next section,
we'll cover how to set up a firewall, but
in this section,
we'll learn how to set up a <strong>chroot jail</strong>.</p>
<p>As we all know,
the Linux file system has a root directory <strong>/</strong>,
and under this directory are other directories like
<strong>/home</strong>, <strong>/bin</strong>, and so forth.
A chroot (<strong>change root</strong>) jail
is a way to create a pseudo root directory
at some specific location in the directory tree, and
then build an environment in that pseudo root directory
that offers some applications.
One that environment is setup,
we can then confine a user account(s) to that
pseudo directory, and
when they login to the server,
they will only be able to see
(e.g., with the <code>cd</code> command)
what's in that pseudo root directory and
only be able to use the applications that
we've made available in that chroot.</p>
<p>Thus, a <strong>chroot jail</strong> is a technology used
to change the
&quot;apparent root <strong>/</strong> directory for a user or a process&quot; and
confine that user to that location on the system.
A user or process that is confined to the
<strong>chroot jail</strong> cannot easily see or access
the rest of the file system and 
will have limited access to the binaries
(executables/apps/utilities) on the system.
From its <code>man</code> page:</p>
<pre><code>chroot (8) - run command or interactive shell with special root directory
</code></pre>
<p>Although it is not security proof,
it does have some useful security use cases.
Some use <code>chroot</code> to contain DNS servers, for example.</p>
<p><code>chroot</code> is also the conceptual basis for some kinds of
virtualization technologies that are common today,
like <a href="https://en.wikipedia.org/wiki/Docker_(software)">Docker</a>.</p>
<h2 id="chroot-a-current-user"><a class="header" href="#chroot-a-current-user">Chroot a Current User</a></h2>
<p>In this tutorial,
we are going to create a <code>chroot</code> for a human user account.</p>
<ol>
<li>
<p>Let's create a new user. After we create the new user, we will <code>chroot</code>
that user going forward.</p>
<pre><code>sudo adduser vader
</code></pre>
</li>
<li>
<p>Next, we <code>chroot</code> <em>vader</em> into a new directory. That directory will be
located at <code>/opt/chroot</code>. Note that the root directory for our regular
users is <code>/</code>, but user <em>vader</em>'s root directory will be different
<code>/opt/chroot</code>, even if they can't tell. We also want to check the
permissions of the new directory and make sure it's owned by root. If not,
use <code>chown root:root /opt/chroot</code> to set it.</p>
<pre><code>sudo mkdir /opt/chroot
ls -ld /opt/chroot
</code></pre>
</li>
<li>
<p>Now we set up available binaries for the user. We'll only allow <code>bash</code> for
now.  To do that, we'll create a <code>/usr/bin</code> directory in /opt/chroot, and
copy <code>bash</code> to that directory.</p>
<pre><code>which bash
sudo mkdir -p /opt/chroot/usr/bin
cp /usr/bin/bash /opt/chroot/usr/bin/
</code></pre>
</li>
<li>
<p>Large software applications have dependencies (aka, libraries). We need to
copy those libraries to our chroot for the applications, like Bash, to
function. To identify libraries needed by bash, we use the <code>ldd</code> command:</p>
<pre><code>ldd /usr/bin/bash
</code></pre>
<p>Use the <code>locate</code> command to identify the locations of the libraries. The
ones we need should be located in the <strong>/usr/lib/x86_64-linux-gnu/</strong>
directory. The <code>locate</code> command might need to be installed and updated
first. Here I show how to use it to locate one of the dependencies, but
there are more than one for you to locate:</p>
<pre><code>sudo apt install mlocate
sudo updatedb
locate libtinfo.so.6
...
...
...
</code></pre>
<p>Create a <strong>/opt/chroot/lib/x86_64-linux-gnu/</strong> directory for the libraries.
We'll name the library directory after the originals to stay consistent
with the main environment.</p>
<pre><code>sudo mkdir -p /opt/chroot/lib/x86_64-linux-gnu
sudo cp /usr/lib/x86_64-linux-gnu/libtinfo.so.6 \
  /opt/chroot/lib/x86_64-linux-gnu/
</code></pre>
</li>
<li>
<p>Create and test the <code>chroot</code></p>
<pre><code>sudo chroot /opt/chroot/
bash-5.1# ls
bash: ls: command not found
bash-5.1# help
bash-5.1# dirs
bash-5.1# cd bin/
bash-5.1# dirs
bash-5.1# cd ../lib64/
bash-5.1# dirs
bash-5.1# cd ..
bash-5.1# exit
</code></pre>
</li>
<li>
<p>Create a new group called <em>chrootjail</em>. We can add users to this group that
we want to jail. Instructions are based on <a href="https://linuxconfig.org/how-to-automatically-chroot-jail-selected-ssh-user-logins">linuxconfig.org</a>.</p>
<pre><code>groupadd chrootjail
usermod -a -G chrootjail vader
groups vader
</code></pre>
</li>
<li>
<p>Edit <code>/etc/ssh/sshd_config</code> to direct users in the <code>chrootjail</code> group to
the <code>chroot</code> directory. Add the following line at the end of the file.
Then restart ssh server.</p>
<pre><code>sudo nano /etc/ssh/sshd_config
Match group chrootjail
            ChrootDirectory /var/chroot/
</code></pre>
<p>Exit <code>nano</code>, and restart <code>ssh</code>:</p>
<pre><code>systemctl restart sshd
</code></pre>
</li>
<li>
<p>Test the <code>ssh</code> connection for the <em>vader</em> user.</p>
<pre><code>ssh vader@localhost
-bash-5.1$ ls
-bash: ls: command not found
exit
</code></pre>
<p>That works as expected. The user <em>vader</em> is now restricted to a special
directory and has limited access to the system or to any utilities on that
system.</p>
</li>
</ol>
<h2 id="exercise"><a class="header" href="#exercise">Exercise</a></h2>
<p>By using the <code>ldd</code> command,
you can add additional binaries for this user.
As an exercise,
use the <code>ldd</code> command to locate
the libraries for the <code>nano</code> editor, and
make <code>nano</code> available to the user <em>vader</em>
in the chrooted directory.</p>
<h2 id="conclusion-15"><a class="header" href="#conclusion-15">Conclusion</a></h2>
<p>Systems need to be secure from the inside and out.
In order to secure from the inside,
system users should be given access and permissions
as needed.</p>
<p>In this section, we covered how to create a <strong>chroot jail</strong>
for a new user on our system.
The jail confines the user to this pseudo location
and provides the user limited access to that file system and
to the software on the system.</p>
<p>We can jail non-human users, too.
Any user listed in <code>/etc/passwd</code> can be jailed, and
most users listed in that file are services.</p>
<p>Jailing a human user may not be necessary.
On a multi-user system,
proper education and training about the policies
and uses of the system may be all that's needed.
But in case a stricter environment is needed,
now you know how to create a <strong>chroot jail</strong>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="firewalls-and-backups"><a class="header" href="#firewalls-and-backups">Firewalls and Backups</a></h1>
<h2 id="google-cloud-firewall-and-ubuntus-ufw"><a class="header" href="#google-cloud-firewall-and-ubuntus-ufw">Google Cloud Firewall and Ubuntu's UFW</a></h2>
<p>A firewall program allows or denies connections for
incoming (<strong>ingress</strong>) or outgoing (<strong>egress</strong>) traffic.
Traffic can be controlled by link layer
(e.g., a network interface such as an ethernet or wireless card),
by IP layer,
e.g., IPv4 or IPv6 address or address ranges;
by transport layer,
e.g., TCP, UDP, etc.;
or by application layer via port numbers,
e.g., HTTP (port 80), HTTPS (port 443),
SSH (port 22), SMTPs (port 465), etc.
Firewalls have other abilities.
For example, they can also place limits
on the number of attempts to connect.</p>
<blockquote>
<p>As a side note, physical, bare metal servers
may have multiple ethernet
network interface cards (NICs).
Each NIC would, of course, have its own MAC address,
and therefore would be assigned different IP addresses.
Thus, at the link layer, incoming connections can be
completely blocked on one card and then outgoing connections
can be completely blocked on the other.
This is a made up scenario.
In practice, whatever firewall rules in place would
be such that would make sense for the person or
organization creating them.</p>
</blockquote>
<p>To control these types of connections,
firewalls apply rules.
A rule may block all incoming connections, but
then allow SSH traffic through port 22,
either via TCP or UDP, and
then further restrict SSH connections to a
specific IP range.
And/or, another rule may block all incoming,
unencrypted HTTP connections through port 80, but
allow all incoming, encrypted HTTPS connections 
through port 443.</p>
<p>Let's briefly cover two ways to define
firewall rules.
When we set up our LAMP servers in the
last part of this course,
we'll need to implement some rules to
allow outside connections to our server.</p>
<blockquote>
<p>LAMP originally referred to Linux, Apache, MySQL, and PHP;
these four technologies create a web server.
Technically, only Linux (or some other OS) and
Apache (or some other web server software)
are needed to serve a website.
PHP and MySQL provide additional functionality,
like the ability for a website to interact with a
relational database.
The <strong>M</strong> in LAMP may also refer to MariaDB,
which is a fully open source clone of MySQL.
We'll use MariaDB later in this course.</p>
</blockquote>
<p>First, our Google Cloud instance is
<a href="https://cloud.google.com/vpc/docs/firewalls#more_rules_default_vpc">pre-populated with default firewall rules</a>
at the network level, and
the <a href="https://cloud.google.com/vpc/docs/firewalls">documentation</a>
provides an overview of these rules.
Second, Ubuntu uses a firewall
called <a href="https://help.ubuntu.com/community/UFW">ufw</a>, which
can be used to control additional connections
at the operating system level.
(Please read the documentation at those three links.)</p>
<p>It's important to know that these two firewalls provide
protection at different traffic stops, so to speak.
By that I mean,
a Google Cloud firewall rule may allow SSH (port 22)
traffic to a server instance, but
if Ubuntu's <code>ufw</code> firewall blocks port 22
connections at the server level,
then SSH traffic won't pass through.
In other words, incoming connections must pass
through the network firewall first, and then pass
through the server firewall second.
Outgoing connections must pass through
the server firewall first, and
then the network firewall second.</p>
<p>It's also important to know that Ubuntu's <code>ufw</code> firewall
is disabled by default.
In fact, it may be overkill to use both
Google Cloud's firewall and Ubuntu's <code>ufw</code>, or
it may not.
It simply depends on our needs and our circumstances.</p>
<p>We'll return to firewalls and put some rules
into practice when we work on our LAMP setup.</p>
<h2 id="backups"><a class="header" href="#backups">Backups</a></h2>
<p>Catastrophes (natural, physical, criminal, or out of negligence) happen, and
as a systems administrator,
you may be required to have backup strategies
to mitigate data loss.</p>
<p>How you backup depends on the machine.
If I am managing physical hardware, for instance,
and I want to backup a physical disk to another physical disk,
then that requires a specific tool.
However, if I am managing virtual machines,
like our Google Cloud instance,
then that requires a different tool.
Therefore, in this section,
I will briefly cover both scenarios.</p>
<h3 id="rsync"><a class="header" href="#rsync">rsync</a></h3>
<p>If we were managing bare metal machines, then
we might use a program like <code>rsync</code> to backup
physical disk drives.
<code>rsync</code> is a powerful program.
It can copy disks, directories, and files.
It can copy files from one location,
and send the copies, encrypted, to a remote server.</p>
<p>For example, let's say I mount an external hard drive
to my filesystem at <strong>/mnt/backup</strong>.
To copy my home directory,
I'd use:</p>
<pre><code>rsync -av /home/me/ /mnt/backup/
</code></pre>
<p>where <strong>/home/me/</strong> is the <strong>source directory</strong>, and
<strong>/mnt/backup/</strong> is the <strong>destination directory</strong>.</p>
<p>Syntax matters here.
If I include the trailing slash on
the source directory,
then <code>rsync</code> will copy everything in <strong>/home/me/</strong>
to <strong>/mnt/backup/</strong>.
However, if I leave the trailing slash off,
like so:</p>
<pre><code>rsync -av /home/me /mnt/backup/
</code></pre>
<p>then the result will be that the directory <strong>me/</strong>
will be copied to <strong>/mnt/backup/me/</strong>.</p>
<p>Let's see this in action.
Say I have two directories.
In the <strong>tmp1/</strong> directory,
there are two files: <strong>file1</strong> and <strong>file2</strong>.
The <strong>tmp2/</strong> directory is empty.
To copy <strong>file1</strong> and <strong>file2</strong> to <strong>tmp2</strong>, then:</p>
<pre><code>ls tmp1/
file1 file2
rsync -av tmp1/ tmp2/
ls tmp2
file1 file2
</code></pre>
<p>However, if I leave that trailing slash
off the source directory,
then the <strong>tmp1/</strong> will get copied to <strong>tmp2/</strong>:</p>
<pre><code>ls tmp1
file1 file2
rsync -av tmp1 tmp2/
ls tmp2/
tmp1/
ls tmp2/tmp1/
file1 file2
</code></pre>
<p><code>rsync</code> can also send a source directory
to a directory on a remote server, and
the directory and files being copied will
be encrypted on the way.
To do this, we use <code>ssh</code> style syntax:</p>
<pre><code>rsync -av tmp1/ USER@REMOTE:~/tmp2/
</code></pre>
<p>For example:</p>
<pre><code>rsync -av tmp1 linus@222.22.33.333:~/tmp2/
</code></pre>
<p>In fact, not only do I use <code>rsync</code> to backup
my desktop computer to external hard drives,
I also use a command like the above to copy
local web projects to remote servers.</p>
<h3 id="delete-option"><a class="header" href="#delete-option">Delete Option</a></h3>
<p><code>rsync</code> has a
<code>--delete</code> option.
Adding this option means that <code>rsync</code> will
synchronize the source directory with the destination directory.
This means that if I had already created a backup
of <strong>tmp1</strong> to <strong>tmp2</strong>, and 
then delete <strong>file1</strong> in <strong>tmp1</strong> later,
then run <code>rsync</code> with the delete option,
then <code>rsync</code> will also delete <strong>file1</strong> from <strong>tmp2/</strong>.
This is how that looks:</p>
<pre><code>ls tmp1/
file1 file2
rsync -av tmp1/ tmp2/
ls tmp2/
file1 file2
rm tmp1/file1
ls tmp1/
file2
rsync -av --delete tmp1/ tmp2/
ls tmp2
file2
</code></pre>
<p>Backups are no good if we don't know how to restore
a backup to a disk.
To restore with <code>rsync</code>, we just reverse the
destination directory with the source directory:</p>
<pre><code>rsync -av tmp2/ tmp1/
</code></pre>
<h3 id="google-cloud"><a class="header" href="#google-cloud">Google Cloud</a></h3>
<p>Since our instance on Google Cloud is a virtual machine,
we can use the Google Cloud console to create 
<strong>snapshots</strong> of our instance.
A <strong>snapshot</strong> is a copy of a virtual machine at 
the time the snapshot was taken.
What's great about taking a snapshot is that
the result is basically a file of a complete operating system.
Since it's a file,
it can itself be used in other projects or used
to restore a machine to the time the snapshot was taken.</p>
<p>Snapshots may also be used to document or reproduce other's work.
For example, if I worked with programmers,
as a systems administrator,
I might help a programmer share snapshots of a virtual
machine with other programmers.
Those other programmers could then restore
the snapshot in their own instances,
and see and run the original work
in the environment it was created in.</p>
<p>Taking snapshots in Google Cloud is very straightforward, but
since it does take up extra storage,
it will accrue extra costs.
Since we want avoid that for now,
please see the following documentation for how to take
a snapshot in Google Cloud:</p>
<p><a href="https://cloud.google.com/compute/docs/disks/create-snapshots">Create and manage disk snapshots</a></p>
<h2 id="conclusion-16"><a class="header" href="#conclusion-16">Conclusion</a></h2>
<p>In this section,
we covered firewalls and backups.
Since we're running an Ubuntu server on Google Cloud,
we have Google Cloud options
for creating firewall rules at the network level and
for backing up disks as snapshots, and
we have Ubuntu options for creating firewall rules at the OS level and
for backing up disks using commands like <code>rsync</code>.</p>
<p>How we go about either depends entirely on our needs
or on our organization's needs.
But knowing these options exist and
the different reasons why we have these options,
provides quite a bit of utility.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="creating-a-lamp-server"><a class="header" href="#creating-a-lamp-server">Creating a LAMP Server</a></h1>
<p>In this section,
we learn how to set up a LAMP
(Linux, Apache, MariaDB, PHP) stack.
This stack enables us to create a web server
that provides extra funtionality via PHP and MariaDB.
Even if we do not become web server administrators,
knowing how to set up a LAMP stack is not only fun, but
it's also a valuable skill to have.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installing-the-apache-web-server"><a class="header" href="#installing-the-apache-web-server">Installing the Apache Web Server</a></h1>
<h2 id="introduction-6"><a class="header" href="#introduction-6">Introduction</a></h2>
<p><a href="https://httpd.apache.org/">Apache</a> is an HTTP server,
otherwise called web server software.
Other HTTP server software exists.
Another big one is <a href="https://nginx.org/en/">nginx</a>.
An HTTP server essentially makes files on a computer available
to others who are able to establish a
connection to the computer and view the files
with a web browser.</p>
<p>It's important to understand the basics of an HTTP server, and
therefore I ask you to read Apache's
<a href="https://httpd.apache.org/docs/2.4/getting-started.html">Getting Started</a> page before
proceeding with the rest of this section.
Each of the main sections on that page describe
the important elements that make up and serve a website,
including</p>
<ul>
<li>clients, servers, and URLs</li>
<li>hostnames and DNS</li>
<li>configuration files and directives</li>
<li>web site content</li>
<li>log files and troubleshooting</li>
</ul>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<p>Before we install Apache,
we need to update our systems first.</p>
<pre><code>sudo apt update
sudo apt -y upgrade
</code></pre>
<p>Once the machine is updated,
we can install Apache2 using <code>apt</code>.
First we'll use <code>apt search</code> to identify
the specific package name.
I already know that a lot of results
will be returned,
so let's <strong>pipe</strong> the <code>apt search</code> command
through <code>head</code> to look at the initial results:</p>
<pre><code>sudo apt search apache2 | head
</code></pre>
<p>The package that we're interested in
happens to be named <strong>apache2</strong> on Ubuntu.
This is not a given.
On other distributions,
like Fedora,
the Apache package is called <strong>httpd</strong>.
To learn more about the <strong>apache2</strong> package,
let's examine it with the <code>apt show</code> command:</p>
<pre><code>apt show apache2
</code></pre>
<p>Once we've confirmed that <strong>apache2</strong> is the package
that we want,
we install it with the <code>apt install</code> command.
Press <strong>Y</strong> to agree to continue after running
the command below:</p>
<pre><code>sudo apt install apache2
</code></pre>
<h2 id="basic-checks"><a class="header" href="#basic-checks">Basic checks</a></h2>
<p>One of the things that makes Apache2, and
some other web servers,
powerful is the library of modules that
extend Apache's functionality.
We'll come back to modules soon.
For now,
we're going to make sure the server is up and running,
configure some basic things, and
then create a basic web site.</p>
<p>To start,
let's use <code>systemctl</code> to acquire some info about <strong>apache2</strong> and
make sure it is <em>enabled</em> and <em>running</em>:</p>
<pre><code>systemctl list-unit-files apache2.service
systemctl status apache2
</code></pre>
<p>The output shows that <strong>apache2</strong> is enabled,
which means that it will start running automatically
if the computer gets rebooted.</p>
<p>The output of the second command also shows
that <strong>apache2</strong> is enabled and
that it is also active (running).</p>
<h2 id="creating-a-web-page"><a class="header" href="#creating-a-web-page">Creating a web page</a></h2>
<p>Since <strong>apache2</strong> is up and running,
let's look at the default web page.</p>
<p>There are two ways we can look at the default web page.
We can use a command line web browser.
There are a number available, but
I like <code>w3m</code>.</p>
<p>We can also use our regular web browsers and view
the site by entering the IP address of the server
in our browser URL bar.</p>
<p>To check with <code>w3m</code>,
we have to install it first:</p>
<pre><code>sudo apt install w3m
</code></pre>
<p>Once it's installed,
we can visit our default site using the loopback IP address
(aka, <em>localhost</em>).
From the command line on our server,
we can run either of these two commands:</p>
<pre><code>w3m 127.0.0.1
w3m localhost
</code></pre>
<p>We can also get the subnet/private IP address
using the <code>ip a</code> command, and
then use that with <code>w3m</code>.
For example, if <code>ip a</code> showed that my NIC
has an IP address of <strong>10.0.1.1</strong>, then
I could use <code>w3m</code> with that IP address:</p>
<pre><code>w3m 10.0.1.1
</code></pre>
<p>If the <strong>apache2</strong> installed and started correctly,
then you should see the following text at the top
of the screen:</p>
<p><strong>Apache2 Ubuntu Default Page</strong><br />
<strong>It works!</strong></p>
<p>To exit <code>w3m</code>,
press <strong>q</strong> and then <strong>y</strong> to confirm exit.</p>
<p>To view the default web page using
a regular web browser,
like Firefox, Chrome, Safari, Edge, or etc.,
you need to get our server's public IP address.
To do that,
log into the
<a href="https://console.cloud.google.com/">Google Cloud Console</a>,
in the left hand navigation panel,
hover your cursor over the <strong>Compute Engine</strong> link, and
then click on <strong>VM instances</strong>.
You should see your <strong>External IP</strong> address
in the table on that page.
You can copy that external IP address or
simply click on it to open it in a new browser tab.
Then you should see the graphical version of the
<strong>Apache2 Ubuntu Default Page</strong>.</p>
<p>Please take a moment to read through
the text on the default page.
It provides important information about
where Ubuntu stores configuration files and
what those files do, and
document roots,
which is where website files go.</p>
<h2 id="create-a-web-page"><a class="header" href="#create-a-web-page">Create a Web Page</a></h2>
<p>Let's create our first web page.
The default page described above provides
the location of the document root at
<strong>/var/www/html</strong>.
When we navigate to that location,
we'll see that there is already an <strong>index.html</strong>
file located in that directory.
This is the <strong>Apache2 Ubuntu Default Page</strong>
that we described above.
Let's rename that <strong>index.html</strong> file,
and create a new one:</p>
<pre><code>cd /var/www/html/
sudo mv index.html index.html.original
sudo nano index.html
</code></pre>
<p>If you know HTML, then
feel free to write some basic HTML code to get started.
Otherwise, you can re-type the content below
in <code>nano</code>, and
then save and exit out.</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;My first web page using Apache2&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;h1&gt;Welcome&lt;/h1&gt;

&lt;p&gt;Welcome to my web site. I created this site using the Apache2 HTTP server.&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>If you have our site open in your web browser,
reload the page, and you should see
the new text.</p>
<p>You can still view the original default page by
specifying its name in the URL.
For example, if your <strong>external IP address</strong> is
<strong>55.222.55.222</strong>, then you'd specify it like so:</p>
<pre><code>http://55.222.55.222/index.html.original
</code></pre>
<h2 id="user-directories"><a class="header" href="#user-directories">User Directories</a></h2>
<p>You may have visited sites in the past
that have a tilde in the URL and look like this:</p>
<pre><code>http://example.com/~user/
</code></pre>
<p>These are called user directories, and
the provide additional path to the <strong>document root</strong>
that's located in users' home directories
in a directory called <strong>public_html</strong>.
This is the default document root for user directories,
but the default can be changed to different locations.
Please read the documentation on what's called the
<a href="https://httpd.apache.org/docs/2.4/mod/mod_userdir.html">Apache Module mod_userdir</a> before proceeding.</p>
<p>By default, users with accounts on the server
need to have a <strong>public_html</strong> directory
in their home directories, and
Apache2 needs to be configured
to serve sites from those directories.
For example, for the user <strong>linus</strong>,
they should have the following file path available:</p>
<pre><code>/home/linus/public_html/
</code></pre>
<h3 id="enable-mod_userdir"><a class="header" href="#enable-mod_userdir">Enable mod_userdir</a></h3>
<p>The configuration file for <strong>mod_userdir</strong> is
located in <strong>/etc/apache2/mods-available/</strong>
and is named <strong>userdir.conf</strong>.
Files in this directory are modules that
are available to Apache2 but that are not
enabled (i.e., they're turned off) by default.
We can view that the <strong>userdir.conf</strong> file
with the <code>less</code> command:</p>
<pre><code>less /etc/apache2/mods-available/userdir.conf
</code></pre>
<p>The default configuration does not need to be modified.
Therefore, all we need to do is enable this module.
To do that, we use the <code>a2enmod</code> Apache2 command
(see <code>man a2enmod</code> for details.)</p>
<pre><code>sudo a2enmod userdir
</code></pre>
<p>After enabling,
we need to reload the HTTP service, and
we can also check its status:</p>
<pre><code>sudo systemctl restart apache2
systemctl status apache2
</code></pre>
<h3 id="create-a-user-directory-website"><a class="header" href="#create-a-user-directory-website">Create a User Directory Website</a></h3>
<p>Let's say I am logged in as the user <strong>linus</strong> on the system and
will use that to test if the user directory is working.
First, let's go home.
For me, as the user <strong>linus</strong>,
that would <strong>/home/linus/</strong>, and
I just have to type in the <code>cd</code> command and press Enter:</p>
<pre><code>cd
</code></pre>
<p>Now I need to create a <strong>public_html</strong> directory
in my home directory
(<strong>make sure you're in your home directory!</strong>), and
change into that directory:</p>
<pre><code>mkdir public_html
cd public_html
</code></pre>
<p>By default, Apache2 looks for a file
named <strong>index.html</strong> in the document root.
I'll create that and add some basic HTML to it:</p>
<pre><code>nano index.html
</code></pre>
<p>And in that file:</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;My home site&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;p&gt;This is my home site.&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Now simply add <strong>/~linus/</strong> to your external IP
address in your browser's URL bar.
Like so
(of course, replace the external IP address with
your external IP address and the username with
the username that you're using):</p>
<pre><code>http://55.222.55.222/~linus/
</code></pre>
<p>Note that this process is pretty easy but
that it will be different on other distributions.
For example, the <strong>Fedora</strong> distribution has different
<strong>Apache2</strong> defaults.
Also, on some distributions,
we might need to change the directory permissions
before this will work.
By default, Ubuntu sets directory permissions to
on our home directories to:</p>
<pre><code>drwxr-xr-x
</code></pre>
<p>That means that any user can view the contents
of our home directories.
And Ubuntu sets directories created with <code>mkdir</code>
in the home directory with these permissions by default:</p>
<pre><code>drwxrwxr-x
</code></pre>
<p>These default settings make those directories
world readable, but
other distributions do not default to those permissions.
If the last <code>r-x</code> was set to <code>---</code>, then
we would need to use the <code>chmod</code> command
to make these directories executable and readable
before files in our <strong>public_html</strong> directory
could be accessed in a browser.</p>
<h2 id="conclusion-17"><a class="header" href="#conclusion-17">Conclusion</a></h2>
<p>In this section,
we learned about the Apache2 HTTP server.
We learned how to install it on Ubuntu,
how to use systemd (<code>systemctl</code>) commands
to check its default status,
how to create a basic web page in <strong>/var/www/html</strong>,
how to view that web page using the <code>w3m</code>
command line browser and with our regular graphical browser,
how to enable the user directory module, and
repeat the steps above to create a website
in our home directories.</p>
<p>In the next section,
we will learn how to make our sites applications
by installing PHP and enabling the relevant PHP modules.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installing-and-configuring-php"><a class="header" href="#installing-and-configuring-php">Installing and Configuring PHP</a></h1>
<h2 id="introduction-7"><a class="header" href="#introduction-7">Introduction</a></h2>
<p>Client-side programming languages, like JavaScript,
are handled by the browser.
Major browsers like Firefox, Chrome, Safari, Edge, etc.
all include <a href="https://en.wikipedia.org/wiki/JavaScript_engine">JavaScript engines</a> that use
just-in-time compilers to execute the JavaScript code
(Mozilla has a <a href="https://blog.mozilla.org/javascript/">nice description</a> of the process.)
From an end user's perspective,
you basically install JavaScript when you install a web browser.</p>
<p><a href="https://www.php.net/">PHP</a>, on the other hand,
is a server-side programming language,
which means it must be installed on the server
in order to be used.
From a system or web administrator's perspective,
this means that not only does PHP have be installed
on a server, but
it must also be configured to work with the HTTP server,
which in our case is Apache2.</p>
<p>The main use of PHP is to interact with databases,
like MySQL, MariaDB, PostgreSQL, etc.,
in order to create dynamic page content.
This is our goal in the last part of this class.
To accomplish this, we have to:</p>
<ol>
<li>Install PHP and relevant Apache2 modules</li>
<li>Configure PHP and relevant modules to work with Apache2</li>
<li>Configure PHP and relevant modules to work with MariaDB</li>
</ol>
<h2 id="install-php"><a class="header" href="#install-php">Install PHP</a></h2>
<p>As normal, we will use <code>apt install</code>
to install PHP and relevant modules and
then restart Apache2 using the <code>systemctl</code> command:</p>
<pre><code>sudo apt install php libapache2-mod-php
sudo systemctl restart apache2
</code></pre>
<p>We can check its status and
see if there are any errors:</p>
<pre><code>systemctl status apache2
</code></pre>
<h2 id="check-install"><a class="header" href="#check-install">Check Install</a></h2>
<p>To check that it's been installed and that
it's working with Apache2,
we can create a small PHP file in our
web document root.
To do that,
we change to the <strong>/var/www/html/</strong> directory, and
create a file called <strong>info.php</strong>:</p>
<pre><code>cd /var/www/html/
sudo nano info.php
</code></pre>
<p>In that file,
add the following text,
then save and close the file:</p>
<pre><code>&lt;?php
phpinfo();
?&gt;
</code></pre>
<p>No visit that file using the external IP address
for your server.
For example, in Firefox, Chrome, etc, go to
(<strong>be sure to replace the IP below with your IP address</strong>):</p>
<pre><code>http://55.333.55.333/info.php
</code></pre>
<p>You should see a page that provides system information
about PHP, Apache2, and the server.
The top of the page should look like Figure 1 below:</p>
<figure>
<img src="images/24-phpinstall.png"
alt="PHP install page"
title="PHP install page">
<figcaption>
Fig. 1. A screenshot of the title of the PHP install page.
</figcaption>
</figure>
<h2 id="basic-configurations"><a class="header" href="#basic-configurations">Basic Configurations</a></h2>
<p>By default, when Apache2 serves a web page,
it looks for and servers a
<a href="https://httpd.apache.org/docs/current/mod/mod_dir.html">file titled <strong>index.html</strong></a>,
even if it does not display that file in the URL bar.
Thus, <code>http://example.com/</code> actually
resolves to <code>http://example.com/index.html</code>
in such cases.</p>
<p>However, if our plan is to provide for PHP,
we want Apache2 to default to a file titled <strong>index.php</strong> instead and
to the <strong>index.html</strong> file as backup.
To configure that,
we need to edit the <strong>dir.conf</strong> file
in the <strong>/etc/apache2/mods-enabled/</strong> directory.
In that file there is a line that starts with
<strong>DirectoryIndex</strong>.
The first file in that line is <strong>index.html</strong>, and then
there are a series of other files that Apache2 will
look for in the order listed.
If any of those files exist in the document root,
then Apache2 will serve those before proceeding to the next.
We simply want to put <strong>index.php</strong> first and let
<strong>index.html</strong> be second on that line.</p>
<pre><code>cd /etc/apache2/mods-enabled/
sudo nano dir.conf
</code></pre>
<p>And change the line to this:</p>
<pre><code>DirectoryIndex index.php index.html index.cgi index.pl index.xhtml index.htm
</code></pre>
<p>Whenever we make a configuration change,
we can use the <code>apachectl</code> command to
check our configuration:</p>
<pre><code>apachectl configtest
</code></pre>
<p>If we get an <strong>Syntax Ok</strong> message,
you can reload the Apache2 configuration and
restart the service:</p>
<pre><code>sudo systemctl reload apache2
sudo systemctl restart apache2
</code></pre>
<p>Now create a basic PHP page.
<code>cd</code> back to the document root directory and
use <code>nano</code> to create and open and <code>index.php</code> file:</p>
<pre><code>cd /var/www/html/
nano index.php
</code></pre>
<h2 id="creating-an-indexphp-file"><a class="header" href="#creating-an-indexphp-file">Creating an index.php File</a></h2>
<p>Let's now create an <strong>index.php</strong> page, and
add some HTML and PHP to it.
The PHP can be a simple <a href="https://stackoverflow.com/questions/8754080/how-to-get-exact-browser-name-and-version">browser detector</a>.
Change to the <strong>/var/www/html/</strong> directory,
and use <code>sudo nano</code> to create and edit <strong>index.php</strong>.
Then add the following code:</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Broswer Detector&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p&gt;You are using the following browser to view this site:&lt;/p&gt;

&lt;?php
echo $_SERVER['HTTP_USER_AGENT'] . &quot;\n\n&quot;;

$browser = get_browser(null, true);
print_r($browser);
?&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Next, save the file and exit <code>nano</code>.
In your browser,
visit your external IP address site:</p>
<pre><code>http://55.333.55.333/
</code></pre>
<p>Although your <strong>index.html</strong> file still exists
in your document root,
Apache2 now returns the <strong>index.php</strong> file
instead.
However, if for some reason the <strong>index.php</strong>
was deleted,
then Apache2 would revert to the <strong>index.html</strong> file
since that's what's next in the <strong>dir.conf</strong>
<strong>DirectoryIndex</strong> line.</p>
<h2 id="conclusion-18"><a class="header" href="#conclusion-18">Conclusion</a></h2>
<p>In this section,
we installed PHP and configured it work with Apache2.
We also created a simple PHP test page
that reported our browser user agent information
on our website.</p>
<p>In the next section,
we'll learn how to complete the LAMP stack
by adding the MariaDB relational database
to our setup.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installing-and-configuring-mariadb"><a class="header" href="#installing-and-configuring-mariadb">Installing and Configuring MariaDB</a></h1>
<h2 id="introduction-8"><a class="header" href="#introduction-8">Introduction</a></h2>
<p>We started our LAMP stack when we installed
Apache2 on Linux, and
then we added extra functionality when
we installed and configured PHP to work with Apache2.
In this section, our objective is to complete
the LAMP stack and install and configure <a href="https://en.wikipedia.org/wiki/MariaDB">MariaDB</a>,
a (so-far) compatible fork of the MySQL relational database.</p>
<p>If you need a refresher on relational databases, the
MariaDB website can help. See:
<a href="https://mariadb.com/kb/en/introduction-to-relational-databases/">Introduction to Relational Databases</a>.</p>
<p>It's also good to review the documentation for any
technology that you use.
MariaDB has <a href="https://mariadb.org/documentation/">good documentation</a> and
getting started pages.</p>
<h2 id="install-and-set-up-mariadb"><a class="header" href="#install-and-set-up-mariadb">Install and Set Up MariaDB</a></h2>
<p>In this section, we'll learn how to install,
setup, secure, and configure the MariaDB
relational database so that it works
with the Apache2 web server and
the PHP programming language.</p>
<p>First, let's install MariaDB Community Server, and
then log into the MariaDB shell
under the <strong>MariaDB root</strong> account.</p>
<pre><code>sudo apt install mariadb-server mariadb-client
</code></pre>
<p>This should also start and enable the database server, but
we can check if it's running and enabled
using the <code>systemctl</code> command:</p>
<pre><code>systemctl status mariadb
</code></pre>
<p>Next we need to run a post installation script
called <code>mysql_secure_installation</code>
(that's not a typo)
that sets up the MariaDB root password and 
performs some security checks.
To do that, run the following command, and
<strong>be sure to save the MariaDB root password you create</strong>:</p>
<pre><code>sudo mysql_secure_installation
</code></pre>
<p>Again, here is where you create a root password
for the MariaDB database server.
Be sure to save that and not forget it!
When you run the above script,
you'll get a series of prompts to respond to like below.
Press <strong>enter</strong> for the first prompt,
press <strong>Y</strong> for the prompts marked <strong>Y</strong>,
and input your own password.
Since this server is exposed to the internet,
be sure to use a complex password.</p>
<pre><code>Enter the current password for root (enter for none):
Set root password: Y
New Password: XXXXXXXXX
Re-enter new password: XXXXXXXXX
Remove anonymous users: Y
Disallow root login remotely: Y
Remove test database and access to it: Y
Reload privilege tables now: Y
</code></pre>
<p>We can login to the database to test it.
In order to do so,
we have to become the <strong>root Linux user</strong>,
which we can do with the following command:</p>
<pre><code>sudo su
</code></pre>
<blockquote>
<p>Note: we need to generally be careful when we
enter commands on the command line, because
it's a largely unforgiving computing environment.
But we need to be especially careful when we
are logged in as the Linux root user.
This user can delete anything, including
files that the system needs in order to boot
and operate.</p>
</blockquote>
<p>After we are root,
we can login to MariaDB,
run the <code>show databases;</code> command, and
then exit with the <code>\q</code> command:</p>
<pre><code>root@hostname:~# mariadb -u root
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 47
Server version: 10.3.34-MariaDB-0ubuntu0.20.04.1 Ubuntu 20.04

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
+--------------------+
3 rows in set (0.002 sec)
</code></pre>
<blockquote>
<p>Note: If we are logging into the root database account
as the root Linux user, we don't need to enter our password.</p>
</blockquote>
<h2 id="create-and-set-up-a-regular-user-account"><a class="header" href="#create-and-set-up-a-regular-user-account">Create and Set Up a Regular User Account</a></h2>
<p>We need to reserve the <strong>root MariaDB user</strong> for
special use cases and
instead create a <strong>regular MariaDB user</strong>, or
more than one MariaDB user, as needed.</p>
<p>To create a regular MariaDB user,
we use the <code>create</code> command.
In the command below,
I'll create a new user called <strong>webapp</strong>
with a complex password within the single quotes
at the end (marked with a series of Xs here for demo purposes):</p>
<pre><code>MariaDB [(none)]&gt; create user 'webapp'@'localhost' identified by 'XXXXXXXXX';
</code></pre>
<p>If the prompt returns a <strong>Query OK</strong> message,
then the new user should have been created without any issues.</p>
<h2 id="create-a-practice-database"><a class="header" href="#create-a-practice-database">Create a Practice Database</a></h2>
<p>As the root database user,
let's create a new database for a regular, new user.</p>
<p>The regular user will be granted <strong>all privileges</strong>
on the new database,
including all its tables.
Other than granting <strong>all privileges</strong>,
we could limit the user to specific privileges, including:
<strong>CREATE, DROP, DELETE, INSERT, SELECT, UPDATE, and GRANT OPTION</strong>.
Such privileges may be called operations or functions, and
they allow MariaDB users to use and modify the databases,
where appropriate.
For example, we may want to limit the <strong>webapp</strong> user to
only be able to use <strong>SELECT</strong> commands.
It totally depends on the purpose of the database and
our security risks.</p>
<pre><code>MariaDB [(none)]&gt; create database linuxdb;
MariaDB [(none)]&gt; grant all privileges on linuxdb.* to 'webapp'@'localhost';
MariaDB [(none)]&gt; show databases;
</code></pre>
<p>Exit out of the MariaDB database as the <strong>root MariaDB user</strong>, and
then exit out of the <strong>root Linux user account</strong>, and
you should be back to your normal Linux user account:</p>
<pre><code>MariaDB [(none)]&gt; \q
root@hostname:~# exit
</code></pre>
<blockquote>
<p>Note: relational database keywords are often written
in all capital letters.
As far as I know,
this is simply a convention to make the code more readable.
However, in most cases I'll write the keywords in lower case
letters.
This is simply because, by convention, I'm super lazy.</p>
</blockquote>
<h2 id="logging-in-as-regular-user-and-creating-tables"><a class="header" href="#logging-in-as-regular-user-and-creating-tables">Logging in as Regular User and Creating Tables</a></h2>
<p>We can start doing MariaDB work.
As a reminder,
we've created a new MariaDB user named <strong>webapp</strong> and
a new database for <strong>webapp</strong> that is called <strong>linuxdb</strong>.
When we run the <code>show databases</code> command as
the <strong>webapp</strong> user,
we should see the <strong>linuxdb</strong> database
(and only the <strong>linuxdb</strong> database).
Note below that I use the <code>-p</code> option.
This instructs MariaDB to request the password
for the <strong>webapp</strong> user, which
is required to log in.</p>
<pre><code>mariadb -u webapp -p
MariaDB [(none)]&gt; show databases;
MariaDB [(none)]&gt; use linuxdb;
</code></pre>
<p>A database is not worth much without data.
In the following code,
I create and define a new table for our <strong>linuxdb</strong> database.
The table will be called <strong>distributions</strong>, and
it will contain data about various Linux distributions
(name of distribution, distribution developer, and founding date).</p>
<pre><code>MariaDB [(linuxdb)]&gt; create table distributions
    -&gt; (
    -&gt; id int unsigned not null auto_increment,
    -&gt; name varchar(150) not null,
    -&gt; developer varchar(150) not null,
    -&gt; founded date not null,
    -&gt; primary key (id)
    -&gt; );
Query OK, 0 rows affected (0.07 sec)

MariaDB [(linuxdb)]&gt; show tables;
MariaDB [(linuxdb)]&gt; describe distributions;
</code></pre>
<p>Congratulations! Now create some records for that table.</p>
<h3 id="adding-records-into-the-table"><a class="header" href="#adding-records-into-the-table">Adding records into the table</a></h3>
<p>We can populate our <strong>linuxdb</strong> database
with some data.
We'll use the <code>insert</code> command to add our records
into our <strong>distribution</strong> table:</p>
<pre><code>MariaDB [(linuxdb)]&gt; insert into distributions (name, developer, founded) values
    -&gt; ('Debian', 'The Debian Project', '1993-09-15'),
    -&gt; ('Ubuntu', 'Canonical Ltd.', '2004-10-20'),
    -&gt; ('Fedora', 'Fedora Project', '2003-11-06');
Query OK, 3 rows affected (0.004 sec)
Records: 3  Duplicates: 0  Warnings: 0
MariaDB [(linuxdb)]&gt; select * from distributions;
</code></pre>
<p>Success! Now let's test our table.</p>
<h3 id="testing-commands"><a class="header" href="#testing-commands">Testing Commands</a></h3>
<p>We will complete the following tasks
to refresh our MySQL/MariaDB knowledge:</p>
<ul>
<li>retrieve some records or parts of records, </li>
<li>delete a record,</li>
<li>alter the table structure so that it will hold more data, and</li>
<li>add a record:</li>
</ul>
<pre><code>MariaDB [(linuxdb)]&gt; select name from distributions;
MariaDB [(linuxdb)]&gt; select founded from distributions;
MariaDB [(linuxdb)]&gt; select name, developer from distributions;
MariaDB [(linuxdb)]&gt; select name from distributions where name='Debian';
MariaDB [(linuxdb)]&gt; select developer from distributions where name='Ubuntu';
MariaDB [(linuxdb)]&gt; select * from distributions;
MariaDB [(linuxdb)]&gt; alter table distributions
    -&gt; add packagemanager char(3) after name;
MariaDB [(linuxdb)]&gt; describe distributions;
MariaDB [(linuxdb)]&gt; update distributions set packagemanager='APT' where id='1';
MariaDB [(linuxdb)]&gt; update distributions set packagemanager='APT' where id='2';
MariaDB [(linuxdb)]&gt; update distributions set packagemanager='DNF' where id='3';
MariaDB [(linuxdb)]&gt; select * from distributions;
MariaDB [(linuxdb)]&gt; delete from distributions where name='Debian';
MariaDB [(linuxdb)]&gt; insert into distributions
    -&gt; (name, packagemanager, developer, founded) values
    -&gt; ('Debian', 'The Debian Project', '1993-09-15'),
    -&gt; ('CentOS', 'YUM', 'The CentOS Project', '2004-05-14');
MariaDB [(linuxdb)]&gt; select * from distributions;
MariaDB [(linuxdb)]&gt; select name, packagemanager
    -&gt; from distributions
    -&gt; where founded &lt; '2004-01-01';
MariaDB [(linuxdb)]&gt; select name from distributions order by founded;
MariaDB [(linuxdb)]&gt; \q
</code></pre>
<h2 id="install-php-and-mysql-support"><a class="header" href="#install-php-and-mysql-support">Install PHP and MySQL Support</a></h2>
<p>The next goal is to complete the connection
between PHP and MariaDB so that
we can use both for our websites.</p>
<p>First install PHP support for MariaDB.
We're installing some modules alongside the basic support.
These may or may not be needed,
but I'm installing them to demonstrate some basics.</p>
<pre><code>sudo apt install php-mysql
</code></pre>
<p>And then restart Apache2 and MariaDB:</p>
<pre><code>sudo systemctl restart apache2
sudo systemctl restart mariadab
</code></pre>
<h3 id="create-php-scripts"><a class="header" href="#create-php-scripts">Create PHP Scripts</a></h3>
<p>In order for PHP to connect to MariaDB,
it needs to authenticate itself.
To do that,
we will create a <strong>login.php</strong> file
in <strong>/var/www/html</strong>.
We also need to change the group ownership
of the file and its permissions so that
the file can be read by the Apache2 web server
but not by the world,
since this file will store password information.</p>
<pre><code>cd /var/www/html/
sudo touch login.php
sudo chmod 640 login.php
sudo chown :www-data login.php
ls -l login.php
nano login.php
</code></pre>
<p>In the file,
add the following credentials.
If you used a different database name than <strong>linuxdb</strong>
and a different username than <strong>webapp</strong>,
then you need to substitute your names below. 
You need to use your own password where
I have the Xs:</p>
<pre><code>&lt;?php // login.php
$db_hostname = &quot;localhost&quot;;
$db_database = &quot;linuxdb&quot;;
$db_username = &quot;webapp&quot;;
$db_password = &quot;XXXXXXXXX&quot;;
?&gt;
</code></pre>
<p>Next we create a new PHP file for our website.
This file will display HTML but
will primarily be PHP interacting with our
MariaDB <strong>distributions</strong> database.</p>
<p>Create a file titled <strong>distros.php</strong>.</p>
<pre><code>sudo nano distros.php
</code></pre>
<p>Then copy over the following text
(I suggest you transcribe it, especially
if you're interested in learning a bit of PHP, but
you can simply copy and paste it into the <code>nano</code> buffer):</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;MySQL Server Example&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;?php

// Load MySQL credentials
require_once 'login.php';

// Establish connection
$conn = mysqli_connect($db_hostname, $db_username, $db_password) or
  die(&quot;Unable to connect&quot;);

// Open database
mysqli_select_db($conn, $db_database) or
  die(&quot;Could not open database '$db_database'&quot;);

// QUERY 1
$query1 = &quot;show tables from $db_database&quot;;
$result1 = mysqli_query($conn, $query1);

$tblcnt = 0;
while($tbl = mysqli_fetch_array($result1)) {
  $tblcnt++;
}

if (!$tblcnt) {
  echo &quot;&lt;p&gt;There are no tables&lt;/p&gt;\n&quot;;
}
else {
  echo &quot;&lt;p&gt;There are $tblcnt tables&lt;/p&gt;\n&quot;;
}

// Free result1 set
mysqli_free_result($result1);

// QUERY 2
$query2 = &quot;select name, developer from distributions&quot;;
$result2 = mysqli_query($conn, $query2);

$row = mysqli_fetch_array($result2, MYSQLI_NUM);
printf (&quot;%s (%s)\n&quot;, $row[0], $row[1]);
echo &quot;&lt;br/&gt;&quot;;

$row = mysqli_fetch_array($result2, MYSQLI_ASSOC);
printf (&quot;%s (%s)\n&quot;, $row[&quot;name&quot;], $row[&quot;developer&quot;]);

// Free result2 set
mysqli_free_result($result2);

// Query 3
$query3 = &quot;select * from distributions&quot;;
$result3 = mysqli_query($conn, $query3);

while($row = $result3-&gt;fetch_assoc()) {
  echo &quot;&lt;p&gt;Owner &quot; . $row[&quot;developer&quot;] . &quot; manages distribution &quot; . $row[&quot;name&quot;] . &quot;.&lt;/p&gt;&quot;;
}

mysqli_free_result($result3);

$result4 = mysqli_query($conn, $query3);
while($row = $result4-&gt;fetch_assoc()) {
  echo &quot;&lt;p&gt;Distribution &quot; . $row[&quot;name&quot;] . &quot; was released on &quot; . $row[&quot;founded&quot;] . &quot;.&lt;/p&gt;&quot;;
}

// Free result4 set
mysqli_free_result($result4);

/* Close connection */
mysqli_close($conn);

?&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Save the file and exit out of <code>nano</code>.</p>
<h3 id="test-syntax"><a class="header" href="#test-syntax">Test Syntax</a></h3>
<p>After you save the file and exit the text editor,
we need to test the PHP syntax.
If there are any errors in our PHP,
these commands will show the line numbers
that are causing errors or leading up to errors.
Nothing will output if all is well with the first command.
If all is well with the second command, HTML should be outputted:</p>
<pre><code>sudo php -f login.php
sudo php -f index.php
</code></pre>
<h2 id="conclusion-19"><a class="header" href="#conclusion-19">Conclusion</a></h2>
<p>Congratulations! If you've reached this far,
you have successfully created a LAMP stack.
In the process,
you have learned how to install and set up MariaDB,
how to create MariaDB root and regular user accounts,
how to create a test database
with play data for practicing, and
how to connect this with PHP for display on a webpage.</p>
<p>In regular applications of these technologies,
there's a lot more involved, but
completing the above process is a great start to
learning more.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="conclusion-20"><a class="header" href="#conclusion-20">Conclusion</a></h1>
<p>I consider this book to be a live document.
Perhaps, then, this is version 0.8, or
something like that.
In any case,
it will be continually updated throughout the year but
probably more often before and during the fall semesters 
when I teach my Linux Systems Administration course.</p>
<p>This book in no way is meant to provide a comprehensive
overview of systems administration nor of Linux.
It's meant to act as a starting point for those
interested in systems administration, and
it's meant to get students,
many of whom grew up using only graphical user interfaces,
familiar with command line environments.
In that respect,
this book, and the course that I teach,
is aimed at empowering students to know their technology
and become comfortable and more experienced with it,
especially the behind the scenes stuff.
That said, I'm proud that some of my students
have gone on to become systems administrators.
Other courses in our program and their own work and internships
have probabably contributed more to that motivation, but
I know that this course has been a factor.</p>
<p>If you're not a student in our program but
have stumbled upon this book,
I hope it's helpful to you, too.
This is, in fact, why I've made it available on my website and
not simply dropped it in my course shell.</p>
<p>C. Sean Burns, PhD<br />
August 13, 2022</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
